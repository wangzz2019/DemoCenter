{"version":3,"sources":["webpack://democenter/./node_modules/tslib/tslib.es6.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/display.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/context.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/domain/tracekit/report.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/domain/tracekit/computeStackTrace.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/error.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/transport/transport.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/domain/internalMonitoring.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/utils.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/browser/cookie.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/domain/transportConfiguration.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/catchUserErrors.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/domain/configuration.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/boot/init.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/boundedBuffer.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/timeUtils.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/rawRumEvent.types.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/boot/buildEnv.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/lifeCycle.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/urlPolyfill.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/resource/resourceUtils.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/assembly.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/tracing/getDocumentTraceId.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/browser/performanceCollection.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/limitModification.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/errorFilter.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/foregroundContexts.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/observable.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/domain/sessionManagement.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/domain/oldCookiesMigration.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/browser/xhrProxy.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/browser/fetchProxy.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/tracing/tracer.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/requestCollection.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/trackEventCounts.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/trackPageActivities.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/action/getActionNameFromElement.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/action/trackActions.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/domain/automaticErrorCollection.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/view/trackFirstHidden.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumSession.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/action/actionCollection.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/resource/matchRequestTiming.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/resource/resourceCollection.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/view/trackInitialViewTimings.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/view/trackLocationChanges.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/view/trackViewMetrics.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/view/trackViews.js","webpack://democenter/./node_modules/@datadog/browser-rum/esm/boot/rum.entry.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/boot/rumPublicApi.js","webpack://democenter/./node_modules/@datadog/browser-core/esm/tools/contextManager.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/boot/startRum.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/browser/domMutationObservable.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/parentContexts.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/transport/batch.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/longTask/longTaskCollection.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/view/viewCollection.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/error/errorCollection.js","webpack://democenter/./node_modules/@datadog/browser-rum-core/esm/domain/internalContext.js","webpack://democenter/./public/javascripts/rum.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__spreadArrays","il","r","Array","k","a","j","jl","display","log","console","bind","warn","error","isContextArray","value","isArray","isContext","combine","destination","sources","_i","_a","sources_1","source","mergeInto","createCircularReferenceChecker","deepClone","context","undefined","WeakSet","set_1","hasAlreadyBeenSeen","has","add","array","indexOf","push","circularReferenceChecker","finalDestination","key","Math","max","index","ERROR_TYPES_RE","report","ex","lastExceptionStack","lastException","processLastException","stack","computeStackTrace","setTimeout","monitor","incomplete","oldOnerrorHandler","onErrorHandlerInstalled","onUnhandledRejectionHandlerInstalled","handlers","notifyHandlers","isWindowError","exception","forEach","handler","inner","traceKitWindowOnError","message","url","lineNo","columnNo","errorObj","augmentStackTraceWithInitialElement","name_1","location_1","column","line","msg","toString","groups","exec","name","traceKitWindowOnUnhandledRejection","e","reason","currentLastExceptionStack","currentLastException","UNKNOWN_FUNCTION","depth","normalizedDepth","stacktrace","tryToGetString","parts","opera10Regex","opera11Regex","lines","split","element","args","func","computeStackTraceFromStacktraceProp","debug","isEval","submatch","chrome","gecko","winjs","geckoEval","chromeEval","isNative","columnNumber","computeStackTraceFromStackProp","object","lineRE1","lineRE2","lineRE3","scripts","window","document","getElementsByTagName","inlineScriptBlocks","src","item","location","href","replace","computeStackTraceFromOperaMultiLineMessage","computeStackTraceByWalkingCallerChain","stackInfo","initial","unshift","partial","functionName","funcs","recursion","curr","caller","input","substring","splice","result","candidate","property","ErrorHandling","ErrorSource","formatUnknownError","stackTrace","errorObject","nonErrorPrefix","handlingStack","Error","toStackTraceString","type","jsonStringify","formatErrorMessage","frame","join","createHandlingStack","formattedStack","callMonitored","slice","StatusType","HAS_MULTI_BYTES_CHARACTERS","hasReportedXhrError","HttpRequest","endpointUrl","bytesLimit","withBatchTime","send","data","size","Date","getTime","addBatchTime","tryBeacon","navigator","sendBeacon","hasReportedBeaconError","addErrorToMonitoringBatch","reportBeaconError","request","XMLHttpRequest","addEventListener","event","req","currentTarget","status","addMonitoringMessage","on_line","onLine","try_beacon","is_trusted","isTrusted","total","loaded","ready_state","readyState","response_text","responseText","transportIntrospection","open","Batch","maxSize","maxMessageSize","flushTimeout","beforeUnloadCallback","noop","pushOnlyBuffer","upsertBuffer","bufferBytesSize","bufferMessageCount","flushOnVisibilityHidden","flushPeriodically","addOrUpdate","upsert","flush","messages","values","keys","sizeInBytes","test","TextEncoder","encode","Blob","process","processedMessage","messageBytesSize","hasMessageFor","remove","willReachedBytesLimitWith","isFull","removedMessage","_this","visibilityState","externalContextProvider","monitoringConfiguration","maxMessagesPerPage","sentMessageCount","startInternalMonitoring","configuration","internalMonitoringEndpoint","batch","replicaBatch","primaryBatch","createMonitoringBatch","batchBytesLimit","maxBatchSize","replica","contextualizedMessage","date","view","referrer","withContext","startMonitoringBatch","target","toAssign","maxInternalMonitoringMessagesPerPage","setExternalContextProvider","provider","fn","logErrorIfDebug","debugMode","logMessageIfDebug","addToMonitoringBatch","info","kind","formatError","setDebugMode","ResourceType","RequestType","getCurrentSiteCache","ONE_DAY","throttle","wait","options","pendingExecutionWithParameters","pendingTimeoutId","needLeadingExecution","leading","needTrailingExecution","trailing","inWaitPeriod","throttled","parameters","cancel","clearTimeout","generateUUID","placeholder","parseInt","random","performDraw","threshold","round","num","decimals","toFixed","replacer","space","JSON","stringify","originalToJSON","hasToJSON","toJSON","originalProtoToJSON","getPrototypeOf","includes","search","isPercentage","isNumber","objectEntries","map","isEmptyObject","getLinkElementOrigin","origin","sanitizedHost","host","protocol","findCommaSeparatedValue","rawString","matches","RegExp","emitter","listener","addEventListeners","events","_b","once","capture","passive","wrappedListener","stop","removeEventListener","runOnReadyState","expectedReadyState","callback","setCookie","expireDelay","setTime","expires","toUTCString","sameSite","crossSite","domain","secure","cookie","getCookie","catchUserErrors","errorMsg","err","ENDPOINTS","alternate","logs","rum","sessionReplay","trace","classic","INTAKE_SITE","CLASSIC_ALLOWED_SITES","getHost","intakeType","endpointType","site","endpoint","getClassicHost","domainParts","extension","pop","getAlternateHost","getEndpoint","settings","tags","sdkVersion","env","service","version","datadogHost","proxyHost","encodeURIComponent","clientToken","BuildMode","DEFAULT_CONFIGURATION","allowedTracingOrigins","maxErrorsByMinute","resourceSampleRate","sampleRate","silentMultipleInit","trackInteractions","trackViewsManually","requestErrorResponseLengthLimit","buildCookieOptions","userConfiguration","cookieOptions","useSecureSessionCookie","useCrossSiteSessionCookie","mustUseSecureCookie","trackSessionAcrossSubdomains","testCookieName","domainLevels","hostname","candidateDomain","getCurrentSite","commonInit","buildEnv","enableExperimentalFeatures","beforeSend","isEnabled","feature","transportSettings","buildMode","datacenter","useAlternateIntakeDomains","getIntakeType","intakeUrls","withReplica","sites","STAGING","urls","endpointTypes","sites_1","endpointTypes_1","getIntakeUrls","isIntakeUrl","some","intakeUrl","logsEndpoint","rumEndpoint","sessionReplayEndpoint","traceEndpoint","internalMonitoringApiKey","E2E_TEST","replicaTransportSettings","applicationId","computeTransportConfiguration","buildConfiguration","internalMonitoring","navigationStart","RumEventType","ViewLoadingType","ActionType","BoundedBuffer","limit","buffer","drain","relativeToClocks","relative","timeStamp","relativeTime","correctedOrigin","now","performance","getNavigationStart","getTimeStamp","currentDrift","toServerDuration","duration","timeStampNow","relativeNow","clocksNow","elapsed","start","end","timing","LifeCycleEventType","isURLSupported","LifeCycle","callbacks","notify","eventType","eventCallbacks","subscribe","unsubscribe","filter","other","normalizeUrl","buildUrl","base","URL","checkURLSupported","doc","anchorElement","createElement","baseElement","implementation","createHTMLDocument","head","appendChild","body","SessionType","FAKE_INITIAL_DOCUMENT","RESOURCE_TYPES","DOCUMENT","initiatorType","XHR","FETCH","BEACON","CSS","_","path","JS","IMAGE","FONT","MEDIA","areInOrder","numbers","computePerformanceResourceDetails","entry","validEntry","toValidEntry","startTime","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","details","download","formatTiming","responseEnd","first_byte","connect","ssl","dns","hasRedirection","redirect","computeSize","decodedBodySize","isAllowedRequestUrl","getDocumentTraceId","traceIdMeta","querySelector","traceTimeMeta","createDocumentTraceData","content","getDocumentTraceDataFromMeta","comment","childNodes","getTraceCommentFromNode","node","isTextNode","findTraceComment","getDocumentTraceDataFromComment","traceTime","traceId","rawTraceTime","Number","nodeName","isCommentNode","match","supportPerformanceObject","supportPerformanceTimingEvent","entryType","PerformanceObserver","supportedEntryTypes","startPerformanceCollection","lifeCycle","handleRumPerformanceEntry","forcedAttributes","getEntriesByType","navigationEntry","relativePerformanceTiming","computeRelativePerformanceTiming","handlePerformanceEntries","getEntries","entries","observe","entryTypes","clearResourceTimings","sendFakeTiming","retrieveNavigationTiming","startTimeStamp","timingSent","removeEventListeners","evt","cancelable","processingStart","sendTiming","sendTimingIfPointerIsNotCancelled","delay","retrieveFirstInputTiming","numberKey","timingElement","loadEventEnd","isIncompleteNavigation","isForbiddenResource","PERFORMANCE_ENTRY_COLLECTED","get","current","field","isValidObjectContaining","set","fields","getType","VIEW_EVENTS_MODIFIABLE_FIELD_PATHS","OTHER_EVENTS_MODIFIABLE_FIELD_PATHS","startRumAssembly","session","parentContexts","getCommonContext","errorFilter","onLimitReached","errorCount","allowNextError","isLimitReached","startClocks","RAW_ERROR_COLLECTED","createErrorFilter","RAW_RUM_EVENT_COLLECTED","rawRumEvent","domainContext","savedCommonContext","customerContext","viewContext","findView","isTracked","id","getId","actionContext","findAction","commonContext","rumContext","_dd","format_version","drift","application","_DATADOG_SYNTHETICS_BROWSER","USER","SYNTHETICS","serverRumEvent","ERROR","RESOURCE","LONG_TASK","has_replay","hasReplay","user","usr","modifiableFieldPaths","modifier","clone","originalValue","newValue","originalType","newType","limitModification","VIEW","shouldSend","eventTimeStamp","eventRelativeTime","RUM_EVENT_COLLECTED","foregroundPeriods","addNewForegroundPeriod","currentForegroundPeriod","inForegroundPeriodsCount","currentForegroundPeriodStart","closeForegroundPeriod","currentForegroundPeriodEnd","getInForeground","foregroundPeriod","getInForegroundPeriods","eventStartTime","eventEndTime","filteredForegroundPeriods","startDuration","endDuration","Observable","observers","f","observer","SESSION_EXPIRATION_DELAY","startSessionManagement","productKey","computeSessionState","sessionCookie","timeout","cache","hasCache","cacheAccess","ONE_SECOND","cacheCookieAccess","sessionString","oldSessionId","oldRumType","oldLogsType","persistSession","tryOldCookiesMigration","renewObservable","currentSessionId","retrieveActiveSession","expandOrRenewSession","trackingType","created","String","stopCallbacks","trackActivity","expandSession","expandSessionWhenVisible","visibilityCheckInterval","setInterval","clearInterval","trackVisibility","getTrackingType","SESSION_ENTRY_REGEXP","isValidSessionString","retrieveSession","expire","isActiveSession","clearSession","cookieString","xhrProxySingleton","originalXhrOpen","originalXhrSend","originalXhrAbort","fetchProxySingleton","originalFetch","beforeSendCallbacks","onRequestCompleteCallbacks","startXhrProxy","abort","openXhr","sendXhr","abortXhr","onRequestComplete","method","_datadog_xhr","isAborted","hasBeenReported","originalOnreadystatechange","onreadystatechange","DONE","onEnd","reportXhr","xhr","response","startFetchProxy","fetch","init","responsePromise","afterSend","reportFetch","thisArg","_arguments","generator","text","e_1","y","g","label","sent","trys","ops","next","verb","Symbol","iterator","v","op","TypeError","done","step","__generator","DOMException","code","ABORT_ERR","responseType","P","Promise","resolve","reject","fulfilled","rejected","then","clearTracingIfNeeded","spanId","injectHeadersIfTracingAllowed","inject","getCrypto","requestUrl","requestOrigin","allowedOrigin","isAllowedUrl","TraceIdentifier","toDecimalString","crypto","msCrypto","Uint8Array","getRandomValues","radix","high","readInt32","low","str","mod","floor","offset","nextRequestIndex","getNextRequestIndex","trackEventCounts","eventCounts","longTaskCount","resourceCount","userActionCount","subscription","ACTION","waitIdlePageActivity","domMutationObservable","completionCallback","firstRequestIndex","observable","subscriptions","pendingRequestsCount","notifyPageActivity","isBusy","REQUEST_STARTED","startEvent","requestIndex","REQUEST_COMPLETED","trackPageActivities","pageActivitiesObservable","stopPageActivitiesTracking","stopWaitPageActivitiesCompletion","idleTimeoutId","hasCompleted","validationTimeoutId","complete","hadActivity","maxDurationTimeoutId","endTime","lastChangeTime","params","waitPageActivitiesCompletion","supportsInnerTextScriptAndStyleRemovalResult","supportsLabelPropertyResult","supportsElementClosestResult","PROGRAMMATIC_ATTRIBUTE","priorityStrategies","HTMLInputElement","labels","getTextualContent","ownerDocument","getAttribute","labelledByAttribute","refElement","getElementById","Boolean","fallbackStrategies","getActionNameFromElementForStrategies","targetElement","strategies","recursionCounter","strategies_1","strategy","trimmedName","trim","truncate","normalizeWhitespace","parentElement","lastChar","charCodeAt","isContentEditable","innerText","style","textContent","div","removeChild","supportsInnerTextScriptAndStyleRemoval","elementsTextToRemove","querySelectorAll","trackActions","action","currentAction","currentIdlePageActivitySubscription","create","pendingAutoAction","PendingAutoAction","discard","discardCurrent","startActionManagement","VIEW_CREATED","stopListener","Element","elementWithAttribute","HTMLElement","closest","hasAttribute","getActionNameFromElementProgrammatically","CLICK","errorObservable","originalConsoleError","trackFirstHiddenSingleton","RumTrackingType","eventCountsSubscription","AUTO_ACTION_CREATED","AUTO_ACTION_COMPLETED","counts","AUTO_ACTION_DISCARDED","processAction","foregroundContexts","autoActionProperties","isAutoAction","count","loading_time","long_task","resource","actionEvent","inForeground","in_foreground","CUSTOM","startAutomaticErrorCollection","handleCompleteRequest","isRejected","isServerError","format","statusCode","truncateResponseText","trackNetworkError","buildErrorFromParams","handling","HANDLED","startConsoleTracking","originalError","UNHANDLED","onerror","onunhandledrejection","startRuntimeErrorTracking","firstErrorParam","predicate","find","param","formatConsoleParameters","startResourceCollection","isTrackedWithResource","matchingTiming","sameNameEntries","getEntriesByName","correspondingEntries","candidates","matchRequestTiming","correspondingTimingOverrides","computePerformanceEntryMetrics","tracingInfo","span_id","trace_id","computeRequestTracingInfo","resourceEvent","status_code","performanceEntry","toPerformanceEntryRepresentation","requestInput","requestInit","processRequest","isValidUrl","OTHER","pathname","getPathName","RESOURCE_TYPES_1","isType","computeResourceKind","entryMetrics","computeEntryTracingInfo","processResourceEntry","PerformanceEntry","trackFirstHidden","Infinity","trackInitialViewTimings","timings","setTimings","newTimings","stopNavigationTracking","domComplete","domContentLoaded","domContentLoadedEventEnd","domInteractive","loadEvent","trackNavigationTimings","stopFCPTracking","firstHidden","fcp","firstContentfulPaint","trackFirstContentfulPaint","stopLCPTracking","firstInteractionTimestamp","stopEventListener","unsubscribeLifeCycle","lcp","largestContentfulPaint","trackLargestContentfulPaint","stopFIDTracking","firstInputDelay","firstInputTime","trackFirstInputTimings","getPathFromHash","hash","trackViewMetrics","scheduleViewUpdate","loadingType","stopCLSTracking","viewMetrics","stopEventCountsTracking","newEventCounts","loadType","isWaitingForLoadEvent","INITIAL_LOAD","isWaitingForActivityLoadingTime","loadingTimeCandidates","invokeCallbackIfAllCandidatesAreReceived","newLoadingTime","loadingTime","setLoadEvent","setActivityLoadingTime","activityLoadingTime","trackLoadingTime","stopActivityLoadingTimeTracking","trackActivityLoadingTime","cumulativeLayoutShift","layoutShift","hadRecentInput","trackLayoutShift","trackViews","areViewsTrackedAutomatically","initialViewName","onLocationChange","onHashChange","stopHistoryTracking","stopHashTracking","isRecording","initialView","newView","updateTimings","scheduleUpdate","trackInitialView","stopInitialViewTracking","currentView","stopViewLifeCycle","SESSION_RENEWED","trackViewChange","BEFORE_UNLOAD","triggerUpdate","RECORD_STARTED","updateHasReplay","RECORD_STOPPED","keepAliveInterval","startViewLifeCycle","stopViewCollectionMode","currentLocation","getLocation","otherLocation","correspondingId","substr","updateLocation","onHistoryChange","originalPushState","history","pushState","originalReplaceState","replaceState","removeListener","trackHistory","ROUTE_CHANGE","addTiming","time","startView","initialLocation","initialHasReplay","endClocks","customTimings","documentVersion","triggerViewUpdate","cancelScheduleViewUpdate","stopViewMetricsTracking","currentEnd","VIEW_UPDATED","isActive","clocks","VIEW_ENDED","sanitized","sanitizeTiming","newLocation","newHasReplay","rumSessionType","TRACKED_WITH_RESOURCES","TRACKED_WITHOUT_RESOURCES","global","api","existingGlobalVariable","datadogRum","startRumImpl","isAlreadyInitialized","globalContextManager","newContext","getInternalContextStrategy","bufferApiCalls","addTimingStrategy","startViewStrategy","addActionStrategy","clonedCommonContext","addErrorStrategy","providedError","stub","publicApi","rumPublicApi","testCookieValue","areCookiesAuthorized","publicApiKey","canInitRum","beforeInitCalls","doStartRum","rawTrackingType","NOT_TRACKED","hasValidRumSession","startRumSession","MutationObserver","constructor","browserWindow","Zone","symbol","__symbol__","getMutationObserverConstructor","attributes","characterData","childList","subtree","disconnect","application_id","previousViews","previousActions","currentContext","buildCurrentViewContext","buildCurrentActionContext","clearOldContextsInterval","clearOldContexts","SESSION_TIME_OUT_DELAY","ONE_MINUTE","previousContexts","timeOutDelay","oldTimeThreshold","findContext","buildContext","previousContexts_1","previousContext","startParentContexts","hasFocus","onFocusChange","onBlurChange","stopForegroundTracking","stopBlurTracking","startForegroundContexts","createRumBatch","unloadCallback","withReplicaApplicationId","stopped","makeRumBatch","startRumBatch","startRumEventCollection","startLongTaskCollection","viewEvent","document_version","cumulative_layout_shift","dom_complete","dom_content_loaded","dom_interactive","first_contentful_paint","first_input_delay","first_input_time","is_active","largest_contentful_paint","load_event","loading_type","time_spent","in_foreground_periods","custom_timings","newObject","mapValues","processViewUpdate","shouldTrackViewsAutomatically","startViewCollection","addError","handling_stack","processError","rawError","computeRawError","doStartErrorCollection","startErrorCollection","addAction","startActionCollection","tracer","traceFetch","tracingHeaders","Request","headers","append","headers_1","Headers","header","concat","traceXhr","setRequestHeader","startTracer","xhrProxy","trackXhr","fetchProxy","trackFetch","startRequestCollection","internalContext","session_id","user_action","startInternalContext","getInternalContext","addRumGlobalContext","removeRumGlobalContext","getRumGlobalContext","setRumGlobalContext","addUserAction","checkedSource","setUser","newUser","sanitizedUser","email","sanitizeUser","removeUser","onReady","defineProperty","enumerable","makeRumPublicApi","globalThis","configurable","globalObject","_dd_temp_","self","getGlobalObject","q"],"mappings":"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","file":"rum.js","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/* eslint-disable no-console, local-rules/disallow-side-effects */\n/**\n * Keep references on console methods to avoid triggering patched behaviors\n *\n * NB: in some setup, console could already be patched by another SDK.\n * In this case, some display messages can be sent by the other SDK\n * but we should be safe from infinite loop nonetheless.\n */\nexport var display = {\n    log: console.log.bind(console),\n    warn: console.warn.bind(console),\n    error: console.error.bind(console),\n};\n//# sourceMappingURL=display.js.map","var isContextArray = function (value) { return Array.isArray(value); };\nvar isContext = function (value) {\n    return !Array.isArray(value) && typeof value === 'object' && value !== null;\n};\nexport function combine() {\n    var sources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        sources[_i] = arguments[_i];\n    }\n    var destination;\n    for (var _a = 0, sources_1 = sources; _a < sources_1.length; _a++) {\n        var source = sources_1[_a];\n        // Ignore any undefined or null sources.\n        if (source === undefined || source === null) {\n            continue;\n        }\n        destination = mergeInto(destination, source, createCircularReferenceChecker());\n    }\n    return destination;\n}\n/*\n * Performs a deep clone of objects and arrays.\n * - Circular references are replaced by 'undefined'\n */\nexport function deepClone(context) {\n    return mergeInto(undefined, context, createCircularReferenceChecker());\n}\nexport function createCircularReferenceChecker() {\n    if (typeof WeakSet !== 'undefined') {\n        var set_1 = new WeakSet();\n        return {\n            hasAlreadyBeenSeen: function (value) {\n                var has = set_1.has(value);\n                if (!has) {\n                    set_1.add(value);\n                }\n                return has;\n            },\n        };\n    }\n    var array = [];\n    return {\n        hasAlreadyBeenSeen: function (value) {\n            var has = array.indexOf(value) >= 0;\n            if (!has) {\n                array.push(value);\n            }\n            return has;\n        },\n    };\n}\n/**\n * Iterate over 'source' and affect its subvalues into 'destination', recursively.  If the 'source'\n * and 'destination' can't be merged, return 'source'.\n */\nexport function mergeInto(destination, source, circularReferenceChecker) {\n    // Ignore the 'source' if it is undefined\n    if (source === undefined) {\n        return destination;\n    }\n    // If the 'source' is not an object or array, it can't be merged with 'destination' in any way, so\n    // return it directly.\n    if (!isContext(source) && !isContextArray(source)) {\n        return source;\n    }\n    // Return 'undefined' if we already iterated over this 'source' to avoid infinite recursion\n    if (circularReferenceChecker.hasAlreadyBeenSeen(source)) {\n        return undefined;\n    }\n    // 'source' and 'destination' are objects, merge them together\n    if (isContext(source) && (destination === undefined || isContext(destination))) {\n        var finalDestination = destination || {};\n        for (var key in source) {\n            if (Object.prototype.hasOwnProperty.call(source, key)) {\n                finalDestination[key] = mergeInto(finalDestination[key], source[key], circularReferenceChecker);\n            }\n        }\n        return finalDestination;\n    }\n    // 'source' and 'destination' are arrays, merge them together\n    if (isContextArray(source) && (destination === undefined || isContextArray(destination))) {\n        var finalDestination = destination || [];\n        finalDestination.length = Math.max(finalDestination.length, source.length);\n        for (var index = 0; index < source.length; index += 1) {\n            finalDestination[index] = mergeInto(finalDestination[index], source[index], circularReferenceChecker);\n        }\n        return finalDestination;\n    }\n    // The destination in not an array nor an object, so we can't merge it\n    return source;\n}\n//# sourceMappingURL=context.js.map","import { monitor } from '../internalMonitoring';\nimport { computeStackTrace, augmentStackTraceWithInitialElement } from './computeStackTrace';\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Error_types\n// eslint-disable-next-line  max-len\nvar ERROR_TYPES_RE = /^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;\n/**\n * Cross-browser processing of unhandled exceptions\n *\n * Syntax:\n * ```js\n *   subscribe(function(stackInfo) { ... })\n *   unsubscribe(function(stackInfo) { ... })\n *   report(exception)\n *   try { ...code... } catch(ex) { report(ex); }\n * ```\n *\n * Supports:\n *   - Firefox: full stack trace with line numbers, plus column number\n *     on top frame; column number is not guaranteed\n *   - Opera: full stack trace with line and column numbers\n *   - Chrome: full stack trace with line and column numbers\n *   - Safari: line and column number for the top frame only; some frames\n *     may be missing, and column number is not guaranteed\n *   - IE: line and column number for the top frame only; some frames\n *     may be missing, and column number is not guaranteed\n *\n * In theory, TraceKit should work on all of the following versions:\n *   - IE5.5+ (only 8.0 tested)\n *   - Firefox 0.9+ (only 3.5+ tested)\n *   - Opera 7+ (only 10.50 tested; versions 9 and earlier may require\n *     Exceptions Have Stacktrace to be enabled in opera:config)\n *   - Safari 3+ (only 4+ tested)\n *   - Chrome 1+ (only 5+ tested)\n *   - Konqueror 3.5+ (untested)\n *\n * Requires computeStackTrace.\n *\n * Tries to catch all unhandled exceptions and report them to the\n * subscribed handlers. Please note that report will rethrow the\n * exception. This is REQUIRED in order to get a useful stack trace in IE.\n * If the exception does not reach the top of the browser, you will only\n * get a stack trace from the point where report was called.\n *\n * Handlers receive a StackTrace object as described in the\n * computeStackTrace docs.\n *\n * @memberof TraceKit\n * @namespace\n */\n/**\n * Reports an unhandled Error.\n * @param {Error} ex\n * @memberof report\n * @throws An exception if an incomplete stack trace is detected (old IE browsers).\n */\nexport function report(ex) {\n    if (lastExceptionStack) {\n        if (lastException === ex) {\n            return; // already caught by an inner catch block, ignore\n        }\n        processLastException();\n    }\n    var stack = computeStackTrace(ex);\n    lastExceptionStack = stack;\n    lastException = ex;\n    // If the stack trace is incomplete, wait for 2 seconds for\n    // slow slow IE to see if onerror occurs or not before reporting\n    // this exception; otherwise, we will end up with an incomplete\n    // stack trace\n    setTimeout(monitor(function () {\n        if (lastException === ex) {\n            processLastException();\n        }\n    }), stack.incomplete ? 2000 : 0);\n    throw ex; // re-throw to propagate to the top level (and cause window.onerror)\n}\nvar handlers = [];\nvar lastException;\nvar lastExceptionStack;\n/**\n * Add a crash handler.\n * @param {Function} handler\n * @memberof report\n */\nexport function subscribe(handler) {\n    installGlobalHandler();\n    installGlobalUnhandledRejectionHandler();\n    handlers.push(handler);\n}\n/**\n * Remove a crash handler.\n * @param {Function} handler\n * @memberof report\n */\nexport function unsubscribe(handler) {\n    for (var i = handlers.length - 1; i >= 0; i -= 1) {\n        if (handlers[i] === handler) {\n            handlers.splice(i, 1);\n        }\n    }\n    if (handlers.length === 0) {\n        uninstallGlobalHandler();\n        uninstallGlobalUnhandledRejectionHandler();\n    }\n}\n/**\n * Dispatch stack information to all handlers.\n * @param {StackTrace} stack\n * @param {boolean} isWindowError Is this a top-level window error?\n * @param {Error=} error The error that's being handled (if available, null otherwise)\n * @memberof report\n * @throws An exception if an error occurs while calling an handler.\n */\nfunction notifyHandlers(stack, isWindowError, error) {\n    var exception;\n    handlers.forEach(function (handler) {\n        try {\n            handler(stack, isWindowError, error);\n        }\n        catch (inner) {\n            exception = inner;\n        }\n    });\n    if (exception) {\n        throw exception;\n    }\n}\nvar oldOnerrorHandler;\nvar onErrorHandlerInstalled;\nvar oldOnunhandledrejectionHandler;\nvar onUnhandledRejectionHandlerInstalled;\n/**\n * Ensures all global unhandled exceptions are recorded.\n * Supported by Gecko and IE.\n * @param {Event|string} message Error message.\n * @param {string=} url URL of script that generated the exception.\n * @param {(number|string)=} lineNo The line number at which the error occurred.\n * @param {(number|string)=} columnNo The column number at which the error occurred.\n * @param {Error=} errorObj The actual Error object.\n * @memberof report\n */\nexport function traceKitWindowOnError(message, url, lineNo, columnNo, errorObj) {\n    var stack;\n    if (lastExceptionStack) {\n        augmentStackTraceWithInitialElement(lastExceptionStack, url, lineNo);\n        processLastException();\n    }\n    else if (errorObj) {\n        stack = computeStackTrace(errorObj);\n        notifyHandlers(stack, true, errorObj);\n    }\n    else {\n        var location_1 = {\n            url: url,\n            column: columnNo,\n            line: lineNo,\n        };\n        var name_1;\n        var msg = message;\n        if ({}.toString.call(message) === '[object String]') {\n            var groups = ERROR_TYPES_RE.exec(msg);\n            if (groups) {\n                name_1 = groups[1];\n                msg = groups[2];\n            }\n        }\n        stack = {\n            name: name_1,\n            message: typeof msg === 'string' ? msg : undefined,\n            stack: [location_1],\n        };\n        notifyHandlers(stack, true, message);\n    }\n    if (oldOnerrorHandler) {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return oldOnerrorHandler.apply(this, arguments);\n    }\n    return false;\n}\n/**\n * Ensures all unhandled rejections are recorded.\n * @param {PromiseRejectionEvent} e event.\n * @memberof report\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onunhandledrejection\n * @see https://developer.mozilla.org/en-US/docs/Web/API/PromiseRejectionEvent\n */\nfunction traceKitWindowOnUnhandledRejection(e) {\n    var reason = e.reason || 'Empty reason';\n    var stack = computeStackTrace(reason);\n    notifyHandlers(stack, true, reason);\n}\n/**\n * Install a global onerror handler\n * @memberof report\n */\nfunction installGlobalHandler() {\n    if (onErrorHandlerInstalled) {\n        return;\n    }\n    oldOnerrorHandler = window.onerror;\n    window.onerror = monitor(traceKitWindowOnError);\n    onErrorHandlerInstalled = true;\n}\n/**\n * Uninstall the global onerror handler\n * @memberof report\n */\nfunction uninstallGlobalHandler() {\n    if (onErrorHandlerInstalled) {\n        window.onerror = oldOnerrorHandler;\n        onErrorHandlerInstalled = false;\n    }\n}\n/**\n * Install a global onunhandledrejection handler\n * @memberof report\n */\nfunction installGlobalUnhandledRejectionHandler() {\n    if (onUnhandledRejectionHandlerInstalled) {\n        return;\n    }\n    oldOnunhandledrejectionHandler = window.onunhandledrejection !== null ? window.onunhandledrejection : undefined;\n    window.onunhandledrejection = monitor(traceKitWindowOnUnhandledRejection);\n    onUnhandledRejectionHandlerInstalled = true;\n}\n/**\n * Uninstall the global onunhandledrejection handler\n * @memberof report\n */\nfunction uninstallGlobalUnhandledRejectionHandler() {\n    if (onUnhandledRejectionHandlerInstalled) {\n        window.onunhandledrejection = oldOnunhandledrejectionHandler;\n        onUnhandledRejectionHandlerInstalled = false;\n    }\n}\n/**\n * Process the most recent exception\n * @memberof report\n */\nfunction processLastException() {\n    var currentLastExceptionStack = lastExceptionStack;\n    var currentLastException = lastException;\n    lastExceptionStack = undefined;\n    lastException = undefined;\n    notifyHandlers(currentLastExceptionStack, false, currentLastException);\n}\n//# sourceMappingURL=report.js.map","import { report } from './report';\nvar UNKNOWN_FUNCTION = '?';\n/**\n * computeStackTrace: cross-browser stack traces in JavaScript\n *\n * Syntax:\n * ```js\n * s = computeStackTraceOfCaller([depth])\n * s = computeStackTrace(exception) // consider using report instead (see below)\n * ```\n *\n * Supports:\n *   - Firefox:  full stack trace with line numbers and unreliable column\n *               number on top frame\n *   - Opera 10: full stack trace with line and column numbers\n *   - Opera 9-: full stack trace with line numbers\n *   - Chrome:   full stack trace with line and column numbers\n *   - Safari:   line and column number for the topmost stacktrace element\n *               only\n *   - IE:       no line numbers whatsoever\n *\n * Tries to guess names of anonymous functions by looking for assignments\n * in the source code. In IE and Safari, we have to guess source file names\n * by searching for function bodies inside all page scripts. This will not\n * work for scripts that are loaded cross-domain.\n * Here be dragons: some function names may be guessed incorrectly, and\n * duplicate functions may be mismatched.\n *\n * computeStackTrace should only be used for tracing purposes.\n * Logging of unhandled exceptions should be done with report,\n * which builds on top of computeStackTrace and provides better\n * IE support by utilizing the window.onerror event to retrieve information\n * about the top of the stack.\n *\n * Note: In IE and Safari, no stack trace is recorded on the Error object,\n * so computeStackTrace instead walks its *own* chain of callers.\n * This means that:\n *  * in Safari, some methods may be missing from the stack trace;\n *  * in IE, the topmost function in the stack trace will always be the\n *    caller of computeStackTrace.\n *\n * This is okay for tracing (because you are likely to be calling\n * computeStackTrace from the function you want to be the topmost element\n * of the stack trace anyway), but not okay for logging unhandled\n * exceptions (because your catch block will likely be far away from the\n * inner function that actually caused the exception).\n *\n * Tracing example:\n * ```js\n *     function trace(message) {\n *         let stackInfo = computeStackTrace.ofCaller();\n *         let data = message + \"\\n\";\n *         for(let i in stackInfo.stack) {\n *             let item = stackInfo.stack[i];\n *             data += (item.func || '[anonymous]') + \"() in \" + item.url + \":\" + (item.line || '0') + \"\\n\";\n *         }\n *         if (window.console)\n *             console.info(data);\n *         else\n *             alert(data);\n *     }\n * ```\n * @memberof TraceKit\n * @namespace\n */\n/**\n * Computes a stack trace for an exception.\n * @param {Error} ex\n * @param {(string|number)=} depth\n * @memberof computeStackTrace\n */\nexport function computeStackTrace(ex, depth) {\n    var stack;\n    var normalizedDepth = depth === undefined ? 0 : +depth;\n    try {\n        // This must be tried first because Opera 10 *destroys*\n        // its stacktrace property if you try to access the stack\n        // property first!!\n        stack = computeStackTraceFromStacktraceProp(ex);\n        if (stack) {\n            return stack;\n        }\n    }\n    catch (e) {\n        if (debug) {\n            throw e;\n        }\n    }\n    try {\n        stack = computeStackTraceFromStackProp(ex);\n        if (stack) {\n            return stack;\n        }\n    }\n    catch (e) {\n        if (debug) {\n            throw e;\n        }\n    }\n    try {\n        stack = computeStackTraceFromOperaMultiLineMessage(ex);\n        if (stack) {\n            return stack;\n        }\n    }\n    catch (e) {\n        if (debug) {\n            throw e;\n        }\n    }\n    try {\n        stack = computeStackTraceByWalkingCallerChain(ex, normalizedDepth + 1);\n        if (stack) {\n            return stack;\n        }\n    }\n    catch (e) {\n        if (debug) {\n            throw e;\n        }\n    }\n    return {\n        message: tryToGetString(ex, 'message'),\n        name: tryToGetString(ex, 'name'),\n        stack: [],\n    };\n}\nvar debug = false;\n// Contents of Exception in various browsers.\n//\n// SAFARI:\n// ex.message = Can't find variable: qq\n// ex.line = 59\n// ex.sourceId = 580238192\n// ex.sourceURL = http://...\n// ex.expressionBeginOffset = 96\n// ex.expressionCaretOffset = 98\n// ex.expressionEndOffset = 98\n// ex.name = ReferenceError\n//\n// FIREFOX:\n// ex.message = qq is not defined\n// ex.fileName = http://...\n// ex.lineNumber = 59\n// ex.columnNumber = 69\n// ex.stack = ...stack trace... (see the example below)\n// ex.name = ReferenceError\n//\n// CHROME:\n// ex.message = qq is not defined\n// ex.name = ReferenceError\n// ex.type = not_defined\n// ex.arguments = ['aa']\n// ex.stack = ...stack trace...\n//\n// INTERNET EXPLORER:\n// ex.message = ...\n// ex.name = ReferenceError\n//\n// OPERA:\n// ex.message = ...message... (see the example below)\n// ex.name = ReferenceError\n// ex.opera#sourceloc = 11  (pretty much useless, duplicates the info in ex.message)\n// ex.stacktrace = n/a; see 'opera:config#UserPrefs|Exceptions Have Stacktrace'\n/**\n * Computes stack trace information from the stack property.\n * Chrome and Gecko use this property.\n * @param {Error} ex\n * @return {?StackTrace} Stack trace information.\n * @memberof computeStackTrace\n */\nexport function computeStackTraceFromStackProp(ex) {\n    var stacktrace = tryToGetString(ex, 'stack');\n    if (!stacktrace) {\n        return;\n    }\n    // eslint-disable-next-line  max-len\n    var chrome = /^\\s*at (.*?) ?\\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\\/).*?)(?::(\\d+))?(?::(\\d+))?\\)?\\s*$/i;\n    // eslint-disable-next-line  max-len\n    var gecko = /^\\s*(.*?)(?:\\((.*?)\\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|capacitor|\\[native).*?|[^@]*bundle)(?::(\\d+))?(?::(\\d+))?\\s*$/i;\n    // eslint-disable-next-line  max-len\n    var winjs = /^\\s*at (?:((?:\\[object object\\])?.+) )?\\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\\d+)(?::(\\d+))?\\)?\\s*$/i;\n    // Used to additionally parse URL/line/column from eval frames\n    var isEval;\n    var geckoEval = /(\\S+) line (\\d+)(?: > eval line \\d+)* > eval/i;\n    var chromeEval = /\\((\\S*)(?::(\\d+))(?::(\\d+))\\)/;\n    var lines = stacktrace.split('\\n');\n    var stack = [];\n    var submatch;\n    var parts;\n    var element;\n    for (var i = 0, j = lines.length; i < j; i += 1) {\n        if (chrome.exec(lines[i])) {\n            parts = chrome.exec(lines[i]);\n            var isNative = parts[2] && parts[2].indexOf('native') === 0; // start of line\n            isEval = parts[2] && parts[2].indexOf('eval') === 0; // start of line\n            submatch = chromeEval.exec(parts[2]);\n            if (isEval && submatch) {\n                // throw out eval line/column and use top-most line/column number\n                parts[2] = submatch[1]; // url\n                parts[3] = submatch[2]; // line\n                parts[4] = submatch[3]; // column\n            }\n            element = {\n                args: isNative ? [parts[2]] : [],\n                column: parts[4] ? +parts[4] : undefined,\n                func: parts[1] || UNKNOWN_FUNCTION,\n                line: parts[3] ? +parts[3] : undefined,\n                url: !isNative ? parts[2] : undefined,\n            };\n        }\n        else if (winjs.exec(lines[i])) {\n            parts = winjs.exec(lines[i]);\n            element = {\n                args: [],\n                column: parts[4] ? +parts[4] : undefined,\n                func: parts[1] || UNKNOWN_FUNCTION,\n                line: +parts[3],\n                url: parts[2],\n            };\n        }\n        else if (gecko.exec(lines[i])) {\n            parts = gecko.exec(lines[i]);\n            isEval = parts[3] && parts[3].indexOf(' > eval') > -1;\n            submatch = geckoEval.exec(parts[3]);\n            if (isEval && submatch) {\n                // throw out eval line/column and use top-most line number\n                parts[3] = submatch[1];\n                parts[4] = submatch[2];\n                parts[5] = undefined; // no column when eval\n            }\n            else if (i === 0 && !parts[5] && !isUndefined(ex.columnNumber)) {\n                // FireFox uses this awesome columnNumber property for its top frame\n                // Also note, Firefox's column number is 0-based and everything else expects 1-based,\n                // so adding 1\n                // NOTE: this hack doesn't work if top-most frame is eval\n                stack[0].column = ex.columnNumber + 1;\n            }\n            element = {\n                args: parts[2] ? parts[2].split(',') : [],\n                column: parts[5] ? +parts[5] : undefined,\n                func: parts[1] || UNKNOWN_FUNCTION,\n                line: parts[4] ? +parts[4] : undefined,\n                url: parts[3],\n            };\n        }\n        else {\n            continue;\n        }\n        if (!element.func && element.line) {\n            element.func = UNKNOWN_FUNCTION;\n        }\n        stack.push(element);\n    }\n    if (!stack.length) {\n        return;\n    }\n    return {\n        stack: stack,\n        message: tryToGetString(ex, 'message'),\n        name: tryToGetString(ex, 'name'),\n    };\n}\n/**\n * Computes stack trace information from the stacktrace property.\n * Opera 10+ uses this property.\n * @param {Error} ex\n * @return {?StackTrace} Stack trace information.\n * @memberof computeStackTrace\n */\nfunction computeStackTraceFromStacktraceProp(ex) {\n    // Access and store the stacktrace property before doing ANYTHING\n    // else to it because Opera is not very good at providing it\n    // reliably in other circumstances.\n    var stacktrace = tryToGetString(ex, 'stacktrace');\n    if (!stacktrace) {\n        return;\n    }\n    var opera10Regex = / line (\\d+).*script (?:in )?(\\S+)(?:: in function (\\S+))?$/i;\n    // eslint-disable-next-line  max-len\n    var opera11Regex = / line (\\d+), column (\\d+)\\s*(?:in (?:<anonymous function: ([^>]+)>|([^\\)]+))\\((.*)\\))? in (.*):\\s*$/i;\n    var lines = stacktrace.split('\\n');\n    var stack = [];\n    var parts;\n    for (var line = 0; line < lines.length; line += 2) {\n        var element = void 0;\n        if (opera10Regex.exec(lines[line])) {\n            parts = opera10Regex.exec(lines[line]);\n            element = {\n                args: [],\n                column: undefined,\n                func: parts[3],\n                line: +parts[1],\n                url: parts[2],\n            };\n        }\n        else if (opera11Regex.exec(lines[line])) {\n            parts = opera11Regex.exec(lines[line]);\n            element = {\n                args: parts[5] ? parts[5].split(',') : [],\n                column: +parts[2],\n                func: parts[3] || parts[4],\n                line: +parts[1],\n                url: parts[6],\n            };\n        }\n        if (element) {\n            if (!element.func && element.line) {\n                element.func = UNKNOWN_FUNCTION;\n            }\n            element.context = [lines[line + 1]];\n            stack.push(element);\n        }\n    }\n    if (!stack.length) {\n        return;\n    }\n    return {\n        stack: stack,\n        message: tryToGetString(ex, 'message'),\n        name: tryToGetString(ex, 'name'),\n    };\n}\n/**\n * NOT TESTED.\n * Computes stack trace information from an error message that includes\n * the stack trace.\n * Opera 9 and earlier use this method if the option to show stack\n * traces is turned on in opera:config.\n * @param {Error} ex\n * @return {?StackTrace} Stack information.\n * @memberof computeStackTrace\n */\nfunction computeStackTraceFromOperaMultiLineMessage(ex) {\n    // TODO: Clean this function up\n    // Opera includes a stack trace into the exception message. An example is:\n    //\n    // Statement on line 3: Undefined variable: undefinedFunc\n    // Backtrace:\n    //   Line 3 of linked script file://localhost/Users/andreyvit/Projects/TraceKit/javascript-client/sample.js:\n    //   In function zzz\n    //         undefinedFunc(a);\n    //   Line 7 of inline#1 script in file://localhost/Users/andreyvit/Projects/TraceKit/javascript-client/sample.html:\n    //   In function yyy\n    //           zzz(x, y, z);\n    //   Line 3 of inline#1 script in file://localhost/Users/andreyvit/Projects/TraceKit/javascript-client/sample.html:\n    //   In function xxx\n    //           yyy(a, a, a);\n    //   Line 1 of function script\n    //     try { xxx('hi'); return false; } catch(ex) { report(ex); }\n    //   ...\n    var message = tryToGetString(ex, 'message');\n    if (!message) {\n        return;\n    }\n    var lines = message.split('\\n');\n    if (lines.length < 4) {\n        return;\n    }\n    var lineRE1 = /^\\s*Line (\\d+) of linked script ((?:file|https?|blob)\\S+)(?:: in function (\\S+))?\\s*$/i;\n    var lineRE2 = /^\\s*Line (\\d+) of inline#(\\d+) script in ((?:file|https?|blob)\\S+)(?:: in function (\\S+))?\\s*$/i;\n    var lineRE3 = /^\\s*Line (\\d+) of function script\\s*$/i;\n    var stack = [];\n    var scripts = window && window.document && window.document.getElementsByTagName('script');\n    var inlineScriptBlocks = [];\n    var parts;\n    for (var s in scripts) {\n        if (has(scripts, s) && !scripts[s].src) {\n            inlineScriptBlocks.push(scripts[s]);\n        }\n    }\n    for (var line = 2; line < lines.length; line += 2) {\n        var item = void 0;\n        if (lineRE1.exec(lines[line])) {\n            parts = lineRE1.exec(lines[line]);\n            item = {\n                args: [],\n                column: undefined,\n                func: parts[3],\n                line: +parts[1],\n                url: parts[2],\n            };\n        }\n        else if (lineRE2.exec(lines[line])) {\n            parts = lineRE2.exec(lines[line]);\n            item = {\n                args: [],\n                column: undefined,\n                func: parts[4],\n                line: +parts[1],\n                url: parts[3],\n            };\n        }\n        else if (lineRE3.exec(lines[line])) {\n            parts = lineRE3.exec(lines[line]);\n            var url = window.location.href.replace(/#.*$/, '');\n            item = {\n                url: url,\n                args: [],\n                column: undefined,\n                func: '',\n                line: +parts[1],\n            };\n        }\n        if (item) {\n            if (!item.func) {\n                item.func = UNKNOWN_FUNCTION;\n            }\n            item.context = [lines[line + 1]];\n            stack.push(item);\n        }\n    }\n    if (!stack.length) {\n        return; // could not parse multiline exception message as Opera stack trace\n    }\n    return {\n        stack: stack,\n        message: lines[0],\n        name: tryToGetString(ex, 'name'),\n    };\n}\n/**\n * Adds information about the first frame to incomplete stack traces.\n * Safari and IE require this to get complete data on the first frame.\n * @param {StackTrace} stackInfo Stack trace information from\n * one of the compute* methods.\n * @param {string=} url The URL of the script that caused an error.\n * @param {(number|string)=} lineNo The line number of the script that\n * caused an error.\n * @param {string=} message The error generated by the browser, which\n * hopefully contains the name of the object that caused the error.\n * @return {boolean} Whether or not the stack information was\n * augmented.\n * @memberof computeStackTrace\n */\nexport function augmentStackTraceWithInitialElement(stackInfo, url, lineNo) {\n    var initial = {\n        url: url,\n        line: lineNo ? +lineNo : undefined,\n    };\n    if (initial.url && initial.line) {\n        stackInfo.incomplete = false;\n        var stack = stackInfo.stack;\n        if (stack.length > 0) {\n            if (stack[0].url === initial.url) {\n                if (stack[0].line === initial.line) {\n                    return false; // already in stack trace\n                }\n                if (!stack[0].line && stack[0].func === initial.func) {\n                    stack[0].line = initial.line;\n                    stack[0].context = initial.context;\n                    return false;\n                }\n            }\n        }\n        stack.unshift(initial);\n        stackInfo.partial = true;\n        return true;\n    }\n    stackInfo.incomplete = true;\n    return false;\n}\n/**\n * Computes stack trace information by walking the arguments.caller\n * chain at the time the exception occurred. This will cause earlier\n * frames to be missed but is the only way to get any stack trace in\n * Safari and IE. The top frame is restored by\n * {@link augmentStackTraceWithInitialElement}.\n * @param {Error} ex\n * @param {number} depth\n * @return {StackTrace} Stack trace information.\n * @memberof computeStackTrace\n */\nfunction computeStackTraceByWalkingCallerChain(ex, depth) {\n    var functionName = /function\\s+([_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*)?\\s*\\(/i;\n    var stack = [];\n    var funcs = {};\n    var recursion = false;\n    var parts;\n    var item;\n    for (var curr = computeStackTraceByWalkingCallerChain.caller; curr && !recursion; curr = curr.caller) {\n        if (curr === computeStackTrace || curr === report) {\n            continue;\n        }\n        item = {\n            args: [],\n            column: undefined,\n            func: UNKNOWN_FUNCTION,\n            line: undefined,\n            url: undefined,\n        };\n        parts = functionName.exec(curr.toString());\n        if (curr.name) {\n            item.func = curr.name;\n        }\n        else if (parts) {\n            item.func = parts[1];\n        }\n        if (typeof item.func === 'undefined') {\n            item.func = parts ? parts.input.substring(0, parts.input.indexOf('{')) : undefined;\n        }\n        if (funcs[curr.toString()]) {\n            recursion = true;\n        }\n        else {\n            funcs[curr.toString()] = true;\n        }\n        stack.push(item);\n    }\n    if (depth) {\n        stack.splice(0, depth);\n    }\n    var result = {\n        stack: stack,\n        message: tryToGetString(ex, 'message'),\n        name: tryToGetString(ex, 'name'),\n    };\n    augmentStackTraceWithInitialElement(result, tryToGetString(ex, 'sourceURL') || tryToGetString(ex, 'fileName'), tryToGetString(ex, 'line') || tryToGetString(ex, 'lineNumber'));\n    return result;\n}\nfunction tryToGetString(candidate, property) {\n    if (typeof candidate !== 'object' || !candidate || !(property in candidate)) {\n        return undefined;\n    }\n    var value = candidate[property];\n    return typeof value === 'string' ? value : undefined;\n}\n/**\n * Logs a stacktrace starting from the previous call and working down.\n * @param {(number|string)=} depth How many frames deep to trace.\n * @return {StackTrace} Stack trace information.\n * @memberof computeStackTrace\n */\nexport function computeStackTraceOfCaller(depth) {\n    var currentDepth = (depth === undefined ? 0 : +depth) + 1; // \"+ 1\" because \"ofCaller\" should drop one frame\n    try {\n        throw new Error();\n    }\n    catch (ex) {\n        return computeStackTrace(ex, currentDepth + 1);\n    }\n}\n/**\n * A better form of hasOwnProperty<br/>\n * Example: `has(MainHostObject, property) === true/false`\n *\n * @param {Object} object to check property\n * @param {string} key to check\n * @return {Boolean} true if the object has the key and it is not inherited\n */\nfunction has(object, key) {\n    return Object.prototype.hasOwnProperty.call(object, key);\n}\n/**\n * Returns true if the parameter is undefined<br/>\n * Example: `isUndefined(val) === true/false`\n *\n * @param {*} what Value to check\n * @return {Boolean} true if undefined and false otherwise\n */\nfunction isUndefined(what) {\n    return typeof what === 'undefined';\n}\n//# sourceMappingURL=computeStackTrace.js.map","import { callMonitored } from '../domain/internalMonitoring';\nimport { computeStackTrace } from '../domain/tracekit';\nimport { jsonStringify, noop } from './utils';\nexport var ErrorSource = {\n    AGENT: 'agent',\n    CONSOLE: 'console',\n    CUSTOM: 'custom',\n    LOGGER: 'logger',\n    NETWORK: 'network',\n    SOURCE: 'source',\n};\nexport var ErrorHandling;\n(function (ErrorHandling) {\n    ErrorHandling[\"HANDLED\"] = \"handled\";\n    ErrorHandling[\"UNHANDLED\"] = \"unhandled\";\n})(ErrorHandling || (ErrorHandling = {}));\nexport function formatUnknownError(stackTrace, errorObject, nonErrorPrefix, handlingStack) {\n    if (!stackTrace || (stackTrace.message === undefined && !(errorObject instanceof Error))) {\n        return {\n            message: nonErrorPrefix + \" \" + jsonStringify(errorObject),\n            stack: 'No stack, consider using an instance of Error',\n            handlingStack: handlingStack,\n            type: stackTrace && stackTrace.name,\n        };\n    }\n    return {\n        message: stackTrace.message || 'Empty message',\n        stack: toStackTraceString(stackTrace),\n        handlingStack: handlingStack,\n        type: stackTrace.name,\n    };\n}\nexport function toStackTraceString(stack) {\n    var result = formatErrorMessage(stack);\n    stack.stack.forEach(function (frame) {\n        var func = frame.func === '?' ? '<anonymous>' : frame.func;\n        var args = frame.args && frame.args.length > 0 ? \"(\" + frame.args.join(', ') + \")\" : '';\n        var line = frame.line ? \":\" + frame.line : '';\n        var column = frame.line && frame.column ? \":\" + frame.column : '';\n        result += \"\\n  at \" + func + args + \" @ \" + frame.url + line + column;\n    });\n    return result;\n}\nexport function formatErrorMessage(stack) {\n    return (stack.name || 'Error') + \": \" + stack.message;\n}\n/**\n Creates a stacktrace without SDK internal frames.\n \n Constraints:\n - Has to be called at the utmost position of the call stack.\n - No internal monitoring should encapsulate the function, that is why we need to use callMonitored inside of it.\n */\nexport function createHandlingStack() {\n    /**\n     * Skip the two internal frames:\n     * - SDK API (console.error, ...)\n     * - this function\n     * in order to keep only the user calls\n     */\n    var internalFramesToSkip = 2;\n    var error = new Error();\n    var formattedStack;\n    // IE needs to throw the error to fill in the stack trace\n    if (!error.stack) {\n        try {\n            throw error;\n        }\n        catch (e) {\n            noop();\n        }\n    }\n    callMonitored(function () {\n        var stackTrace = computeStackTrace(error);\n        stackTrace.stack = stackTrace.stack.slice(internalFramesToSkip);\n        formattedStack = toStackTraceString(stackTrace);\n    });\n    return formattedStack;\n}\n//# sourceMappingURL=error.js.map","import { __spreadArrays } from \"tslib\";\nimport { display } from '../tools/display';\nimport { addEventListener, jsonStringify, noop, objectValues } from '../tools/utils';\nimport { monitor, addErrorToMonitoringBatch, addMonitoringMessage } from '../domain/internalMonitoring';\n// https://en.wikipedia.org/wiki/UTF-8\nvar HAS_MULTI_BYTES_CHARACTERS = /[^\\u0000-\\u007F]/;\nvar hasReportedXhrError = false;\n/**\n * Use POST request without content type to:\n * - avoid CORS preflight requests\n * - allow usage of sendBeacon\n *\n * multiple elements are sent separated by \\n in order\n * to be parsed correctly without content type header\n */\nvar HttpRequest = /** @class */ (function () {\n    function HttpRequest(endpointUrl, bytesLimit, withBatchTime) {\n        if (withBatchTime === void 0) { withBatchTime = false; }\n        this.endpointUrl = endpointUrl;\n        this.bytesLimit = bytesLimit;\n        this.withBatchTime = withBatchTime;\n    }\n    HttpRequest.prototype.send = function (data, size) {\n        var url = this.withBatchTime ? addBatchTime(this.endpointUrl) : this.endpointUrl;\n        var tryBeacon = !!navigator.sendBeacon && size < this.bytesLimit;\n        if (tryBeacon) {\n            try {\n                var isQueued = navigator.sendBeacon(url, data);\n                if (isQueued) {\n                    return;\n                }\n            }\n            catch (e) {\n                reportBeaconError(e);\n            }\n        }\n        var transportIntrospection = function (event) {\n            var req = event === null || event === void 0 ? void 0 : event.currentTarget;\n            if (req.status >= 200 && req.status < 300) {\n                return;\n            }\n            if (!hasReportedXhrError) {\n                hasReportedXhrError = true;\n                addMonitoringMessage('XHR fallback failed', {\n                    on_line: navigator.onLine,\n                    size: size,\n                    url: url,\n                    try_beacon: tryBeacon,\n                    event: {\n                        is_trusted: event.isTrusted,\n                        total: event.total,\n                        loaded: event.loaded,\n                    },\n                    request: {\n                        status: req.status,\n                        ready_state: req.readyState,\n                        response_text: req.responseText.slice(0, 64),\n                    },\n                });\n            }\n        };\n        var request = new XMLHttpRequest();\n        request.addEventListener('loadend', monitor(function (event) { return transportIntrospection(event); }));\n        request.open('POST', url, true);\n        request.send(data);\n    };\n    return HttpRequest;\n}());\nexport { HttpRequest };\nfunction addBatchTime(url) {\n    return \"\" + url + (url.indexOf('?') === -1 ? '?' : '&') + \"batch_time=\" + new Date().getTime();\n}\nvar hasReportedBeaconError = false;\nfunction reportBeaconError(e) {\n    if (!hasReportedBeaconError) {\n        hasReportedBeaconError = true;\n        addErrorToMonitoringBatch(e);\n    }\n}\nvar Batch = /** @class */ (function () {\n    function Batch(request, maxSize, bytesLimit, maxMessageSize, flushTimeout, beforeUnloadCallback) {\n        if (beforeUnloadCallback === void 0) { beforeUnloadCallback = noop; }\n        this.request = request;\n        this.maxSize = maxSize;\n        this.bytesLimit = bytesLimit;\n        this.maxMessageSize = maxMessageSize;\n        this.flushTimeout = flushTimeout;\n        this.beforeUnloadCallback = beforeUnloadCallback;\n        this.pushOnlyBuffer = [];\n        this.upsertBuffer = {};\n        this.bufferBytesSize = 0;\n        this.bufferMessageCount = 0;\n        this.flushOnVisibilityHidden();\n        this.flushPeriodically();\n    }\n    Batch.prototype.add = function (message) {\n        this.addOrUpdate(message);\n    };\n    Batch.prototype.upsert = function (message, key) {\n        this.addOrUpdate(message, key);\n    };\n    Batch.prototype.flush = function () {\n        if (this.bufferMessageCount !== 0) {\n            var messages = __spreadArrays(this.pushOnlyBuffer, objectValues(this.upsertBuffer));\n            this.request.send(messages.join('\\n'), this.bufferBytesSize);\n            this.pushOnlyBuffer = [];\n            this.upsertBuffer = {};\n            this.bufferBytesSize = 0;\n            this.bufferMessageCount = 0;\n        }\n    };\n    Batch.prototype.sizeInBytes = function (candidate) {\n        // Accurate byte size computations can degrade performances when there is a lot of events to process\n        if (!HAS_MULTI_BYTES_CHARACTERS.test(candidate)) {\n            return candidate.length;\n        }\n        if (window.TextEncoder !== undefined) {\n            return new TextEncoder().encode(candidate).length;\n        }\n        return new Blob([candidate]).size;\n    };\n    Batch.prototype.addOrUpdate = function (message, key) {\n        var _a = this.process(message), processedMessage = _a.processedMessage, messageBytesSize = _a.messageBytesSize;\n        if (messageBytesSize >= this.maxMessageSize) {\n            display.warn(\"Discarded a message whose size was bigger than the maximum allowed size \" + this.maxMessageSize + \"KB.\");\n            return;\n        }\n        if (this.hasMessageFor(key)) {\n            this.remove(key);\n        }\n        if (this.willReachedBytesLimitWith(messageBytesSize)) {\n            this.flush();\n        }\n        this.push(processedMessage, messageBytesSize, key);\n        if (this.isFull()) {\n            this.flush();\n        }\n    };\n    Batch.prototype.process = function (message) {\n        var processedMessage = jsonStringify(message);\n        var messageBytesSize = this.sizeInBytes(processedMessage);\n        return { processedMessage: processedMessage, messageBytesSize: messageBytesSize };\n    };\n    Batch.prototype.push = function (processedMessage, messageBytesSize, key) {\n        if (this.bufferMessageCount > 0) {\n            // \\n separator at serialization\n            this.bufferBytesSize += 1;\n        }\n        if (key !== undefined) {\n            this.upsertBuffer[key] = processedMessage;\n        }\n        else {\n            this.pushOnlyBuffer.push(processedMessage);\n        }\n        this.bufferBytesSize += messageBytesSize;\n        this.bufferMessageCount += 1;\n    };\n    Batch.prototype.remove = function (key) {\n        var removedMessage = this.upsertBuffer[key];\n        delete this.upsertBuffer[key];\n        var messageBytesSize = this.sizeInBytes(removedMessage);\n        this.bufferBytesSize -= messageBytesSize;\n        this.bufferMessageCount -= 1;\n        if (this.bufferMessageCount > 0) {\n            this.bufferBytesSize -= 1;\n        }\n    };\n    Batch.prototype.hasMessageFor = function (key) {\n        return key !== undefined && this.upsertBuffer[key] !== undefined;\n    };\n    Batch.prototype.willReachedBytesLimitWith = function (messageBytesSize) {\n        // byte of the separator at the end of the message\n        return this.bufferBytesSize + messageBytesSize + 1 >= this.bytesLimit;\n    };\n    Batch.prototype.isFull = function () {\n        return this.bufferMessageCount === this.maxSize || this.bufferBytesSize >= this.bytesLimit;\n    };\n    Batch.prototype.flushPeriodically = function () {\n        var _this = this;\n        setTimeout(monitor(function () {\n            _this.flush();\n            _this.flushPeriodically();\n        }), this.flushTimeout);\n    };\n    Batch.prototype.flushOnVisibilityHidden = function () {\n        var _this = this;\n        /**\n         * With sendBeacon, requests are guaranteed to be successfully sent during document unload\n         */\n        // @ts-ignore this function is not always defined\n        if (navigator.sendBeacon) {\n            /**\n             * beforeunload is called before visibilitychange\n             * register first to be sure to be called before flush on beforeunload\n             * caveat: unload can still be canceled by another listener\n             */\n            addEventListener(window, \"beforeunload\" /* BEFORE_UNLOAD */, this.beforeUnloadCallback);\n            /**\n             * Only event that guarantee to fire on mobile devices when the page transitions to background state\n             * (e.g. when user switches to a different application, goes to homescreen, etc), or is being unloaded.\n             */\n            addEventListener(document, \"visibilitychange\" /* VISIBILITY_CHANGE */, function () {\n                if (document.visibilityState === 'hidden') {\n                    _this.flush();\n                }\n            });\n            /**\n             * Safari does not support yet to send a request during:\n             * - a visibility change during doc unload (cf: https://bugs.webkit.org/show_bug.cgi?id=194897)\n             * - a page hide transition (cf: https://bugs.webkit.org/show_bug.cgi?id=188329)\n             */\n            addEventListener(window, \"beforeunload\" /* BEFORE_UNLOAD */, function () { return _this.flush(); });\n        }\n    };\n    return Batch;\n}());\nexport { Batch };\n//# sourceMappingURL=transport.js.map","import { __assign } from \"tslib\";\nimport { combine } from '../tools/context';\nimport { display } from '../tools/display';\nimport { toStackTraceString } from '../tools/error';\nimport { assign, jsonStringify } from '../tools/utils';\nimport { Batch, HttpRequest } from '../transport/transport';\nimport { computeStackTrace } from './tracekit';\nvar StatusType;\n(function (StatusType) {\n    StatusType[\"info\"] = \"info\";\n    StatusType[\"error\"] = \"error\";\n})(StatusType || (StatusType = {}));\nvar monitoringConfiguration = { maxMessagesPerPage: 0, sentMessageCount: 0 };\nvar externalContextProvider;\nexport function startInternalMonitoring(configuration) {\n    if (configuration.internalMonitoringEndpoint) {\n        var batch = startMonitoringBatch(configuration);\n        assign(monitoringConfiguration, {\n            batch: batch,\n            maxMessagesPerPage: configuration.maxInternalMonitoringMessagesPerPage,\n            sentMessageCount: 0,\n        });\n    }\n    return {\n        setExternalContextProvider: function (provider) {\n            externalContextProvider = provider;\n        },\n    };\n}\nfunction startMonitoringBatch(configuration) {\n    var primaryBatch = createMonitoringBatch(configuration.internalMonitoringEndpoint);\n    var replicaBatch;\n    if (configuration.replica !== undefined) {\n        replicaBatch = createMonitoringBatch(configuration.replica.internalMonitoringEndpoint);\n    }\n    function createMonitoringBatch(endpointUrl) {\n        return new Batch(new HttpRequest(endpointUrl, configuration.batchBytesLimit), configuration.maxBatchSize, configuration.batchBytesLimit, configuration.maxMessageSize, configuration.flushTimeout);\n    }\n    function withContext(message) {\n        return combine({\n            date: new Date().getTime(),\n            view: {\n                referrer: document.referrer,\n                url: window.location.href,\n            },\n        }, externalContextProvider !== undefined ? externalContextProvider() : {}, message);\n    }\n    return {\n        add: function (message) {\n            var contextualizedMessage = withContext(message);\n            primaryBatch.add(contextualizedMessage);\n            if (replicaBatch) {\n                replicaBatch.add(contextualizedMessage);\n            }\n        },\n    };\n}\nexport function resetInternalMonitoring() {\n    monitoringConfiguration.batch = undefined;\n}\nexport function monitored(_, __, descriptor) {\n    var originalMethod = descriptor.value;\n    descriptor.value = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var decorated = monitoringConfiguration.batch ? monitor(originalMethod) : originalMethod;\n        return decorated.apply(this, args);\n    };\n}\nexport function monitor(fn) {\n    return function () {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return callMonitored(fn, this, arguments);\n    }; // consider output type has input type\n}\nexport function callMonitored(fn, context, args) {\n    try {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return fn.apply(context, args);\n    }\n    catch (e) {\n        logErrorIfDebug(e);\n        try {\n            addErrorToMonitoringBatch(e);\n        }\n        catch (e) {\n            logErrorIfDebug(e);\n        }\n    }\n}\nexport function addMonitoringMessage(message, context) {\n    logMessageIfDebug(message);\n    addToMonitoringBatch(__assign(__assign({ message: message }, context), { status: StatusType.info }));\n}\nexport function addErrorToMonitoringBatch(e) {\n    addToMonitoringBatch(__assign(__assign({}, formatError(e)), { status: StatusType.error }));\n}\nfunction addToMonitoringBatch(message) {\n    if (monitoringConfiguration.batch &&\n        monitoringConfiguration.sentMessageCount < monitoringConfiguration.maxMessagesPerPage) {\n        monitoringConfiguration.sentMessageCount += 1;\n        monitoringConfiguration.batch.add(message);\n    }\n}\nfunction formatError(e) {\n    if (e instanceof Error) {\n        var stackTrace = computeStackTrace(e);\n        return {\n            error: {\n                kind: stackTrace.name,\n                stack: toStackTraceString(stackTrace),\n            },\n            message: stackTrace.message,\n        };\n    }\n    return {\n        error: {\n            stack: 'Not an instance of error',\n        },\n        message: \"Uncaught \" + jsonStringify(e),\n    };\n}\nexport function setDebugMode(debugMode) {\n    monitoringConfiguration.debugMode = debugMode;\n}\nfunction logErrorIfDebug(e) {\n    if (monitoringConfiguration.debugMode) {\n        display.error('[INTERNAL ERROR]', e);\n    }\n}\nfunction logMessageIfDebug(message) {\n    if (monitoringConfiguration.debugMode) {\n        display.log('[MONITORING MESSAGE]', message);\n    }\n}\n//# sourceMappingURL=internalMonitoring.js.map","import { monitor } from '../domain/internalMonitoring';\nexport var ONE_SECOND = 1000;\nexport var ONE_MINUTE = 60 * ONE_SECOND;\nexport var ONE_HOUR = 60 * ONE_MINUTE;\nexport var ONE_DAY = 24 * ONE_HOUR;\nexport var ONE_KILO_BYTE = 1024;\nexport var ResourceType;\n(function (ResourceType) {\n    ResourceType[\"DOCUMENT\"] = \"document\";\n    ResourceType[\"XHR\"] = \"xhr\";\n    ResourceType[\"BEACON\"] = \"beacon\";\n    ResourceType[\"FETCH\"] = \"fetch\";\n    ResourceType[\"CSS\"] = \"css\";\n    ResourceType[\"JS\"] = \"js\";\n    ResourceType[\"IMAGE\"] = \"image\";\n    ResourceType[\"FONT\"] = \"font\";\n    ResourceType[\"MEDIA\"] = \"media\";\n    ResourceType[\"OTHER\"] = \"other\";\n})(ResourceType || (ResourceType = {}));\nexport var RequestType;\n(function (RequestType) {\n    RequestType[\"FETCH\"] = \"fetch\";\n    RequestType[\"XHR\"] = \"xhr\";\n})(RequestType || (RequestType = {}));\n// use lodash API\nexport function throttle(fn, wait, options) {\n    var needLeadingExecution = options && options.leading !== undefined ? options.leading : true;\n    var needTrailingExecution = options && options.trailing !== undefined ? options.trailing : true;\n    var inWaitPeriod = false;\n    var pendingExecutionWithParameters;\n    var pendingTimeoutId;\n    return {\n        throttled: function () {\n            var parameters = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                parameters[_i] = arguments[_i];\n            }\n            if (inWaitPeriod) {\n                pendingExecutionWithParameters = parameters;\n                return;\n            }\n            if (needLeadingExecution) {\n                fn.apply(void 0, parameters);\n            }\n            else {\n                pendingExecutionWithParameters = parameters;\n            }\n            inWaitPeriod = true;\n            pendingTimeoutId = setTimeout(function () {\n                if (needTrailingExecution && pendingExecutionWithParameters) {\n                    fn.apply(void 0, pendingExecutionWithParameters);\n                }\n                inWaitPeriod = false;\n                pendingExecutionWithParameters = undefined;\n            }, wait);\n        },\n        cancel: function () {\n            clearTimeout(pendingTimeoutId);\n            inWaitPeriod = false;\n            pendingExecutionWithParameters = undefined;\n        },\n    };\n}\nexport function assign(target) {\n    var toAssign = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        toAssign[_i - 1] = arguments[_i];\n    }\n    toAssign.forEach(function (source) {\n        for (var key in source) {\n            if (Object.prototype.hasOwnProperty.call(source, key)) {\n                target[key] = source[key];\n            }\n        }\n    });\n}\n/**\n * UUID v4\n * from https://gist.github.com/jed/982883\n */\nexport function generateUUID(placeholder) {\n    return placeholder\n        ? // eslint-disable-next-line  no-bitwise\n            (parseInt(placeholder, 10) ^ ((Math.random() * 16) >> (parseInt(placeholder, 10) / 4))).toString(16)\n        : (1e7 + \"-\" + 1e3 + \"-\" + 4e3 + \"-\" + 8e3 + \"-\" + 1e11).replace(/[018]/g, generateUUID);\n}\n/**\n * Return true if the draw is successful\n * @param threshold between 0 and 100\n */\nexport function performDraw(threshold) {\n    return threshold !== 0 && Math.random() * 100 <= threshold;\n}\nexport function round(num, decimals) {\n    return +num.toFixed(decimals);\n}\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport function noop() { }\n/**\n * Custom implementation of JSON.stringify that ignores value.toJSON.\n * We need to do that because some sites badly override toJSON on certain objects.\n * Note this still supposes that JSON.stringify is correct...\n */\nexport function jsonStringify(value, replacer, space) {\n    if (value === null || value === undefined) {\n        return JSON.stringify(value);\n    }\n    var originalToJSON = [false, undefined];\n    if (hasToJSON(value)) {\n        // We need to add a flag and not rely on the truthiness of value.toJSON\n        // because it can be set but undefined and that's actually significant.\n        originalToJSON = [true, value.toJSON];\n        delete value.toJSON;\n    }\n    var originalProtoToJSON = [false, undefined];\n    var prototype;\n    if (typeof value === 'object') {\n        prototype = Object.getPrototypeOf(value);\n        if (hasToJSON(prototype)) {\n            originalProtoToJSON = [true, prototype.toJSON];\n            delete prototype.toJSON;\n        }\n    }\n    var result;\n    try {\n        result = JSON.stringify(value, replacer, space);\n    }\n    catch (_a) {\n        result = '<error: unable to serialize object>';\n    }\n    finally {\n        if (originalToJSON[0]) {\n            ;\n            value.toJSON = originalToJSON[1];\n        }\n        if (originalProtoToJSON[0]) {\n            ;\n            prototype.toJSON = originalProtoToJSON[1];\n        }\n    }\n    return result;\n}\nfunction hasToJSON(value) {\n    return typeof value === 'object' && value !== null && value.hasOwnProperty('toJSON');\n}\nexport function includes(candidate, search) {\n    return candidate.indexOf(search) !== -1;\n}\nexport function find(array, predicate) {\n    for (var i = 0; i < array.length; i += 1) {\n        var item = array[i];\n        if (predicate(item, i, array)) {\n            return item;\n        }\n    }\n    return undefined;\n}\nexport function isPercentage(value) {\n    return isNumber(value) && value >= 0 && value <= 100;\n}\nexport function isNumber(value) {\n    return typeof value === 'number';\n}\nexport function objectValues(object) {\n    var values = [];\n    Object.keys(object).forEach(function (key) {\n        values.push(object[key]);\n    });\n    return values;\n}\nexport function objectEntries(object) {\n    return Object.keys(object).map(function (key) { return [key, object[key]]; });\n}\nexport function isEmptyObject(object) {\n    return Object.keys(object).length === 0;\n}\nexport function mapValues(object, fn) {\n    var newObject = {};\n    for (var _i = 0, _a = Object.keys(object); _i < _a.length; _i++) {\n        var key = _a[_i];\n        newObject[key] = fn(object[key]);\n    }\n    return newObject;\n}\n/**\n * inspired by https://mathiasbynens.be/notes/globalthis\n */\nexport function getGlobalObject() {\n    if (typeof globalThis === 'object') {\n        return globalThis;\n    }\n    Object.defineProperty(Object.prototype, '_dd_temp_', {\n        get: function () {\n            return this;\n        },\n        configurable: true,\n    });\n    // @ts-ignore _dd_temp is defined using defineProperty\n    var globalObject = _dd_temp_;\n    // @ts-ignore _dd_temp is defined using defineProperty\n    delete Object.prototype._dd_temp_;\n    if (typeof globalObject !== 'object') {\n        // on safari _dd_temp_ is available on window but not globally\n        // fallback on other browser globals check\n        if (typeof self === 'object') {\n            globalObject = self;\n        }\n        else if (typeof window === 'object') {\n            globalObject = window;\n        }\n        else {\n            globalObject = {};\n        }\n    }\n    return globalObject;\n}\nexport function getLocationOrigin() {\n    return getLinkElementOrigin(window.location);\n}\n/**\n * IE fallback\n * https://developer.mozilla.org/en-US/docs/Web/API/HTMLHyperlinkElementUtils/origin\n */\nexport function getLinkElementOrigin(element) {\n    if (element.origin) {\n        return element.origin;\n    }\n    var sanitizedHost = element.host.replace(/(:80|:443)$/, '');\n    return element.protocol + \"//\" + sanitizedHost;\n}\nexport function findCommaSeparatedValue(rawString, name) {\n    var regex = new RegExp(\"(?:^|;)\\\\s*\" + name + \"\\\\s*=\\\\s*([^;]+)\");\n    var matches = regex.exec(rawString);\n    return matches ? matches[1] : undefined;\n}\nexport function safeTruncate(candidate, length) {\n    var lastChar = candidate.charCodeAt(length - 1);\n    // check if it is the high part of a surrogate pair\n    if (lastChar >= 0xd800 && lastChar <= 0xdbff) {\n        return candidate.slice(0, length + 1);\n    }\n    return candidate.slice(0, length);\n}\n/**\n * Add an event listener to an event emitter object (Window, Element, mock object...).  This provides\n * a few conveniences compared to using `element.addEventListener` directly:\n *\n * * supports IE11 by: using an option object only if needed and emulating the `once` option\n *\n * * wraps the listener with a `monitor` function\n *\n * * returns a `stop` function to remove the listener\n */\nexport function addEventListener(emitter, event, listener, options) {\n    return addEventListeners(emitter, [event], listener, options);\n}\n/**\n * Add event listeners to an event emitter object (Window, Element, mock object...).  This provides\n * a few conveniences compared to using `element.addEventListener` directly:\n *\n * * supports IE11 by: using an option object only if needed and emulating the `once` option\n *\n * * wraps the listener with a `monitor` function\n *\n * * returns a `stop` function to remove the listener\n *\n * * with `once: true`, the listener will be called at most once, even if different events are listened\n */\nexport function addEventListeners(emitter, events, listener, _a) {\n    var _b = _a === void 0 ? {} : _a, once = _b.once, capture = _b.capture, passive = _b.passive;\n    var wrappedListener = monitor(once\n        ? function (event) {\n            stop();\n            listener(event);\n        }\n        : listener);\n    var options = passive ? { capture: capture, passive: passive } : capture;\n    events.forEach(function (event) { return emitter.addEventListener(event, wrappedListener, options); });\n    var stop = function () { return events.forEach(function (event) { return emitter.removeEventListener(event, wrappedListener, options); }); };\n    return {\n        stop: stop,\n    };\n}\nexport function runOnReadyState(expectedReadyState, callback) {\n    if (document.readyState === expectedReadyState || document.readyState === 'complete') {\n        callback();\n    }\n    else {\n        var eventName = expectedReadyState === 'complete' ? \"load\" /* LOAD */ : \"DOMContentLoaded\" /* DOM_CONTENT_LOADED */;\n        addEventListener(window, eventName, callback, { once: true });\n    }\n}\n//# sourceMappingURL=utils.js.map","import { display } from '../tools/display';\nimport { findCommaSeparatedValue, generateUUID, ONE_SECOND } from '../tools/utils';\nexport var COOKIE_ACCESS_DELAY = ONE_SECOND;\nexport function cacheCookieAccess(name, options) {\n    var timeout;\n    var cache;\n    var hasCache = false;\n    var cacheAccess = function () {\n        hasCache = true;\n        clearTimeout(timeout);\n        timeout = setTimeout(function () {\n            hasCache = false;\n        }, COOKIE_ACCESS_DELAY);\n    };\n    return {\n        get: function () {\n            if (hasCache) {\n                return cache;\n            }\n            cache = getCookie(name);\n            cacheAccess();\n            return cache;\n        },\n        set: function (value, expireDelay) {\n            setCookie(name, value, expireDelay, options);\n            cache = value;\n            cacheAccess();\n        },\n    };\n}\nexport function setCookie(name, value, expireDelay, options) {\n    var date = new Date();\n    date.setTime(date.getTime() + expireDelay);\n    var expires = \"expires=\" + date.toUTCString();\n    var sameSite = options && options.crossSite ? 'none' : 'strict';\n    var domain = options && options.domain ? \";domain=\" + options.domain : '';\n    var secure = options && options.secure ? \";secure\" : '';\n    document.cookie = name + \"=\" + value + \";\" + expires + \";path=/;samesite=\" + sameSite + domain + secure;\n}\nexport function getCookie(name) {\n    return findCommaSeparatedValue(document.cookie, name);\n}\nexport function areCookiesAuthorized(options) {\n    if (document.cookie === undefined || document.cookie === null) {\n        return false;\n    }\n    try {\n        // Use a unique cookie name to avoid issues when the SDK is initialized multiple times during\n        // the test cookie lifetime\n        var testCookieName = \"dd_cookie_test_\" + generateUUID();\n        var testCookieValue = 'test';\n        setCookie(testCookieName, testCookieValue, ONE_SECOND, options);\n        return getCookie(testCookieName) === testCookieValue;\n    }\n    catch (error) {\n        display.error(error);\n        return false;\n    }\n}\n/**\n * No API to retrieve it, number of levels for subdomain and suffix are unknown\n * strategy: find the minimal domain on which cookies are allowed to be set\n * https://web.dev/same-site-same-origin/#site\n */\nvar getCurrentSiteCache;\nexport function getCurrentSite() {\n    if (getCurrentSiteCache === undefined) {\n        // Use a unique cookie name to avoid issues when the SDK is initialized multiple times during\n        // the test cookie lifetime\n        var testCookieName = \"dd_site_test_\" + generateUUID();\n        var testCookieValue = 'test';\n        var domainLevels = window.location.hostname.split('.');\n        var candidateDomain = domainLevels.pop();\n        while (domainLevels.length && !getCookie(testCookieName)) {\n            candidateDomain = domainLevels.pop() + \".\" + candidateDomain;\n            setCookie(testCookieName, testCookieValue, ONE_SECOND, { domain: candidateDomain });\n        }\n        getCurrentSiteCache = candidateDomain;\n    }\n    return getCurrentSiteCache;\n}\n//# sourceMappingURL=cookie.js.map","var _a;\nimport { __assign } from \"tslib\";\nimport { BuildMode } from '../boot/init';\nimport { includes } from '../tools/utils';\nvar ENDPOINTS = {\n    alternate: {\n        logs: 'logs',\n        rum: 'rum',\n        sessionReplay: 'session-replay',\n        trace: 'trace',\n    },\n    classic: {\n        logs: 'browser',\n        rum: 'rum',\n        // session-replay has no classic endpoint\n        sessionReplay: undefined,\n        trace: 'public-trace',\n    },\n};\nexport var Datacenter = {\n    EU: 'eu',\n    US: 'us',\n};\nexport var INTAKE_SITE = (_a = {},\n    _a[Datacenter.EU] = 'datadoghq.eu',\n    _a[Datacenter.US] = 'datadoghq.com',\n    _a);\nvar CLASSIC_ALLOWED_SITES = [INTAKE_SITE[Datacenter.US], INTAKE_SITE[Datacenter.EU]];\nexport function computeTransportConfiguration(userConfiguration, buildEnv) {\n    var transportSettings = {\n        buildMode: buildEnv.buildMode,\n        clientToken: userConfiguration.clientToken,\n        env: userConfiguration.env,\n        proxyHost: userConfiguration.proxyHost,\n        sdkVersion: buildEnv.sdkVersion,\n        service: userConfiguration.service,\n        site: userConfiguration.site || INTAKE_SITE[userConfiguration.datacenter || buildEnv.datacenter],\n        version: userConfiguration.version,\n    };\n    var intakeType = getIntakeType(transportSettings.site, userConfiguration);\n    var intakeUrls = getIntakeUrls(intakeType, transportSettings, userConfiguration.replica !== undefined);\n    var configuration = {\n        isIntakeUrl: function (url) { return intakeUrls.some(function (intakeUrl) { return url.indexOf(intakeUrl) === 0; }); },\n        logsEndpoint: getEndpoint(intakeType, 'logs', transportSettings),\n        rumEndpoint: getEndpoint(intakeType, 'rum', transportSettings),\n        sessionReplayEndpoint: getEndpoint(intakeType, 'sessionReplay', transportSettings),\n        traceEndpoint: getEndpoint(intakeType, 'trace', transportSettings),\n    };\n    if (userConfiguration.internalMonitoringApiKey) {\n        configuration.internalMonitoringEndpoint = getEndpoint(intakeType, 'logs', transportSettings, 'browser-agent-internal-monitoring');\n    }\n    if (transportSettings.buildMode === BuildMode.E2E_TEST) {\n        configuration.internalMonitoringEndpoint = '<<< E2E INTERNAL MONITORING ENDPOINT >>>';\n        configuration.logsEndpoint = '<<< E2E LOGS ENDPOINT >>>';\n        configuration.rumEndpoint = '<<< E2E RUM ENDPOINT >>>';\n        configuration.sessionReplayEndpoint = '<<< E2E SESSION REPLAY ENDPOINT >>>';\n    }\n    if (transportSettings.buildMode === BuildMode.STAGING) {\n        if (userConfiguration.replica !== undefined) {\n            var replicaTransportSettings = __assign(__assign({}, transportSettings), { applicationId: userConfiguration.replica.applicationId, clientToken: userConfiguration.replica.clientToken, site: INTAKE_SITE[Datacenter.US] });\n            configuration.replica = {\n                applicationId: userConfiguration.replica.applicationId,\n                internalMonitoringEndpoint: getEndpoint(intakeType, 'logs', replicaTransportSettings, 'browser-agent-internal-monitoring'),\n                logsEndpoint: getEndpoint(intakeType, 'logs', replicaTransportSettings),\n                rumEndpoint: getEndpoint(intakeType, 'rum', replicaTransportSettings),\n            };\n        }\n    }\n    return configuration;\n}\nfunction getIntakeType(site, userConfiguration) {\n    return !userConfiguration.useAlternateIntakeDomains && includes(CLASSIC_ALLOWED_SITES, site) ? 'classic' : 'alternate';\n}\nfunction getIntakeUrls(intakeType, settings, withReplica) {\n    if (settings.proxyHost) {\n        return [\"https://\" + settings.proxyHost + \"/v1/input/\"];\n    }\n    var sites = [settings.site];\n    if (settings.buildMode === BuildMode.STAGING && withReplica) {\n        sites.push(INTAKE_SITE[Datacenter.US]);\n    }\n    var urls = [];\n    var endpointTypes = Object.keys(ENDPOINTS[intakeType]);\n    for (var _i = 0, sites_1 = sites; _i < sites_1.length; _i++) {\n        var site = sites_1[_i];\n        for (var _a = 0, endpointTypes_1 = endpointTypes; _a < endpointTypes_1.length; _a++) {\n            var endpointType = endpointTypes_1[_a];\n            urls.push(\"https://\" + getHost(intakeType, endpointType, site) + \"/v1/input/\");\n        }\n    }\n    return urls;\n}\nfunction getHost(intakeType, endpointType, site) {\n    return (intakeType === 'classic' && getClassicHost(endpointType, site)) || getAlternateHost(endpointType, site);\n}\nfunction getClassicHost(endpointType, site) {\n    var endpoint = ENDPOINTS.classic[endpointType];\n    return endpoint && endpoint + \"-http-intake.logs.\" + site;\n}\nfunction getAlternateHost(endpointType, site) {\n    var endpoint = ENDPOINTS.alternate[endpointType];\n    var domainParts = site.split('.');\n    var extension = domainParts.pop();\n    var suffix = domainParts.join('-') + \".\" + extension;\n    return endpoint + \".browser-intake-\" + suffix;\n}\nfunction getEndpoint(intakeType, endpointType, settings, source) {\n    var tags = \"sdk_version:\" + settings.sdkVersion +\n        (\"\" + (settings.env ? \",env:\" + settings.env : '')) +\n        (\"\" + (settings.service ? \",service:\" + settings.service : '')) +\n        (\"\" + (settings.version ? \",version:\" + settings.version : ''));\n    var datadogHost = getHost(intakeType, endpointType, settings.site);\n    var host = settings.proxyHost ? settings.proxyHost : datadogHost;\n    var proxyParameter = settings.proxyHost ? \"ddhost=\" + datadogHost + \"&\" : '';\n    var parameters = proxyParameter + \"ddsource=\" + (source || 'browser') + \"&ddtags=\" + encodeURIComponent(tags);\n    return \"https://\" + host + \"/v1/input/\" + settings.clientToken + \"?\" + parameters;\n}\n//# sourceMappingURL=transportConfiguration.js.map","import { display } from './display';\nexport function catchUserErrors(fn, errorMsg) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        try {\n            return fn.apply(void 0, args);\n        }\n        catch (err) {\n            display.error(errorMsg, err);\n        }\n    };\n}\n//# sourceMappingURL=catchUserErrors.js.map","import { __assign } from \"tslib\";\nimport { getCurrentSite } from '../browser/cookie';\nimport { catchUserErrors } from '../tools/catchUserErrors';\nimport { includes, ONE_KILO_BYTE, ONE_SECOND } from '../tools/utils';\nimport { computeTransportConfiguration } from './transportConfiguration';\nexport var DEFAULT_CONFIGURATION = {\n    allowedTracingOrigins: [],\n    maxErrorsByMinute: 3000,\n    maxInternalMonitoringMessagesPerPage: 15,\n    resourceSampleRate: 100,\n    sampleRate: 100,\n    silentMultipleInit: false,\n    trackInteractions: false,\n    trackViewsManually: false,\n    /**\n     * arbitrary value, byte precision not needed\n     */\n    requestErrorResponseLengthLimit: 32 * ONE_KILO_BYTE,\n    /**\n     * flush automatically, aim to be lower than ALB connection timeout\n     * to maximize connection reuse.\n     */\n    flushTimeout: 30 * ONE_SECOND,\n    /**\n     * Logs intake limit\n     */\n    maxBatchSize: 50,\n    maxMessageSize: 256 * ONE_KILO_BYTE,\n    /**\n     * beacon payload max queue size implementation is 64kb\n     * ensure that we leave room for logs, rum and potential other users\n     */\n    batchBytesLimit: 16 * ONE_KILO_BYTE,\n};\nexport function buildConfiguration(userConfiguration, buildEnv) {\n    var enableExperimentalFeatures = Array.isArray(userConfiguration.enableExperimentalFeatures)\n        ? userConfiguration.enableExperimentalFeatures\n        : [];\n    var configuration = __assign(__assign({ beforeSend: userConfiguration.beforeSend && catchUserErrors(userConfiguration.beforeSend, 'beforeSend threw an error:'), cookieOptions: buildCookieOptions(userConfiguration), isEnabled: function (feature) { return includes(enableExperimentalFeatures, feature); }, service: userConfiguration.service }, computeTransportConfiguration(userConfiguration, buildEnv)), DEFAULT_CONFIGURATION);\n    if ('allowedTracingOrigins' in userConfiguration) {\n        configuration.allowedTracingOrigins = userConfiguration.allowedTracingOrigins;\n    }\n    if ('sampleRate' in userConfiguration) {\n        configuration.sampleRate = userConfiguration.sampleRate;\n    }\n    if ('resourceSampleRate' in userConfiguration) {\n        configuration.resourceSampleRate = userConfiguration.resourceSampleRate;\n    }\n    if ('trackInteractions' in userConfiguration) {\n        configuration.trackInteractions = !!userConfiguration.trackInteractions;\n    }\n    if ('trackViewsManually' in userConfiguration) {\n        configuration.trackViewsManually = !!userConfiguration.trackViewsManually;\n    }\n    return configuration;\n}\nexport function buildCookieOptions(userConfiguration) {\n    var cookieOptions = {};\n    cookieOptions.secure = mustUseSecureCookie(userConfiguration);\n    cookieOptions.crossSite = !!userConfiguration.useCrossSiteSessionCookie;\n    if (!!userConfiguration.trackSessionAcrossSubdomains) {\n        cookieOptions.domain = getCurrentSite();\n    }\n    return cookieOptions;\n}\nfunction mustUseSecureCookie(userConfiguration) {\n    return !!userConfiguration.useSecureSessionCookie || !!userConfiguration.useCrossSiteSessionCookie;\n}\n//# sourceMappingURL=configuration.js.map","import { __assign } from \"tslib\";\nimport { areCookiesAuthorized } from '../browser/cookie';\nimport { buildConfiguration } from '../domain/configuration';\nimport { setDebugMode, startInternalMonitoring } from '../domain/internalMonitoring';\nimport { catchUserErrors } from '../tools/catchUserErrors';\nimport { display } from '../tools/display';\nexport function makePublicApi(stub) {\n    var publicApi = __assign(__assign({}, stub), { \n        // This API method is intentionally not monitored, since the only thing executed is the\n        // user-provided 'callback'.  All SDK usages executed in the callback should be monitored, and\n        // we don't want to interfere with the user uncaught exceptions.\n        onReady: function (callback) {\n            callback();\n        } });\n    // Add an \"hidden\" property to set debug mode. We define it that way to hide it\n    // as much as possible but of course it's not a real protection.\n    Object.defineProperty(publicApi, '_setDebug', {\n        get: function () {\n            return setDebugMode;\n        },\n        enumerable: false,\n    });\n    return publicApi;\n}\nexport function defineGlobal(global, name, api) {\n    var existingGlobalVariable = global[name];\n    global[name] = api;\n    if (existingGlobalVariable && existingGlobalVariable.q) {\n        existingGlobalVariable.q.forEach(function (fn) { return catchUserErrors(fn, 'onReady callback threw an error:')(); });\n    }\n}\nexport var BuildMode;\n(function (BuildMode) {\n    BuildMode[\"RELEASE\"] = \"release\";\n    BuildMode[\"STAGING\"] = \"staging\";\n    BuildMode[\"E2E_TEST\"] = \"e2e-test\";\n})(BuildMode || (BuildMode = {}));\nexport function commonInit(userConfiguration, buildEnv) {\n    var configuration = buildConfiguration(userConfiguration, buildEnv);\n    var internalMonitoring = startInternalMonitoring(configuration);\n    return {\n        configuration: configuration,\n        internalMonitoring: internalMonitoring,\n    };\n}\nexport function checkCookiesAuthorized(options) {\n    if (!areCookiesAuthorized(options)) {\n        display.warn('Cookies are not authorized, we will not send any data.');\n        return false;\n    }\n    return true;\n}\nexport function checkIsNotLocalFile() {\n    if (isLocalFile()) {\n        display.error('Execution is not allowed in the current context.');\n        return false;\n    }\n    return true;\n}\nfunction isLocalFile() {\n    return window.location.protocol === 'file:';\n}\n//# sourceMappingURL=init.js.map","var DEFAULT_LIMIT = 10000;\nvar BoundedBuffer = /** @class */ (function () {\n    function BoundedBuffer(limit) {\n        if (limit === void 0) { limit = DEFAULT_LIMIT; }\n        this.limit = limit;\n        this.buffer = [];\n    }\n    BoundedBuffer.prototype.add = function (callback) {\n        var length = this.buffer.push(callback);\n        if (length > this.limit) {\n            this.buffer.splice(0, 1);\n        }\n    };\n    BoundedBuffer.prototype.drain = function () {\n        this.buffer.forEach(function (callback) { return callback(); });\n        this.buffer.length = 0;\n    };\n    return BoundedBuffer;\n}());\nexport { BoundedBuffer };\n//# sourceMappingURL=boundedBuffer.js.map","import { isNumber, round } from './utils';\nexport function relativeToClocks(relative) {\n    return { relative: relative, timeStamp: getCorrectedTimeStamp(relative) };\n}\nfunction getCorrectedTimeStamp(relativeTime) {\n    var correctedOrigin = Date.now() - performance.now();\n    // apply correction only for positive drift\n    if (correctedOrigin > getNavigationStart()) {\n        // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n        return Math.round(correctedOrigin + relativeTime);\n    }\n    return getTimeStamp(relativeTime);\n}\nexport function currentDrift() {\n    // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n    return Math.round(Date.now() - (getNavigationStart() + performance.now()));\n}\nexport function toServerDuration(duration) {\n    if (!isNumber(duration)) {\n        return duration;\n    }\n    return round(duration * 1e6, 0);\n}\nexport function timeStampNow() {\n    return Date.now();\n}\nexport function relativeNow() {\n    return performance.now();\n}\nexport function clocksNow() {\n    return { relative: relativeNow(), timeStamp: timeStampNow() };\n}\nexport function clocksOrigin() {\n    return { relative: 0, timeStamp: getNavigationStart() };\n}\nexport function elapsed(start, end) {\n    return (end - start);\n}\n/**\n * Get the time since the navigation was started.\n *\n * Note: this does not use `performance.timeOrigin` because it doesn't seem to reflect the actual\n * time on which the navigation has started: it may be much farther in the past, at least in Firefox 71.\n * Related issue in Firefox: https://bugzilla.mozilla.org/show_bug.cgi?id=1429926\n */\nexport function getRelativeTime(timestamp) {\n    return (timestamp - getNavigationStart());\n}\nexport function getTimeStamp(relativeTime) {\n    // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n    return Math.round(getNavigationStart() + relativeTime);\n}\n/**\n * Navigation start slightly change on some rare cases\n */\nvar navigationStart;\nfunction getNavigationStart() {\n    if (navigationStart === undefined) {\n        navigationStart = performance.timing.navigationStart;\n    }\n    return navigationStart;\n}\nexport function resetNavigationStart() {\n    navigationStart = undefined;\n}\n//# sourceMappingURL=timeUtils.js.map","export var RumEventType;\n(function (RumEventType) {\n    RumEventType[\"ACTION\"] = \"action\";\n    RumEventType[\"ERROR\"] = \"error\";\n    RumEventType[\"LONG_TASK\"] = \"long_task\";\n    RumEventType[\"VIEW\"] = \"view\";\n    RumEventType[\"RESOURCE\"] = \"resource\";\n})(RumEventType || (RumEventType = {}));\nexport var ViewLoadingType;\n(function (ViewLoadingType) {\n    ViewLoadingType[\"INITIAL_LOAD\"] = \"initial_load\";\n    ViewLoadingType[\"ROUTE_CHANGE\"] = \"route_change\";\n})(ViewLoadingType || (ViewLoadingType = {}));\nexport var ActionType;\n(function (ActionType) {\n    ActionType[\"CLICK\"] = \"click\";\n    ActionType[\"CUSTOM\"] = \"custom\";\n})(ActionType || (ActionType = {}));\n//# sourceMappingURL=rawRumEvent.types.js.map","export var buildEnv = {\n    buildMode: 'release',\n    datacenter: 'us',\n    sdkVersion: '2.15.1',\n};\n//# sourceMappingURL=buildEnv.js.map","export var LifeCycleEventType;\n(function (LifeCycleEventType) {\n    LifeCycleEventType[LifeCycleEventType[\"PERFORMANCE_ENTRY_COLLECTED\"] = 0] = \"PERFORMANCE_ENTRY_COLLECTED\";\n    LifeCycleEventType[LifeCycleEventType[\"AUTO_ACTION_CREATED\"] = 1] = \"AUTO_ACTION_CREATED\";\n    LifeCycleEventType[LifeCycleEventType[\"AUTO_ACTION_COMPLETED\"] = 2] = \"AUTO_ACTION_COMPLETED\";\n    LifeCycleEventType[LifeCycleEventType[\"AUTO_ACTION_DISCARDED\"] = 3] = \"AUTO_ACTION_DISCARDED\";\n    LifeCycleEventType[LifeCycleEventType[\"VIEW_CREATED\"] = 4] = \"VIEW_CREATED\";\n    LifeCycleEventType[LifeCycleEventType[\"VIEW_UPDATED\"] = 5] = \"VIEW_UPDATED\";\n    LifeCycleEventType[LifeCycleEventType[\"VIEW_ENDED\"] = 6] = \"VIEW_ENDED\";\n    LifeCycleEventType[LifeCycleEventType[\"REQUEST_STARTED\"] = 7] = \"REQUEST_STARTED\";\n    LifeCycleEventType[LifeCycleEventType[\"REQUEST_COMPLETED\"] = 8] = \"REQUEST_COMPLETED\";\n    LifeCycleEventType[LifeCycleEventType[\"SESSION_RENEWED\"] = 9] = \"SESSION_RENEWED\";\n    LifeCycleEventType[LifeCycleEventType[\"BEFORE_UNLOAD\"] = 10] = \"BEFORE_UNLOAD\";\n    LifeCycleEventType[LifeCycleEventType[\"RAW_RUM_EVENT_COLLECTED\"] = 11] = \"RAW_RUM_EVENT_COLLECTED\";\n    LifeCycleEventType[LifeCycleEventType[\"RUM_EVENT_COLLECTED\"] = 12] = \"RUM_EVENT_COLLECTED\";\n    LifeCycleEventType[LifeCycleEventType[\"RECORD_STARTED\"] = 13] = \"RECORD_STARTED\";\n    LifeCycleEventType[LifeCycleEventType[\"RECORD_STOPPED\"] = 14] = \"RECORD_STOPPED\";\n    LifeCycleEventType[LifeCycleEventType[\"RAW_ERROR_COLLECTED\"] = 15] = \"RAW_ERROR_COLLECTED\";\n})(LifeCycleEventType || (LifeCycleEventType = {}));\nvar LifeCycle = /** @class */ (function () {\n    function LifeCycle() {\n        this.callbacks = {};\n    }\n    LifeCycle.prototype.notify = function (eventType, data) {\n        var eventCallbacks = this.callbacks[eventType];\n        if (eventCallbacks) {\n            eventCallbacks.forEach(function (callback) { return callback(data); });\n        }\n    };\n    LifeCycle.prototype.subscribe = function (eventType, callback) {\n        var _this = this;\n        if (!this.callbacks[eventType]) {\n            this.callbacks[eventType] = [];\n        }\n        this.callbacks[eventType].push(callback);\n        return {\n            unsubscribe: function () {\n                _this.callbacks[eventType] = _this.callbacks[eventType].filter(function (other) { return callback !== other; });\n            },\n        };\n    };\n    return LifeCycle;\n}());\nexport { LifeCycle };\n//# sourceMappingURL=lifeCycle.js.map","import { getLinkElementOrigin, getLocationOrigin } from './utils';\nexport function normalizeUrl(url) {\n    return buildUrl(url, getLocationOrigin()).href;\n}\nexport function isValidUrl(url) {\n    try {\n        return !!buildUrl(url);\n    }\n    catch (_a) {\n        return false;\n    }\n}\nexport function haveSameOrigin(url1, url2) {\n    return getOrigin(url1) === getOrigin(url2);\n}\nexport function getOrigin(url) {\n    return getLinkElementOrigin(buildUrl(url));\n}\nexport function getPathName(url) {\n    var pathname = buildUrl(url).pathname;\n    return pathname[0] === '/' ? pathname : \"/\" + pathname;\n}\nexport function getSearch(url) {\n    return buildUrl(url).search;\n}\nexport function getHash(url) {\n    return buildUrl(url).hash;\n}\nexport function buildUrl(url, base) {\n    if (checkURLSupported()) {\n        return base !== undefined ? new URL(url, base) : new URL(url);\n    }\n    if (base === undefined && !/:/.test(url)) {\n        throw new Error(\"Invalid URL: '\" + url + \"'\");\n    }\n    var doc = document;\n    var anchorElement = doc.createElement('a');\n    if (base !== undefined) {\n        doc = document.implementation.createHTMLDocument('');\n        var baseElement = doc.createElement('base');\n        baseElement.href = base;\n        doc.head.appendChild(baseElement);\n        doc.body.appendChild(anchorElement);\n    }\n    anchorElement.href = url;\n    return anchorElement;\n}\nvar isURLSupported;\nfunction checkURLSupported() {\n    if (isURLSupported !== undefined) {\n        return isURLSupported;\n    }\n    try {\n        var url = new URL('http://test/path');\n        isURLSupported = url.href === 'http://test/path';\n        return isURLSupported;\n    }\n    catch (_a) {\n        isURLSupported = false;\n    }\n    return isURLSupported;\n}\n//# sourceMappingURL=urlPolyfill.js.map","import { __assign } from \"tslib\";\nimport { addMonitoringMessage, elapsed, getPathName, includes, isValidUrl, ResourceType, toServerDuration, ONE_DAY, relativeNow, timeStampNow, } from '@datadog/browser-core';\nexport var FAKE_INITIAL_DOCUMENT = 'initial_document';\nvar RESOURCE_TYPES = [\n    [ResourceType.DOCUMENT, function (initiatorType) { return FAKE_INITIAL_DOCUMENT === initiatorType; }],\n    [ResourceType.XHR, function (initiatorType) { return 'xmlhttprequest' === initiatorType; }],\n    [ResourceType.FETCH, function (initiatorType) { return 'fetch' === initiatorType; }],\n    [ResourceType.BEACON, function (initiatorType) { return 'beacon' === initiatorType; }],\n    [ResourceType.CSS, function (_, path) { return /\\.css$/i.test(path); }],\n    [ResourceType.JS, function (_, path) { return /\\.js$/i.test(path); }],\n    [\n        ResourceType.IMAGE,\n        function (initiatorType, path) {\n            return includes(['image', 'img', 'icon'], initiatorType) || /\\.(gif|jpg|jpeg|tiff|png|svg|ico)$/i.exec(path) !== null;\n        },\n    ],\n    [ResourceType.FONT, function (_, path) { return /\\.(woff|eot|woff2|ttf)$/i.exec(path) !== null; }],\n    [\n        ResourceType.MEDIA,\n        function (initiatorType, path) {\n            return includes(['audio', 'video'], initiatorType) || /\\.(mp3|mp4)$/i.exec(path) !== null;\n        },\n    ],\n];\nexport function computeResourceKind(timing) {\n    var url = timing.name;\n    if (!isValidUrl(url)) {\n        addMonitoringMessage(\"Failed to construct URL for \\\"\" + timing.name + \"\\\"\");\n        return ResourceType.OTHER;\n    }\n    var path = getPathName(url);\n    for (var _i = 0, RESOURCE_TYPES_1 = RESOURCE_TYPES; _i < RESOURCE_TYPES_1.length; _i++) {\n        var _a = RESOURCE_TYPES_1[_i], type = _a[0], isType = _a[1];\n        if (isType(timing.initiatorType, path)) {\n            return type;\n        }\n    }\n    return ResourceType.OTHER;\n}\nfunction areInOrder() {\n    var numbers = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        numbers[_i] = arguments[_i];\n    }\n    for (var i = 1; i < numbers.length; i += 1) {\n        if (numbers[i - 1] > numbers[i]) {\n            return false;\n        }\n    }\n    return true;\n}\nexport function isRequestKind(timing) {\n    return timing.initiatorType === 'xmlhttprequest' || timing.initiatorType === 'fetch';\n}\nexport function computePerformanceResourceDuration(entry) {\n    var duration = entry.duration, startTime = entry.startTime, responseEnd = entry.responseEnd;\n    // Safari duration is always 0 on timings blocked by cross origin policies.\n    if (duration === 0 && startTime < responseEnd) {\n        return toServerDuration(elapsed(startTime, responseEnd));\n    }\n    if (duration > ONE_DAY) {\n        addMonitoringMessage('resource duration > 1 day', {\n            debug: {\n                type: entry.initiatorType,\n                name: entry.name,\n                startTime: Math.round(startTime),\n                responseEnd: Math.round(responseEnd),\n                duration: Math.round(duration),\n                relativeNow: Math.round(relativeNow()),\n                timeStampNow: timeStampNow(),\n            },\n        });\n    }\n    return toServerDuration(duration);\n}\nexport function computePerformanceResourceDetails(entry) {\n    var validEntry = toValidEntry(entry);\n    if (!validEntry) {\n        return undefined;\n    }\n    var startTime = validEntry.startTime, fetchStart = validEntry.fetchStart, redirectStart = validEntry.redirectStart, redirectEnd = validEntry.redirectEnd, domainLookupStart = validEntry.domainLookupStart, domainLookupEnd = validEntry.domainLookupEnd, connectStart = validEntry.connectStart, secureConnectionStart = validEntry.secureConnectionStart, connectEnd = validEntry.connectEnd, requestStart = validEntry.requestStart, responseStart = validEntry.responseStart, responseEnd = validEntry.responseEnd;\n    var details = {\n        download: formatTiming(startTime, responseStart, responseEnd),\n        first_byte: formatTiming(startTime, requestStart, responseStart),\n    };\n    // Make sure a connection occurred\n    if (connectEnd !== fetchStart) {\n        details.connect = formatTiming(startTime, connectStart, connectEnd);\n        // Make sure a secure connection occurred\n        if (areInOrder(connectStart, secureConnectionStart, connectEnd)) {\n            details.ssl = formatTiming(startTime, secureConnectionStart, connectEnd);\n        }\n    }\n    // Make sure a domain lookup occurred\n    if (domainLookupEnd !== fetchStart) {\n        details.dns = formatTiming(startTime, domainLookupStart, domainLookupEnd);\n    }\n    if (hasRedirection(entry)) {\n        details.redirect = formatTiming(startTime, redirectStart, redirectEnd);\n    }\n    return details;\n}\nexport function toValidEntry(entry) {\n    // Ensure timings are in the right order. On top of filtering out potential invalid\n    // RumPerformanceResourceTiming, it will ignore entries from requests where timings cannot be\n    // collected, for example cross origin requests without a \"Timing-Allow-Origin\" header allowing\n    // it.\n    if (!areInOrder(entry.startTime, entry.fetchStart, entry.domainLookupStart, entry.domainLookupEnd, entry.connectStart, entry.connectEnd, entry.requestStart, entry.responseStart, entry.responseEnd)) {\n        return undefined;\n    }\n    if (!hasRedirection(entry)) {\n        return entry;\n    }\n    var redirectStart = entry.redirectStart, redirectEnd = entry.redirectEnd;\n    // Firefox doesn't provide redirect timings on cross origin requests.\n    // Provide a default for those.\n    if (redirectStart < entry.startTime) {\n        redirectStart = entry.startTime;\n    }\n    if (redirectEnd < entry.startTime) {\n        redirectEnd = entry.fetchStart;\n    }\n    // Make sure redirect timings are in order\n    if (!areInOrder(entry.startTime, redirectStart, redirectEnd, entry.fetchStart)) {\n        return undefined;\n    }\n    return __assign(__assign({}, entry), { redirectEnd: redirectEnd,\n        redirectStart: redirectStart });\n}\nfunction hasRedirection(entry) {\n    // The only time fetchStart is different than startTime is if a redirection occurred.\n    return entry.fetchStart !== entry.startTime;\n}\nfunction formatTiming(origin, start, end) {\n    return {\n        duration: toServerDuration(elapsed(start, end)),\n        start: toServerDuration(elapsed(origin, start)),\n    };\n}\nexport function computeSize(entry) {\n    // Make sure a request actually occurred\n    if (entry.startTime < entry.responseStart) {\n        return entry.decodedBodySize;\n    }\n    return undefined;\n}\nexport function isAllowedRequestUrl(configuration, url) {\n    return url && !configuration.isIntakeUrl(url);\n}\n//# sourceMappingURL=resourceUtils.js.map","import { __spreadArrays } from \"tslib\";\nimport { combine, createErrorFilter, isEmptyObject, limitModification, timeStampNow, currentDrift, display, addMonitoringMessage, relativeNow, } from '@datadog/browser-core';\nimport { RumEventType, } from '../rawRumEvent.types';\nimport { LifeCycleEventType } from './lifeCycle';\nvar SessionType;\n(function (SessionType) {\n    SessionType[\"SYNTHETICS\"] = \"synthetics\";\n    SessionType[\"USER\"] = \"user\";\n})(SessionType || (SessionType = {}));\nvar VIEW_EVENTS_MODIFIABLE_FIELD_PATHS = [\n    // Fields with sensitive data\n    'view.url',\n    'view.referrer',\n    'action.target.name',\n    'error.message',\n    'error.stack',\n    'error.resource.url',\n    'resource.url',\n];\nvar OTHER_EVENTS_MODIFIABLE_FIELD_PATHS = __spreadArrays(VIEW_EVENTS_MODIFIABLE_FIELD_PATHS, [\n    // User-customizable field\n    'context',\n]);\nexport function startRumAssembly(applicationId, configuration, lifeCycle, session, parentContexts, getCommonContext) {\n    var errorFilter = createErrorFilter(configuration, function (error) {\n        lifeCycle.notify(LifeCycleEventType.RAW_ERROR_COLLECTED, { error: error });\n    });\n    lifeCycle.subscribe(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, function (_a) {\n        var startTime = _a.startTime, rawRumEvent = _a.rawRumEvent, domainContext = _a.domainContext, savedCommonContext = _a.savedCommonContext, customerContext = _a.customerContext;\n        var viewContext = parentContexts.findView(startTime);\n        if (session.isTracked() && viewContext && viewContext.session.id === session.getId()) {\n            var actionContext = parentContexts.findAction(startTime);\n            var commonContext = savedCommonContext || getCommonContext();\n            var rumContext = {\n                _dd: {\n                    format_version: 2,\n                    drift: currentDrift(),\n                },\n                application: {\n                    id: applicationId,\n                },\n                date: timeStampNow(),\n                service: configuration.service,\n                session: {\n                    // must be computed on each event because synthetics instrumentation can be done after sdk execution\n                    // cf https://github.com/puppeteer/puppeteer/issues/3667\n                    type: getSessionType(),\n                },\n            };\n            var serverRumEvent = (needToAssembleWithAction(rawRumEvent)\n                ? combine(rumContext, viewContext, actionContext, rawRumEvent)\n                : combine(rumContext, viewContext, rawRumEvent));\n            serverRumEvent.context = combine(commonContext.context, customerContext);\n            if (!('has_replay' in serverRumEvent.session)) {\n                ;\n                serverRumEvent.session.has_replay = commonContext.hasReplay;\n            }\n            if (!isEmptyObject(commonContext.user)) {\n                ;\n                serverRumEvent.usr = commonContext.user;\n            }\n            if (shouldSend(serverRumEvent, configuration.beforeSend, domainContext, errorFilter)) {\n                if (isEmptyObject(serverRumEvent.context)) {\n                    delete serverRumEvent.context;\n                }\n                if (typeof serverRumEvent.date !== 'number') {\n                    addMonitoringMessage('invalid date', {\n                        debug: {\n                            eventType: serverRumEvent.type,\n                            eventTimeStamp: serverRumEvent.date,\n                            eventRelativeTime: Math.round(startTime),\n                            timeStampNow: timeStampNow(),\n                            relativeNow: Math.round(relativeNow()),\n                            drift: currentDrift(),\n                        },\n                    });\n                }\n                lifeCycle.notify(LifeCycleEventType.RUM_EVENT_COLLECTED, serverRumEvent);\n            }\n        }\n    });\n}\nfunction shouldSend(event, beforeSend, domainContext, errorFilter) {\n    if (beforeSend) {\n        var result = limitModification(event, event.type === RumEventType.VIEW ? VIEW_EVENTS_MODIFIABLE_FIELD_PATHS : OTHER_EVENTS_MODIFIABLE_FIELD_PATHS, function (event) { return beforeSend(event, domainContext); });\n        if (result === false && event.type !== RumEventType.VIEW) {\n            return false;\n        }\n        if (result === false) {\n            display.warn(\"Can't dismiss view events using beforeSend!\");\n        }\n    }\n    if (event.type === RumEventType.ERROR) {\n        return !errorFilter.isLimitReached();\n    }\n    return true;\n}\nfunction needToAssembleWithAction(event) {\n    return [RumEventType.ERROR, RumEventType.RESOURCE, RumEventType.LONG_TASK].indexOf(event.type) !== -1;\n}\nfunction getSessionType() {\n    return window._DATADOG_SYNTHETICS_BROWSER === undefined ? SessionType.USER : SessionType.SYNTHETICS;\n}\n//# sourceMappingURL=assembly.js.map","import { findCommaSeparatedValue, ONE_MINUTE } from '@datadog/browser-core';\nexport var INITIAL_DOCUMENT_OUTDATED_TRACE_ID_THRESHOLD = 2 * ONE_MINUTE;\nexport function getDocumentTraceId(document) {\n    var data = getDocumentTraceDataFromMeta(document) || getDocumentTraceDataFromComment(document);\n    if (!data || data.traceTime <= Date.now() - INITIAL_DOCUMENT_OUTDATED_TRACE_ID_THRESHOLD) {\n        return undefined;\n    }\n    return data.traceId;\n}\nexport function getDocumentTraceDataFromMeta(document) {\n    var traceIdMeta = document.querySelector('meta[name=dd-trace-id]');\n    var traceTimeMeta = document.querySelector('meta[name=dd-trace-time]');\n    return createDocumentTraceData(traceIdMeta && traceIdMeta.content, traceTimeMeta && traceTimeMeta.content);\n}\nexport function getDocumentTraceDataFromComment(document) {\n    var comment = findTraceComment(document);\n    if (!comment) {\n        return undefined;\n    }\n    return createDocumentTraceData(findCommaSeparatedValue(comment, 'trace-id'), findCommaSeparatedValue(comment, 'trace-time'));\n}\nexport function createDocumentTraceData(traceId, rawTraceTime) {\n    var traceTime = rawTraceTime && Number(rawTraceTime);\n    if (!traceId || !traceTime) {\n        return undefined;\n    }\n    return {\n        traceId: traceId,\n        traceTime: traceTime,\n    };\n}\nexport function findTraceComment(document) {\n    // 1. Try to find the comment as a direct child of the document\n    // Note: TSLint advises to use a 'for of', but TS doesn't allow to use 'for of' if the iterated\n    // value is not an array or string (here, a NodeList).\n    // eslint-disable-next-line @typescript-eslint/prefer-for-of\n    for (var i = 0; i < document.childNodes.length; i += 1) {\n        var comment = getTraceCommentFromNode(document.childNodes[i]);\n        if (comment) {\n            return comment;\n        }\n    }\n    // 2. If the comment is placed after the </html> tag, but have some space or new lines before or\n    // after, the DOM parser will lift it (and the surrounding text) at the end of the <body> tag.\n    // Try to look for the comment at the end of the <body> by by iterating over its child nodes in\n    // reverse order, stopping if we come across a non-text node.\n    if (document.body) {\n        for (var i = document.body.childNodes.length - 1; i >= 0; i -= 1) {\n            var node = document.body.childNodes[i];\n            var comment = getTraceCommentFromNode(node);\n            if (comment) {\n                return comment;\n            }\n            if (!isTextNode(node)) {\n                break;\n            }\n        }\n    }\n}\nfunction getTraceCommentFromNode(node) {\n    if (node && isCommentNode(node)) {\n        var match = /^\\s*DATADOG;(.*?)\\s*$/.exec(node.data);\n        if (match) {\n            return match[1];\n        }\n    }\n}\nfunction isCommentNode(node) {\n    return node.nodeName === '#comment';\n}\nfunction isTextNode(node) {\n    return node.nodeName === '#text';\n}\n//# sourceMappingURL=getDocumentTraceId.js.map","import { __assign } from \"tslib\";\nimport { addEventListeners, getRelativeTime, isNumber, monitor, relativeNow, runOnReadyState, } from '@datadog/browser-core';\nimport { LifeCycleEventType } from '../domain/lifeCycle';\nimport { FAKE_INITIAL_DOCUMENT, isAllowedRequestUrl } from '../domain/rumEventsCollection/resource/resourceUtils';\nimport { getDocumentTraceId } from '../domain/tracing/getDocumentTraceId';\nfunction supportPerformanceObject() {\n    return window.performance !== undefined && 'getEntries' in performance;\n}\nexport function supportPerformanceTimingEvent(entryType) {\n    return (window.PerformanceObserver &&\n        PerformanceObserver.supportedEntryTypes !== undefined &&\n        PerformanceObserver.supportedEntryTypes.includes(entryType));\n}\nexport function supportPerformanceEntry() {\n    // Safari 10 doesn't support PerformanceEntry\n    return typeof PerformanceEntry === 'function';\n}\nexport function startPerformanceCollection(lifeCycle, configuration) {\n    retrieveInitialDocumentResourceTiming(function (timing) {\n        handleRumPerformanceEntry(lifeCycle, configuration, timing);\n    });\n    if (supportPerformanceObject()) {\n        handlePerformanceEntries(lifeCycle, configuration, performance.getEntries());\n    }\n    if (window.PerformanceObserver) {\n        var observer = new PerformanceObserver(monitor(function (entries) {\n            return handlePerformanceEntries(lifeCycle, configuration, entries.getEntries());\n        }));\n        var entryTypes = [\n            'resource',\n            'navigation',\n            'longtask',\n            'paint',\n            'largest-contentful-paint',\n            'first-input',\n            'layout-shift',\n        ];\n        observer.observe({ entryTypes: entryTypes });\n        if (supportPerformanceObject() && 'addEventListener' in performance) {\n            // https://bugzilla.mozilla.org/show_bug.cgi?id=1559377\n            performance.addEventListener('resourcetimingbufferfull', function () {\n                performance.clearResourceTimings();\n            });\n        }\n    }\n    if (!supportPerformanceTimingEvent('navigation')) {\n        retrieveNavigationTiming(function (timing) {\n            handleRumPerformanceEntry(lifeCycle, configuration, timing);\n        });\n    }\n    if (!supportPerformanceTimingEvent('first-input')) {\n        retrieveFirstInputTiming(function (timing) {\n            handleRumPerformanceEntry(lifeCycle, configuration, timing);\n        });\n    }\n}\nexport function retrieveInitialDocumentResourceTiming(callback) {\n    runOnReadyState('interactive', function () {\n        var timing;\n        var forcedAttributes = {\n            entryType: 'resource',\n            initiatorType: FAKE_INITIAL_DOCUMENT,\n            traceId: getDocumentTraceId(document),\n        };\n        if (supportPerformanceTimingEvent('navigation') && performance.getEntriesByType('navigation').length > 0) {\n            var navigationEntry = performance.getEntriesByType('navigation')[0];\n            timing = __assign(__assign({}, navigationEntry.toJSON()), forcedAttributes);\n        }\n        else {\n            var relativePerformanceTiming = computeRelativePerformanceTiming();\n            timing = __assign(__assign(__assign({}, relativePerformanceTiming), { decodedBodySize: 0, duration: relativePerformanceTiming.responseEnd, name: window.location.href, startTime: 0 }), forcedAttributes);\n        }\n        callback(timing);\n    });\n}\nfunction retrieveNavigationTiming(callback) {\n    function sendFakeTiming() {\n        callback(__assign(__assign({}, computeRelativePerformanceTiming()), { entryType: 'navigation' }));\n    }\n    runOnReadyState('complete', function () {\n        // Send it a bit after the actual load event, so the \"loadEventEnd\" timing is accurate\n        setTimeout(monitor(sendFakeTiming));\n    });\n}\n/**\n * first-input timing entry polyfill based on\n * https://github.com/GoogleChrome/web-vitals/blob/master/src/lib/polyfills/firstInputPolyfill.ts\n */\nfunction retrieveFirstInputTiming(callback) {\n    var startTimeStamp = Date.now();\n    var timingSent = false;\n    var removeEventListeners = addEventListeners(window, [\"click\" /* CLICK */, \"mousedown\" /* MOUSE_DOWN */, \"keydown\" /* KEY_DOWN */, \"touchstart\" /* TOUCH_START */, \"pointerdown\" /* POINTER_DOWN */], function (evt) {\n        // Only count cancelable events, which should trigger behavior important to the user.\n        if (!evt.cancelable) {\n            return;\n        }\n        // This timing will be used to compute the \"first Input delay\", which is the delta between\n        // when the system received the event (e.g. evt.timeStamp) and when it could run the callback\n        // (e.g. performance.now()).\n        var timing = {\n            entryType: 'first-input',\n            processingStart: relativeNow(),\n            startTime: evt.timeStamp,\n        };\n        if (evt.type === \"pointerdown\" /* POINTER_DOWN */) {\n            sendTimingIfPointerIsNotCancelled(timing);\n        }\n        else {\n            sendTiming(timing);\n        }\n    }, { passive: true, capture: true }).stop;\n    /**\n     * Pointer events are a special case, because they can trigger main or compositor thread behavior.\n     * We differentiate these cases based on whether or not we see a pointercancel event, which are\n     * fired when we scroll. If we're scrolling we don't need to report input delay since FID excludes\n     * scrolling and pinch/zooming.\n     */\n    function sendTimingIfPointerIsNotCancelled(timing) {\n        addEventListeners(window, [\"pointerup\" /* POINTER_UP */, \"pointercancel\" /* POINTER_CANCEL */], function (event) {\n            if (event.type === \"pointerup\" /* POINTER_UP */) {\n                sendTiming(timing);\n            }\n        }, { once: true });\n    }\n    function sendTiming(timing) {\n        if (!timingSent) {\n            timingSent = true;\n            removeEventListeners();\n            // In some cases the recorded delay is clearly wrong, e.g. it's negative or it's larger than\n            // the time between now and when the page was loaded.\n            // - https://github.com/GoogleChromeLabs/first-input-delay/issues/4\n            // - https://github.com/GoogleChromeLabs/first-input-delay/issues/6\n            // - https://github.com/GoogleChromeLabs/first-input-delay/issues/7\n            var delay = timing.processingStart - timing.startTime;\n            if (delay >= 0 && delay < Date.now() - startTimeStamp) {\n                callback(timing);\n            }\n        }\n    }\n}\nfunction computeRelativePerformanceTiming() {\n    var result = {};\n    var timing = performance.timing;\n    for (var key in timing) {\n        if (isNumber(timing[key])) {\n            var numberKey = key;\n            // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n            var timingElement = timing[numberKey];\n            result[numberKey] = timingElement === 0 ? 0 : getRelativeTime(timingElement);\n        }\n    }\n    return result;\n}\nfunction handlePerformanceEntries(lifeCycle, configuration, entries) {\n    entries.forEach(function (entry) {\n        if (entry.entryType === 'resource' ||\n            entry.entryType === 'navigation' ||\n            entry.entryType === 'paint' ||\n            entry.entryType === 'longtask' ||\n            entry.entryType === 'largest-contentful-paint' ||\n            entry.entryType === 'first-input' ||\n            entry.entryType === 'layout-shift') {\n            handleRumPerformanceEntry(lifeCycle, configuration, entry);\n        }\n    });\n}\nfunction handleRumPerformanceEntry(lifeCycle, configuration, entry) {\n    if (isIncompleteNavigation(entry) || isForbiddenResource(configuration, entry)) {\n        return;\n    }\n    lifeCycle.notify(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, entry);\n}\nfunction isIncompleteNavigation(entry) {\n    return entry.entryType === 'navigation' && entry.loadEventEnd <= 0;\n}\nfunction isForbiddenResource(configuration, entry) {\n    return entry.entryType === 'resource' && !isAllowedRequestUrl(configuration, entry.name);\n}\n//# sourceMappingURL=performanceCollection.js.map","import { deepClone } from './context';\n/**\n * Current limitation:\n * - field path do not support array, 'a.b.c' only\n */\nexport function limitModification(object, modifiableFieldPaths, modifier) {\n    var clone = deepClone(object);\n    var result = modifier(clone);\n    modifiableFieldPaths.forEach(function (path) {\n        var originalValue = get(object, path);\n        var newValue = get(clone, path);\n        var originalType = getType(originalValue);\n        var newType = getType(newValue);\n        if (newType === originalType) {\n            set(object, path, newValue);\n        }\n        else if (originalType === 'object' && (newType === 'undefined' || newType === 'null')) {\n            set(object, path, {});\n        }\n    });\n    return result;\n}\nfunction get(object, path) {\n    var current = object;\n    for (var _i = 0, _a = path.split('.'); _i < _a.length; _i++) {\n        var field = _a[_i];\n        if (!isValidObjectContaining(current, field)) {\n            return;\n        }\n        current = current[field];\n    }\n    return current;\n}\nfunction set(object, path, value) {\n    var current = object;\n    var fields = path.split('.');\n    for (var i = 0; i < fields.length; i += 1) {\n        var field = fields[i];\n        if (!isValidObjectContaining(current, field)) {\n            return;\n        }\n        if (i !== fields.length - 1) {\n            current = current[field];\n        }\n        else {\n            current[field] = value;\n        }\n    }\n}\nfunction isValidObjectContaining(object, field) {\n    return typeof object === 'object' && object !== null && field in object;\n}\n/**\n * Similar to `typeof`, but distinguish plain objects from `null` and arrays\n */\nfunction getType(value) {\n    if (value === null) {\n        return 'null';\n    }\n    if (Array.isArray(value)) {\n        return 'array';\n    }\n    return typeof value;\n}\n//# sourceMappingURL=limitModification.js.map","import { ErrorSource } from './error';\nimport { clocksNow } from './timeUtils';\nimport { ONE_MINUTE } from './utils';\nexport function createErrorFilter(configuration, onLimitReached) {\n    var errorCount = 0;\n    var allowNextError = false;\n    return {\n        isLimitReached: function () {\n            if (errorCount === 0) {\n                setTimeout(function () {\n                    errorCount = 0;\n                }, ONE_MINUTE);\n            }\n            errorCount += 1;\n            if (errorCount <= configuration.maxErrorsByMinute || allowNextError) {\n                allowNextError = false;\n                return false;\n            }\n            if (errorCount === configuration.maxErrorsByMinute + 1) {\n                allowNextError = true;\n                try {\n                    onLimitReached({\n                        message: \"Reached max number of errors by minute: \" + configuration.maxErrorsByMinute,\n                        source: ErrorSource.AGENT,\n                        startClocks: clocksNow(),\n                    });\n                }\n                finally {\n                    allowNextError = false;\n                }\n            }\n            return true;\n        },\n    };\n}\n//# sourceMappingURL=errorFilter.js.map","import { noop, addEventListener, elapsed, relativeNow, addMonitoringMessage, toServerDuration, } from '@datadog/browser-core';\n// Arbitrary value to cap number of element (mostly for backend)\nexport var MAX_NUMBER_OF_FOCUSED_TIME = 500;\nvar foregroundPeriods = [];\nexport function startForegroundContexts(configuration) {\n    if (!configuration.isEnabled('track-foreground')) {\n        return {\n            getInForeground: function () { return undefined; },\n            getInForegroundPeriods: function () { return undefined; },\n            stop: noop,\n        };\n    }\n    if (document.hasFocus()) {\n        addNewForegroundPeriod();\n    }\n    var stopForegroundTracking = trackFocus(addNewForegroundPeriod).stop;\n    var stopBlurTracking = trackBlur(closeForegroundPeriod).stop;\n    return {\n        getInForeground: getInForeground,\n        getInForegroundPeriods: getInForegroundPeriods,\n        stop: function () {\n            foregroundPeriods = [];\n            stopForegroundTracking();\n            stopBlurTracking();\n        },\n    };\n}\nfunction addNewForegroundPeriod() {\n    if (foregroundPeriods.length > MAX_NUMBER_OF_FOCUSED_TIME) {\n        addMonitoringMessage('Reached maximum of foreground time');\n        return;\n    }\n    var currentForegroundPeriod = foregroundPeriods[foregroundPeriods.length - 1];\n    if (currentForegroundPeriod !== undefined && currentForegroundPeriod.end === undefined) {\n        addMonitoringMessage('Previous foreground periods not closed. Continuing current one', {\n            inForegroundPeriodsCount: foregroundPeriods.length,\n            currentForegroundPeriodStart: currentForegroundPeriod.start,\n        });\n        return;\n    }\n    foregroundPeriods.push({\n        start: relativeNow(),\n    });\n}\nfunction closeForegroundPeriod() {\n    if (foregroundPeriods.length === 0) {\n        addMonitoringMessage('No foreground period');\n        return;\n    }\n    var currentForegroundPeriod = foregroundPeriods[foregroundPeriods.length - 1];\n    if (currentForegroundPeriod.end !== undefined) {\n        addMonitoringMessage('Current foreground period already closed', {\n            inForegroundPeriodsCount: foregroundPeriods.length,\n            currentForegroundPeriodStart: currentForegroundPeriod.start,\n            currentForegroundPeriodEnd: currentForegroundPeriod.end,\n        });\n        return;\n    }\n    currentForegroundPeriod.end = relativeNow();\n}\nfunction trackFocus(onFocusChange) {\n    return addEventListener(window, \"focus\" /* FOCUS */, function () { return onFocusChange(); });\n}\nfunction trackBlur(onBlurChange) {\n    return addEventListener(window, \"blur\" /* BLUR */, function () { return onBlurChange(); });\n}\nfunction getInForeground(startTime) {\n    for (var i = foregroundPeriods.length - 1; i >= 0; i--) {\n        var foregroundPeriod = foregroundPeriods[i];\n        if (foregroundPeriod.end !== undefined && startTime > foregroundPeriod.end) {\n            break;\n        }\n        if (startTime > foregroundPeriod.start &&\n            (foregroundPeriod.end === undefined || startTime < foregroundPeriod.end)) {\n            return true;\n        }\n    }\n    return false;\n}\nfunction getInForegroundPeriods(eventStartTime, duration) {\n    // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n    var eventEndTime = (eventStartTime + duration);\n    var filteredForegroundPeriods = [];\n    for (var i = foregroundPeriods.length - 1; i >= 0; i--) {\n        var foregroundPeriod = foregroundPeriods[i];\n        if (foregroundPeriod.end !== undefined && eventStartTime > foregroundPeriod.end) {\n            // event starts after the end of the current focus period\n            // since the array is sorted, we can stop looking for foreground periods\n            break;\n        }\n        if (eventEndTime < foregroundPeriod.start) {\n            // event ends before the start of the current focus period\n            // continue to previous one\n            continue;\n        }\n        var startTime = eventStartTime > foregroundPeriod.start ? eventStartTime : foregroundPeriod.start;\n        var startDuration = elapsed(eventStartTime, startTime);\n        var endTime = foregroundPeriod.end === undefined || eventEndTime < foregroundPeriod.end ? eventEndTime : foregroundPeriod.end;\n        var endDuration = elapsed(startTime, endTime);\n        filteredForegroundPeriods.unshift({\n            start: toServerDuration(startDuration),\n            duration: toServerDuration(endDuration),\n        });\n    }\n    return filteredForegroundPeriods;\n}\n//# sourceMappingURL=foregroundContexts.js.map","var Observable = /** @class */ (function () {\n    function Observable() {\n        this.observers = [];\n    }\n    Observable.prototype.subscribe = function (f) {\n        var _this = this;\n        this.observers.push(f);\n        return {\n            unsubscribe: function () {\n                _this.observers = _this.observers.filter(function (other) { return f !== other; });\n            },\n        };\n    };\n    Observable.prototype.notify = function (data) {\n        this.observers.forEach(function (observer) { return observer(data); });\n    };\n    return Observable;\n}());\nexport { Observable };\n//# sourceMappingURL=observable.js.map","import { cacheCookieAccess, COOKIE_ACCESS_DELAY } from '../browser/cookie';\nimport { Observable } from '../tools/observable';\nimport * as utils from '../tools/utils';\nimport { monitor } from './internalMonitoring';\nimport { tryOldCookiesMigration } from './oldCookiesMigration';\nexport var SESSION_COOKIE_NAME = '_dd_s';\nexport var SESSION_EXPIRATION_DELAY = 15 * utils.ONE_MINUTE;\nexport var SESSION_TIME_OUT_DELAY = 4 * utils.ONE_HOUR;\nexport var VISIBILITY_CHECK_DELAY = utils.ONE_MINUTE;\n/**\n * Limit access to cookie to avoid performance issues\n */\nexport function startSessionManagement(options, productKey, computeSessionState) {\n    var sessionCookie = cacheCookieAccess(SESSION_COOKIE_NAME, options);\n    tryOldCookiesMigration(sessionCookie);\n    var renewObservable = new Observable();\n    var currentSessionId = retrieveActiveSession(sessionCookie).id;\n    var expandOrRenewSession = utils.throttle(monitor(function () {\n        var session = retrieveActiveSession(sessionCookie);\n        var _a = computeSessionState(session[productKey]), trackingType = _a.trackingType, isTracked = _a.isTracked;\n        session[productKey] = trackingType;\n        if (isTracked && !session.id) {\n            session.id = utils.generateUUID();\n            session.created = String(Date.now());\n        }\n        // save changes and expand session duration\n        persistSession(session, sessionCookie);\n        // If the session id has changed, notify that the session has been renewed\n        if (isTracked && currentSessionId !== session.id) {\n            currentSessionId = session.id;\n            renewObservable.notify();\n        }\n    }), COOKIE_ACCESS_DELAY).throttled;\n    var expandSession = function () {\n        var session = retrieveActiveSession(sessionCookie);\n        persistSession(session, sessionCookie);\n    };\n    expandOrRenewSession();\n    trackActivity(expandOrRenewSession);\n    trackVisibility(expandSession);\n    return {\n        getId: function () { return retrieveActiveSession(sessionCookie).id; },\n        getTrackingType: function () { return retrieveActiveSession(sessionCookie)[productKey]; },\n        renewObservable: renewObservable,\n    };\n}\nvar SESSION_ENTRY_REGEXP = /^([a-z]+)=([a-z0-9-]+)$/;\nvar SESSION_ENTRY_SEPARATOR = '&';\nexport function isValidSessionString(sessionString) {\n    return (sessionString !== undefined &&\n        (sessionString.indexOf(SESSION_ENTRY_SEPARATOR) !== -1 || SESSION_ENTRY_REGEXP.test(sessionString)));\n}\nfunction retrieveActiveSession(sessionCookie) {\n    var session = retrieveSession(sessionCookie);\n    if (isActiveSession(session)) {\n        return session;\n    }\n    clearSession(sessionCookie);\n    return {};\n}\nfunction isActiveSession(session) {\n    // created and expire can be undefined for versions which was not storing them\n    // these checks could be removed when older versions will not be available/live anymore\n    return ((session.created === undefined || Date.now() - Number(session.created) < SESSION_TIME_OUT_DELAY) &&\n        (session.expire === undefined || Date.now() < Number(session.expire)));\n}\nfunction retrieveSession(sessionCookie) {\n    var sessionString = sessionCookie.get();\n    var session = {};\n    if (isValidSessionString(sessionString)) {\n        sessionString.split(SESSION_ENTRY_SEPARATOR).forEach(function (entry) {\n            var matches = SESSION_ENTRY_REGEXP.exec(entry);\n            if (matches !== null) {\n                var key = matches[1], value = matches[2];\n                session[key] = value;\n            }\n        });\n    }\n    return session;\n}\nexport function persistSession(session, cookie) {\n    if (utils.isEmptyObject(session)) {\n        clearSession(cookie);\n        return;\n    }\n    session.expire = String(Date.now() + SESSION_EXPIRATION_DELAY);\n    var cookieString = utils\n        .objectEntries(session)\n        .map(function (_a) {\n        var key = _a[0], value = _a[1];\n        return key + \"=\" + value;\n    })\n        .join(SESSION_ENTRY_SEPARATOR);\n    cookie.set(cookieString, SESSION_EXPIRATION_DELAY);\n}\nfunction clearSession(cookie) {\n    cookie.set('', 0);\n}\nexport function stopSessionManagement() {\n    stopCallbacks.forEach(function (e) { return e(); });\n    stopCallbacks = [];\n}\nvar stopCallbacks = [];\nexport function trackActivity(expandOrRenewSession) {\n    var stop = utils.addEventListeners(window, [\"click\" /* CLICK */, \"touchstart\" /* TOUCH_START */, \"keydown\" /* KEY_DOWN */, \"scroll\" /* SCROLL */], expandOrRenewSession, { capture: true, passive: true }).stop;\n    stopCallbacks.push(stop);\n}\nfunction trackVisibility(expandSession) {\n    var expandSessionWhenVisible = monitor(function () {\n        if (document.visibilityState === 'visible') {\n            expandSession();\n        }\n    });\n    var stop = utils.addEventListener(document, \"visibilitychange\" /* VISIBILITY_CHANGE */, expandSessionWhenVisible).stop;\n    stopCallbacks.push(stop);\n    var visibilityCheckInterval = setInterval(expandSessionWhenVisible, VISIBILITY_CHECK_DELAY);\n    stopCallbacks.push(function () {\n        clearInterval(visibilityCheckInterval);\n    });\n}\n//# sourceMappingURL=sessionManagement.js.map","import { getCookie } from '../browser/cookie';\nimport { persistSession } from './sessionManagement';\nexport var OLD_SESSION_COOKIE_NAME = '_dd';\nexport var OLD_RUM_COOKIE_NAME = '_dd_r';\nexport var OLD_LOGS_COOKIE_NAME = '_dd_l';\n// duplicate values to avoid dependency issues\nexport var RUM_SESSION_KEY = 'rum';\nexport var LOGS_SESSION_KEY = 'logs';\n/**\n * This migration should remain in the codebase as long as older versions are available/live\n * to allow older sdk versions to be upgraded to newer versions without compatibility issues.\n */\nexport function tryOldCookiesMigration(sessionCookie) {\n    var sessionString = sessionCookie.get();\n    var oldSessionId = getCookie(OLD_SESSION_COOKIE_NAME);\n    var oldRumType = getCookie(OLD_RUM_COOKIE_NAME);\n    var oldLogsType = getCookie(OLD_LOGS_COOKIE_NAME);\n    if (!sessionString) {\n        var session = {};\n        if (oldSessionId) {\n            session.id = oldSessionId;\n        }\n        if (oldLogsType && /^[01]$/.test(oldLogsType)) {\n            session[LOGS_SESSION_KEY] = oldLogsType;\n        }\n        if (oldRumType && /^[012]$/.test(oldRumType)) {\n            session[RUM_SESSION_KEY] = oldRumType;\n        }\n        persistSession(session, sessionCookie);\n    }\n}\n//# sourceMappingURL=oldCookiesMigration.js.map","import { __assign } from \"tslib\";\nimport { callMonitored, monitor } from '../domain/internalMonitoring';\nimport { elapsed, relativeNow, clocksNow, timeStampNow } from '../tools/timeUtils';\nimport { normalizeUrl } from '../tools/urlPolyfill';\nvar xhrProxySingleton;\nvar beforeSendCallbacks = [];\nvar onRequestCompleteCallbacks = [];\nvar originalXhrOpen;\nvar originalXhrSend;\nvar originalXhrAbort;\nexport function startXhrProxy() {\n    if (!xhrProxySingleton) {\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        originalXhrOpen = XMLHttpRequest.prototype.open;\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        originalXhrSend = XMLHttpRequest.prototype.send;\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        originalXhrAbort = XMLHttpRequest.prototype.abort;\n        XMLHttpRequest.prototype.open = openXhr;\n        XMLHttpRequest.prototype.send = sendXhr;\n        XMLHttpRequest.prototype.abort = abortXhr;\n        xhrProxySingleton = {\n            beforeSend: function (callback) {\n                beforeSendCallbacks.push(callback);\n            },\n            onRequestComplete: function (callback) {\n                onRequestCompleteCallbacks.push(callback);\n            },\n        };\n    }\n    return xhrProxySingleton;\n}\nexport function resetXhrProxy() {\n    if (xhrProxySingleton) {\n        xhrProxySingleton = undefined;\n        beforeSendCallbacks.length = 0;\n        onRequestCompleteCallbacks.length = 0;\n        XMLHttpRequest.prototype.open = originalXhrOpen;\n        XMLHttpRequest.prototype.send = originalXhrSend;\n        XMLHttpRequest.prototype.abort = originalXhrAbort;\n    }\n}\nfunction openXhr(method, url) {\n    var _this = this;\n    callMonitored(function () {\n        // WARN: since this data structure is tied to the instance, it is shared by both logs and rum\n        // and can be used by different code versions depending on customer setup\n        // so it should stay compatible with older versions\n        _this._datadog_xhr = {\n            method: method,\n            url: normalizeUrl(url),\n        };\n    });\n    return originalXhrOpen.apply(this, arguments);\n}\nfunction sendXhr() {\n    var _this = this;\n    callMonitored(function () {\n        if (!_this._datadog_xhr) {\n            return;\n        }\n        _this._datadog_xhr.startTime = relativeNow();\n        _this._datadog_xhr.startClocks = clocksNow();\n        _this._datadog_xhr.isAborted = false;\n        var hasBeenReported = false;\n        var originalOnreadystatechange = _this.onreadystatechange;\n        var onreadystatechange = function () {\n            if (this.readyState === XMLHttpRequest.DONE) {\n                // Try to report the XHR as soon as possible, because the XHR may be mutated by the\n                // application during a future event. For example, Angular is calling .abort() on\n                // completed requests during a onreadystatechange event, so the status becomes '0'\n                // before the request is collected.\n                onEnd();\n            }\n            if (originalOnreadystatechange) {\n                originalOnreadystatechange.apply(this, arguments);\n            }\n        };\n        var onEnd = monitor(function () {\n            _this.removeEventListener('loadend', onEnd);\n            // if the onreadystatechange hasn't been overridden by the user after the send()\n            if (_this.onreadystatechange === onreadystatechange) {\n                _this.onreadystatechange = originalOnreadystatechange;\n            }\n            if (hasBeenReported) {\n                return;\n            }\n            hasBeenReported = true;\n            reportXhr(_this);\n        });\n        _this.onreadystatechange = onreadystatechange;\n        _this.addEventListener('loadend', onEnd);\n        beforeSendCallbacks.forEach(function (callback) { return callback(_this._datadog_xhr, _this); });\n    });\n    return originalXhrSend.apply(this, arguments);\n}\nfunction abortXhr() {\n    var _this = this;\n    callMonitored(function () {\n        if (_this._datadog_xhr) {\n            _this._datadog_xhr.isAborted = true;\n        }\n    });\n    return originalXhrAbort.apply(this, arguments);\n}\nfunction reportXhr(xhr) {\n    xhr._datadog_xhr.duration = elapsed(xhr._datadog_xhr.startClocks.timeStamp, timeStampNow());\n    xhr._datadog_xhr.responseText = xhr.response;\n    xhr._datadog_xhr.status = xhr.status;\n    xhr._datadog_xhr.xhr = xhr;\n    onRequestCompleteCallbacks.forEach(function (callback) { return callback(__assign({}, xhr._datadog_xhr)); });\n}\n//# sourceMappingURL=xhrProxy.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { monitor, callMonitored } from '../domain/internalMonitoring';\nimport { computeStackTrace } from '../domain/tracekit';\nimport { toStackTraceString } from '../tools/error';\nimport { elapsed, clocksNow, timeStampNow } from '../tools/timeUtils';\nimport { normalizeUrl } from '../tools/urlPolyfill';\nvar fetchProxySingleton;\nvar originalFetch;\nvar beforeSendCallbacks = [];\nvar onRequestCompleteCallbacks = [];\nexport function startFetchProxy() {\n    if (!fetchProxySingleton) {\n        proxyFetch();\n        fetchProxySingleton = {\n            beforeSend: function (callback) {\n                beforeSendCallbacks.push(callback);\n            },\n            onRequestComplete: function (callback) {\n                onRequestCompleteCallbacks.push(callback);\n            },\n        };\n    }\n    return fetchProxySingleton;\n}\nexport function resetFetchProxy() {\n    if (fetchProxySingleton) {\n        fetchProxySingleton = undefined;\n        beforeSendCallbacks.splice(0, beforeSendCallbacks.length);\n        onRequestCompleteCallbacks.splice(0, onRequestCompleteCallbacks.length);\n        window.fetch = originalFetch;\n    }\n}\nfunction proxyFetch() {\n    if (!window.fetch) {\n        return;\n    }\n    originalFetch = window.fetch;\n    window.fetch = function (input, init) {\n        var responsePromise;\n        var context = callMonitored(beforeSend, null, [input, init]);\n        if (context) {\n            responsePromise = originalFetch.call(this, context.input, context.init);\n            callMonitored(afterSend, null, [responsePromise, context]);\n        }\n        else {\n            responsePromise = originalFetch.call(this, input, init);\n        }\n        return responsePromise;\n    };\n}\nfunction beforeSend(input, init) {\n    var method = (init && init.method) || (typeof input === 'object' && input.method) || 'GET';\n    var url = normalizeUrl((typeof input === 'object' && input.url) || input);\n    var startClocks = clocksNow();\n    var context = {\n        init: init,\n        input: input,\n        method: method,\n        startClocks: startClocks,\n        url: url,\n    };\n    beforeSendCallbacks.forEach(function (callback) { return callback(context); });\n    return context;\n}\nfunction afterSend(responsePromise, context) {\n    var _this = this;\n    var reportFetch = function (response) { return __awaiter(_this, void 0, void 0, function () {\n        var text, e_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    context.duration = elapsed(context.startClocks.timeStamp, timeStampNow());\n                    if (!('stack' in response || response instanceof Error)) return [3 /*break*/, 1];\n                    context.status = 0;\n                    context.responseText = toStackTraceString(computeStackTrace(response));\n                    context.isAborted = response instanceof DOMException && response.code === DOMException.ABORT_ERR;\n                    context.error = response;\n                    onRequestCompleteCallbacks.forEach(function (callback) { return callback(context); });\n                    return [3 /*break*/, 6];\n                case 1:\n                    if (!('status' in response)) return [3 /*break*/, 6];\n                    text = void 0;\n                    _a.label = 2;\n                case 2:\n                    _a.trys.push([2, 4, , 5]);\n                    return [4 /*yield*/, response.clone().text()];\n                case 3:\n                    text = _a.sent();\n                    return [3 /*break*/, 5];\n                case 4:\n                    e_1 = _a.sent();\n                    text = \"Unable to retrieve response: \" + e_1;\n                    return [3 /*break*/, 5];\n                case 5:\n                    context.response = response;\n                    context.responseText = text;\n                    context.responseType = response.type;\n                    context.status = response.status;\n                    context.isAborted = false;\n                    onRequestCompleteCallbacks.forEach(function (callback) { return callback(context); });\n                    _a.label = 6;\n                case 6: return [2 /*return*/];\n            }\n        });\n    }); };\n    responsePromise.then(monitor(reportFetch), monitor(reportFetch));\n}\n//# sourceMappingURL=fetchProxy.js.map","import { __assign } from \"tslib\";\nimport { getOrigin, objectEntries } from '@datadog/browser-core';\n/**\n * Clear tracing information to avoid incomplete traces. Ideally, we should do it when the the\n * request did not reach the server, but we the browser does not expose this. So, we clear tracing\n * information if the request ended with status 0 without being aborted by the application.\n *\n * Reasoning:\n *\n * * Applications are usually aborting requests after a bit of time, for example when the user is\n * typing (autocompletion) or navigating away (in a SPA). With a performant device and good\n * network conditions, the request is likely to reach the server before being canceled.\n *\n * * Requests aborted otherwise (ex: lack of internet, CORS issue, blocked by a privacy extension)\n * are likely to finish quickly and without reaching the server.\n *\n * Of course it might not be the case every time, but it should limit having incomplete traces a\n * bit..\n * */\nexport function clearTracingIfNeeded(context) {\n    if (context.status === 0 && !context.isAborted) {\n        context.traceId = undefined;\n        context.spanId = undefined;\n    }\n}\nexport function startTracer(configuration) {\n    return {\n        clearTracingIfNeeded: clearTracingIfNeeded,\n        traceFetch: function (context) {\n            return injectHeadersIfTracingAllowed(configuration, context, function (tracingHeaders) {\n                var _a;\n                if (context.input instanceof Request && !((_a = context.init) === null || _a === void 0 ? void 0 : _a.headers)) {\n                    context.input = new Request(context.input);\n                    Object.keys(tracingHeaders).forEach(function (key) {\n                        ;\n                        context.input.headers.append(key, tracingHeaders[key]);\n                    });\n                }\n                else {\n                    context.init = __assign({}, context.init);\n                    var headers_1 = [];\n                    if (context.init.headers instanceof Headers) {\n                        context.init.headers.forEach(function (value, key) {\n                            headers_1.push([key, value]);\n                        });\n                    }\n                    else if (Array.isArray(context.init.headers)) {\n                        context.init.headers.forEach(function (header) {\n                            headers_1.push(header);\n                        });\n                    }\n                    else if (context.init.headers) {\n                        Object.keys(context.init.headers).forEach(function (key) {\n                            headers_1.push([key, context.init.headers[key]]);\n                        });\n                    }\n                    context.init.headers = headers_1.concat(objectEntries(tracingHeaders));\n                }\n            });\n        },\n        traceXhr: function (context, xhr) {\n            return injectHeadersIfTracingAllowed(configuration, context, function (tracingHeaders) {\n                Object.keys(tracingHeaders).forEach(function (name) {\n                    xhr.setRequestHeader(name, tracingHeaders[name]);\n                });\n            });\n        },\n    };\n}\nfunction injectHeadersIfTracingAllowed(configuration, context, inject) {\n    if (!isTracingSupported() || !isAllowedUrl(configuration, context.url)) {\n        return;\n    }\n    context.traceId = new TraceIdentifier();\n    context.spanId = new TraceIdentifier();\n    inject(makeTracingHeaders(context.traceId, context.spanId));\n}\nfunction isAllowedUrl(configuration, requestUrl) {\n    var requestOrigin = getOrigin(requestUrl);\n    for (var _i = 0, _a = configuration.allowedTracingOrigins; _i < _a.length; _i++) {\n        var allowedOrigin = _a[_i];\n        if (requestOrigin === allowedOrigin || (allowedOrigin instanceof RegExp && allowedOrigin.test(requestOrigin))) {\n            return true;\n        }\n    }\n    return false;\n}\nexport function isTracingSupported() {\n    return getCrypto() !== undefined;\n}\nfunction getCrypto() {\n    return window.crypto || window.msCrypto;\n}\nfunction makeTracingHeaders(traceId, spanId) {\n    return {\n        'x-datadog-origin': 'rum',\n        'x-datadog-parent-id': spanId.toDecimalString(),\n        'x-datadog-sampled': '1',\n        'x-datadog-sampling-priority': '1',\n        'x-datadog-trace-id': traceId.toDecimalString(),\n    };\n}\n/* eslint-disable no-bitwise */\nvar TraceIdentifier = /** @class */ (function () {\n    function TraceIdentifier() {\n        this.buffer = new Uint8Array(8);\n        getCrypto().getRandomValues(this.buffer);\n        this.buffer[0] = this.buffer[0] & 0x7f; // force 63-bit\n    }\n    TraceIdentifier.prototype.toString = function (radix) {\n        var high = this.readInt32(0);\n        var low = this.readInt32(4);\n        var str = '';\n        while (1) {\n            var mod = (high % radix) * 4294967296 + low;\n            high = Math.floor(high / radix);\n            low = Math.floor(mod / radix);\n            str = (mod % radix).toString(radix) + str;\n            if (!high && !low) {\n                break;\n            }\n        }\n        return str;\n    };\n    /**\n     * Format used everywhere except the trace intake\n     */\n    TraceIdentifier.prototype.toDecimalString = function () {\n        return this.toString(10);\n    };\n    TraceIdentifier.prototype.readInt32 = function (offset) {\n        return (this.buffer[offset] * 16777216 +\n            (this.buffer[offset + 1] << 16) +\n            (this.buffer[offset + 2] << 8) +\n            this.buffer[offset + 3]);\n    };\n    return TraceIdentifier;\n}());\nexport { TraceIdentifier };\n/* eslint-enable no-bitwise */\n//# sourceMappingURL=tracer.js.map","import { RequestType, startFetchProxy, startXhrProxy, } from '@datadog/browser-core';\nimport { LifeCycleEventType } from './lifeCycle';\nimport { isAllowedRequestUrl } from './rumEventsCollection/resource/resourceUtils';\nimport { startTracer } from './tracing/tracer';\nvar nextRequestIndex = 1;\nexport function startRequestCollection(lifeCycle, configuration) {\n    var tracer = startTracer(configuration);\n    trackXhr(lifeCycle, configuration, tracer);\n    trackFetch(lifeCycle, configuration, tracer);\n}\nexport function trackXhr(lifeCycle, configuration, tracer) {\n    var xhrProxy = startXhrProxy();\n    xhrProxy.beforeSend(function (context, xhr) {\n        if (isAllowedRequestUrl(configuration, context.url)) {\n            tracer.traceXhr(context, xhr);\n            context.requestIndex = getNextRequestIndex();\n            lifeCycle.notify(LifeCycleEventType.REQUEST_STARTED, {\n                requestIndex: context.requestIndex,\n            });\n        }\n    });\n    xhrProxy.onRequestComplete(function (context) {\n        if (isAllowedRequestUrl(configuration, context.url)) {\n            tracer.clearTracingIfNeeded(context);\n            lifeCycle.notify(LifeCycleEventType.REQUEST_COMPLETED, {\n                duration: context.duration,\n                method: context.method,\n                requestIndex: context.requestIndex,\n                responseText: context.responseText,\n                spanId: context.spanId,\n                startClocks: context.startClocks,\n                status: context.status,\n                traceId: context.traceId,\n                type: RequestType.XHR,\n                url: context.url,\n                xhr: context.xhr,\n            });\n        }\n    });\n    return xhrProxy;\n}\nexport function trackFetch(lifeCycle, configuration, tracer) {\n    var fetchProxy = startFetchProxy();\n    fetchProxy.beforeSend(function (context) {\n        if (isAllowedRequestUrl(configuration, context.url)) {\n            tracer.traceFetch(context);\n            context.requestIndex = getNextRequestIndex();\n            lifeCycle.notify(LifeCycleEventType.REQUEST_STARTED, {\n                requestIndex: context.requestIndex,\n            });\n        }\n    });\n    fetchProxy.onRequestComplete(function (context) {\n        if (isAllowedRequestUrl(configuration, context.url)) {\n            tracer.clearTracingIfNeeded(context);\n            lifeCycle.notify(LifeCycleEventType.REQUEST_COMPLETED, {\n                duration: context.duration,\n                method: context.method,\n                requestIndex: context.requestIndex,\n                responseText: context.responseText,\n                responseType: context.responseType,\n                spanId: context.spanId,\n                startClocks: context.startClocks,\n                status: context.status,\n                traceId: context.traceId,\n                type: RequestType.FETCH,\n                url: context.url,\n                response: context.response,\n                init: context.init,\n                input: context.input,\n            });\n        }\n    });\n    return fetchProxy;\n}\nfunction getNextRequestIndex() {\n    var result = nextRequestIndex;\n    nextRequestIndex += 1;\n    return result;\n}\n//# sourceMappingURL=requestCollection.js.map","import { noop } from '@datadog/browser-core';\nimport { RumEventType } from '../rawRumEvent.types';\nimport { LifeCycleEventType } from './lifeCycle';\nexport function trackEventCounts(lifeCycle, callback) {\n    if (callback === void 0) { callback = noop; }\n    var eventCounts = {\n        errorCount: 0,\n        longTaskCount: 0,\n        resourceCount: 0,\n        userActionCount: 0,\n    };\n    var subscription = lifeCycle.subscribe(LifeCycleEventType.RUM_EVENT_COLLECTED, function (_a) {\n        var type = _a.type;\n        switch (type) {\n            case RumEventType.ERROR:\n                eventCounts.errorCount += 1;\n                callback(eventCounts);\n                break;\n            case RumEventType.ACTION:\n                eventCounts.userActionCount += 1;\n                callback(eventCounts);\n                break;\n            case RumEventType.LONG_TASK:\n                eventCounts.longTaskCount += 1;\n                callback(eventCounts);\n                break;\n            case RumEventType.RESOURCE:\n                eventCounts.resourceCount += 1;\n                callback(eventCounts);\n                break;\n        }\n    });\n    return {\n        stop: function () {\n            subscription.unsubscribe();\n        },\n        eventCounts: eventCounts,\n    };\n}\n//# sourceMappingURL=trackEventCounts.js.map","import { monitor, Observable, timeStampNow } from '@datadog/browser-core';\nimport { LifeCycleEventType } from './lifeCycle';\n// Delay to wait for a page activity to validate the tracking process\nexport var PAGE_ACTIVITY_VALIDATION_DELAY = 100;\n// Delay to wait after a page activity to end the tracking process\nexport var PAGE_ACTIVITY_END_DELAY = 100;\n// Maximum duration of the tracking process\nexport var PAGE_ACTIVITY_MAX_DURATION = 10000;\nexport function waitIdlePageActivity(lifeCycle, domMutationObservable, completionCallback) {\n    var _a = trackPageActivities(lifeCycle, domMutationObservable), pageActivitiesObservable = _a.observable, stopPageActivitiesTracking = _a.stop;\n    var stopWaitPageActivitiesCompletion = waitPageActivitiesCompletion(pageActivitiesObservable, stopPageActivitiesTracking, completionCallback).stop;\n    var stop = function () {\n        stopWaitPageActivitiesCompletion();\n        stopPageActivitiesTracking();\n    };\n    return { stop: stop };\n}\n// Automatic action collection lifecycle overview:\n//                      (Start new trackPageActivities)\n//              .-------------------'--------------------.\n//              v                                        v\n//     [Wait for a page activity ]          [Wait for a maximum duration]\n//     [timeout: VALIDATION_DELAY]          [  timeout: MAX_DURATION    ]\n//          /                  \\                           |\n//         v                    v                          |\n//  [No page activity]   [Page activity]                   |\n//         |                   |,----------------------.   |\n//         v                   v                       |   |\n//     (Discard)     [Wait for a page activity]        |   |\n//                   [   timeout: END_DELAY   ]        |   |\n//                       /                \\            |   |\n//                      v                  v           |   |\n//             [No page activity]    [Page activity]   |   |\n//                      |                 |            |   |\n//                      |                 '------------'   |\n//                      '-----------. ,--------------------'\n//                                   v\n//                                 (End)\n//\n// Note: because MAX_DURATION > VALIDATION_DELAY, we are sure that if the process is still alive\n// after MAX_DURATION, it has been validated.\nexport function trackPageActivities(lifeCycle, domMutationObservable) {\n    var observable = new Observable();\n    var subscriptions = [];\n    var firstRequestIndex;\n    var pendingRequestsCount = 0;\n    subscriptions.push(domMutationObservable.subscribe(function () { return notifyPageActivity(); }));\n    subscriptions.push(lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n        if (entry.entryType !== 'resource') {\n            return;\n        }\n        notifyPageActivity();\n    }));\n    subscriptions.push(lifeCycle.subscribe(LifeCycleEventType.REQUEST_STARTED, function (startEvent) {\n        if (firstRequestIndex === undefined) {\n            firstRequestIndex = startEvent.requestIndex;\n        }\n        pendingRequestsCount += 1;\n        notifyPageActivity();\n    }));\n    subscriptions.push(lifeCycle.subscribe(LifeCycleEventType.REQUEST_COMPLETED, function (request) {\n        // If the request started before the tracking start, ignore it\n        if (firstRequestIndex === undefined || request.requestIndex < firstRequestIndex) {\n            return;\n        }\n        pendingRequestsCount -= 1;\n        notifyPageActivity();\n    }));\n    function notifyPageActivity() {\n        observable.notify({ isBusy: pendingRequestsCount > 0 });\n    }\n    return {\n        observable: observable,\n        stop: function () {\n            subscriptions.forEach(function (s) { return s.unsubscribe(); });\n        },\n    };\n}\nexport function waitPageActivitiesCompletion(pageActivitiesObservable, stopPageActivitiesTracking, completionCallback) {\n    var idleTimeoutId;\n    var hasCompleted = false;\n    var validationTimeoutId = setTimeout(monitor(function () { return complete({ hadActivity: false }); }), PAGE_ACTIVITY_VALIDATION_DELAY);\n    var maxDurationTimeoutId = setTimeout(monitor(function () { return complete({ hadActivity: true, endTime: timeStampNow() }); }), PAGE_ACTIVITY_MAX_DURATION);\n    pageActivitiesObservable.subscribe(function (_a) {\n        var isBusy = _a.isBusy;\n        clearTimeout(validationTimeoutId);\n        clearTimeout(idleTimeoutId);\n        var lastChangeTime = timeStampNow();\n        if (!isBusy) {\n            idleTimeoutId = setTimeout(monitor(function () { return complete({ hadActivity: true, endTime: lastChangeTime }); }), PAGE_ACTIVITY_END_DELAY);\n        }\n    });\n    var stop = function () {\n        hasCompleted = true;\n        clearTimeout(validationTimeoutId);\n        clearTimeout(idleTimeoutId);\n        clearTimeout(maxDurationTimeoutId);\n        stopPageActivitiesTracking();\n    };\n    function complete(params) {\n        if (hasCompleted) {\n            return;\n        }\n        stop();\n        completionCallback(params);\n    }\n    return { stop: stop };\n}\n//# sourceMappingURL=trackPageActivities.js.map","import { safeTruncate } from '@datadog/browser-core';\nexport function getActionNameFromElement(element) {\n    // Proceed to get the action name in two steps:\n    // * first, get the name programmatically, explicitly defined by the user.\n    // * then, use strategies that are known to return good results. Those strategies will be used on\n    //   the element and a few parents, but it's likely that they won't succeed at all.\n    // * if no name is found this way, use strategies returning less accurate names as a fallback.\n    //   Those are much likely to succeed.\n    return (getActionNameFromElementProgrammatically(element) ||\n        getActionNameFromElementForStrategies(element, priorityStrategies) ||\n        getActionNameFromElementForStrategies(element, fallbackStrategies) ||\n        '');\n}\n/**\n * Get the action name from the attribute 'data-dd-action-name' on the element or any of its parent.\n */\nvar PROGRAMMATIC_ATTRIBUTE = 'data-dd-action-name';\nfunction getActionNameFromElementProgrammatically(targetElement) {\n    var elementWithAttribute;\n    // We don't use getActionNameFromElementForStrategies here, because we want to consider all parents,\n    // without limit. It is up to the user to declare a relevant naming strategy.\n    // If available, use element.closest() to match get the attribute from the element or any of its\n    // parent.  Else fallback to a more traditional implementation.\n    if (supportsElementClosest()) {\n        elementWithAttribute = targetElement.closest(\"[\" + PROGRAMMATIC_ATTRIBUTE + \"]\");\n    }\n    else {\n        var element = targetElement;\n        while (element) {\n            if (element.hasAttribute(PROGRAMMATIC_ATTRIBUTE)) {\n                elementWithAttribute = element;\n                break;\n            }\n            element = element.parentElement;\n        }\n    }\n    if (!elementWithAttribute) {\n        return;\n    }\n    var name = elementWithAttribute.getAttribute(PROGRAMMATIC_ATTRIBUTE);\n    return truncate(normalizeWhitespace(name.trim()));\n}\nvar priorityStrategies = [\n    // associated LABEL text\n    function (element) {\n        // IE does not support element.labels, so we fallback to a CSS selector based on the element id\n        // instead\n        if (supportsLabelProperty()) {\n            if ('labels' in element && element.labels && element.labels.length > 0) {\n                return getTextualContent(element.labels[0]);\n            }\n        }\n        else if (element.id) {\n            var label = element.ownerDocument && element.ownerDocument.querySelector(\"label[for=\\\"\" + element.id.replace('\"', '\\\\\"') + \"\\\"]\");\n            return label && getTextualContent(label);\n        }\n    },\n    // INPUT button (and associated) value\n    function (element) {\n        if (element.nodeName === 'INPUT') {\n            var input = element;\n            var type = input.getAttribute('type');\n            if (type === 'button' || type === 'submit' || type === 'reset') {\n                return input.value;\n            }\n        }\n    },\n    // BUTTON, LABEL or button-like element text\n    function (element) {\n        if (element.nodeName === 'BUTTON' || element.nodeName === 'LABEL' || element.getAttribute('role') === 'button') {\n            return getTextualContent(element);\n        }\n    },\n    function (element) { return element.getAttribute('aria-label'); },\n    // associated element text designated by the aria-labelledby attribute\n    function (element) {\n        var labelledByAttribute = element.getAttribute('aria-labelledby');\n        if (labelledByAttribute) {\n            return labelledByAttribute\n                .split(/\\s+/)\n                .map(function (id) { return getElementById(element, id); })\n                .filter(function (label) { return Boolean(label); })\n                .map(getTextualContent)\n                .join(' ');\n        }\n    },\n    function (element) { return element.getAttribute('alt'); },\n    function (element) { return element.getAttribute('name'); },\n    function (element) { return element.getAttribute('title'); },\n    function (element) { return element.getAttribute('placeholder'); },\n    // SELECT first OPTION text\n    function (element) {\n        if ('options' in element && element.options.length > 0) {\n            return getTextualContent(element.options[0]);\n        }\n    },\n];\nvar fallbackStrategies = [function (element) { return getTextualContent(element); }];\n/**\n * Iterates over the target element and its parent, using the strategies list to get an action name.\n * Each strategies are applied on each element, stopping as soon as a non-empty value is returned.\n */\nvar MAX_PARENTS_TO_CONSIDER = 10;\nfunction getActionNameFromElementForStrategies(targetElement, strategies) {\n    var element = targetElement;\n    var recursionCounter = 0;\n    while (recursionCounter <= MAX_PARENTS_TO_CONSIDER &&\n        element &&\n        element.nodeName !== 'BODY' &&\n        element.nodeName !== 'HTML' &&\n        element.nodeName !== 'HEAD') {\n        for (var _i = 0, strategies_1 = strategies; _i < strategies_1.length; _i++) {\n            var strategy = strategies_1[_i];\n            var name_1 = strategy(element);\n            if (typeof name_1 === 'string') {\n                var trimmedName = name_1.trim();\n                if (trimmedName) {\n                    return truncate(normalizeWhitespace(trimmedName));\n                }\n            }\n        }\n        // Consider a FORM as a contextual limit to get the action name.  This is experimental and may\n        // be reconsidered in the future.\n        if (element.nodeName === 'FORM') {\n            break;\n        }\n        element = element.parentElement;\n        recursionCounter += 1;\n    }\n}\nfunction normalizeWhitespace(s) {\n    return s.replace(/\\s+/g, ' ');\n}\nfunction truncate(s) {\n    return s.length > 100 ? safeTruncate(s, 100) + \" [...]\" : s;\n}\nfunction getElementById(refElement, id) {\n    // Use the element ownerDocument here, because tests are executed in an iframe, so\n    // document.getElementById won't work.\n    return refElement.ownerDocument ? refElement.ownerDocument.getElementById(id) : null;\n}\nfunction getTextualContent(element) {\n    if (element.isContentEditable) {\n        return;\n    }\n    if ('innerText' in element) {\n        var text = element.innerText;\n        if (!supportsInnerTextScriptAndStyleRemoval()) {\n            // remove the inner text of SCRIPT and STYLES from the result. This is a bit dirty, but should\n            // be relatively fast and work in most cases.\n            var elementsTextToRemove = element.querySelectorAll('script, style');\n            // eslint-disable-next-line @typescript-eslint/prefer-for-of\n            for (var i = 0; i < elementsTextToRemove.length; i += 1) {\n                var innerText = elementsTextToRemove[i].innerText;\n                if (innerText.trim().length > 0) {\n                    text = text.replace(innerText, '');\n                }\n            }\n        }\n        return text;\n    }\n    return element.textContent;\n}\n/**\n * Returns true if element.innerText excludes the text from inline SCRIPT and STYLE element.  This\n * should be the case everywhere except on some version of Internet Explorer.\n * See http://perfectionkills.com/the-poor-misunderstood-innerText/#diff-with-textContent\n */\nvar supportsInnerTextScriptAndStyleRemovalResult;\nfunction supportsInnerTextScriptAndStyleRemoval() {\n    if (supportsInnerTextScriptAndStyleRemovalResult === undefined) {\n        var style = document.createElement('style');\n        style.textContent = '*';\n        var div = document.createElement('div');\n        div.appendChild(style);\n        document.body.appendChild(div);\n        supportsInnerTextScriptAndStyleRemovalResult = div.innerText === '';\n        document.body.removeChild(div);\n    }\n    return supportsInnerTextScriptAndStyleRemovalResult;\n}\n/**\n * Returns true if the browser supports the element.labels property.  This should be the case\n * everywhere except on Internet Explorer.\n * Note: The result is computed lazily, because we don't want any DOM access when the SDK is\n * evaluated.\n */\nvar supportsLabelPropertyResult;\nfunction supportsLabelProperty() {\n    if (supportsLabelPropertyResult === undefined) {\n        supportsLabelPropertyResult = 'labels' in HTMLInputElement.prototype;\n    }\n    return supportsLabelPropertyResult;\n}\n/**\n * Returns true if the browser supports the element.closest method.  This should be the case\n * everywhere except on Internet Explorer.\n * Note: The result is computed lazily, because we don't want any DOM access when the SDK is\n * evaluated.\n */\nvar supportsElementClosestResult;\nfunction supportsElementClosest() {\n    if (supportsElementClosestResult === undefined) {\n        supportsElementClosestResult = 'closest' in HTMLElement.prototype;\n    }\n    return supportsElementClosestResult;\n}\n//# sourceMappingURL=getActionNameFromElement.js.map","import { addEventListener, elapsed, generateUUID, clocksNow, } from '@datadog/browser-core';\nimport { ActionType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { trackEventCounts } from '../../trackEventCounts';\nimport { waitIdlePageActivity } from '../../trackPageActivities';\nimport { getActionNameFromElement } from './getActionNameFromElement';\nexport function trackActions(lifeCycle, domMutationObservable) {\n    var action = startActionManagement(lifeCycle, domMutationObservable);\n    // New views trigger the discard of the current pending Action\n    lifeCycle.subscribe(LifeCycleEventType.VIEW_CREATED, function () {\n        action.discardCurrent();\n    });\n    var stopListener = addEventListener(window, \"click\" /* CLICK */, function (event) {\n        if (!(event.target instanceof Element)) {\n            return;\n        }\n        var name = getActionNameFromElement(event.target);\n        if (!name) {\n            return;\n        }\n        action.create(ActionType.CLICK, name, event);\n    }, { capture: true }).stop;\n    return {\n        stop: function () {\n            action.discardCurrent();\n            stopListener();\n        },\n    };\n}\nfunction startActionManagement(lifeCycle, domMutationObservable) {\n    var currentAction;\n    var currentIdlePageActivitySubscription;\n    return {\n        create: function (type, name, event) {\n            if (currentAction) {\n                // Ignore any new action if another one is already occurring.\n                return;\n            }\n            var pendingAutoAction = new PendingAutoAction(lifeCycle, type, name, event);\n            currentAction = pendingAutoAction;\n            currentIdlePageActivitySubscription = waitIdlePageActivity(lifeCycle, domMutationObservable, function (params) {\n                if (params.hadActivity) {\n                    pendingAutoAction.complete(params.endTime);\n                }\n                else {\n                    pendingAutoAction.discard();\n                }\n                currentAction = undefined;\n            });\n        },\n        discardCurrent: function () {\n            if (currentAction) {\n                currentIdlePageActivitySubscription.stop();\n                currentAction.discard();\n                currentAction = undefined;\n            }\n        },\n    };\n}\nvar PendingAutoAction = /** @class */ (function () {\n    function PendingAutoAction(lifeCycle, type, name, event) {\n        this.lifeCycle = lifeCycle;\n        this.type = type;\n        this.name = name;\n        this.event = event;\n        this.id = generateUUID();\n        this.startClocks = clocksNow();\n        this.eventCountsSubscription = trackEventCounts(lifeCycle);\n        this.lifeCycle.notify(LifeCycleEventType.AUTO_ACTION_CREATED, { id: this.id, startClocks: this.startClocks });\n    }\n    PendingAutoAction.prototype.complete = function (endTime) {\n        var eventCounts = this.eventCountsSubscription.eventCounts;\n        this.lifeCycle.notify(LifeCycleEventType.AUTO_ACTION_COMPLETED, {\n            counts: {\n                errorCount: eventCounts.errorCount,\n                longTaskCount: eventCounts.longTaskCount,\n                resourceCount: eventCounts.resourceCount,\n            },\n            duration: elapsed(this.startClocks.timeStamp, endTime),\n            id: this.id,\n            name: this.name,\n            startClocks: this.startClocks,\n            type: this.type,\n            event: this.event,\n        });\n        this.eventCountsSubscription.stop();\n    };\n    PendingAutoAction.prototype.discard = function () {\n        this.lifeCycle.notify(LifeCycleEventType.AUTO_ACTION_DISCARDED);\n        this.eventCountsSubscription.stop();\n    };\n    return PendingAutoAction;\n}());\n//# sourceMappingURL=trackActions.js.map","import { __assign, __spreadArrays } from \"tslib\";\nimport { resetFetchProxy, startFetchProxy } from '../browser/fetchProxy';\nimport { resetXhrProxy, startXhrProxy } from '../browser/xhrProxy';\nimport { ErrorSource, formatUnknownError, toStackTraceString, formatErrorMessage, ErrorHandling, createHandlingStack, } from '../tools/error';\nimport { Observable } from '../tools/observable';\nimport { clocksNow } from '../tools/timeUtils';\nimport { jsonStringify, RequestType, find } from '../tools/utils';\nimport { callMonitored } from './internalMonitoring';\nimport { computeStackTrace, subscribe, unsubscribe } from './tracekit';\nvar errorObservable;\nexport function startAutomaticErrorCollection(configuration) {\n    if (!errorObservable) {\n        errorObservable = new Observable();\n        trackNetworkError(configuration, errorObservable);\n        startConsoleTracking(errorObservable);\n        startRuntimeErrorTracking(errorObservable);\n    }\n    return errorObservable;\n}\nvar originalConsoleError;\n/* eslint-disable no-console */\nexport function startConsoleTracking(errorObservable) {\n    originalConsoleError = console.error;\n    console.error = function () {\n        var params = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            params[_i] = arguments[_i];\n        }\n        var handlingStack = createHandlingStack();\n        callMonitored(function () {\n            originalConsoleError.apply(console, params);\n            errorObservable.notify(__assign(__assign({}, buildErrorFromParams(params, handlingStack)), { source: ErrorSource.CONSOLE, startClocks: clocksNow(), handling: ErrorHandling.HANDLED }));\n        });\n    };\n}\nexport function stopConsoleTracking() {\n    console.error = originalConsoleError;\n}\n/* eslint-enable no-console */\nfunction buildErrorFromParams(params, handlingStack) {\n    var firstErrorParam = find(params, function (param) { return param instanceof Error; });\n    return {\n        message: __spreadArrays(['console error:'], params).map(function (param) { return formatConsoleParameters(param); }).join(' '),\n        stack: firstErrorParam ? toStackTraceString(computeStackTrace(firstErrorParam)) : undefined,\n        handlingStack: handlingStack,\n    };\n}\nfunction formatConsoleParameters(param) {\n    if (typeof param === 'string') {\n        return param;\n    }\n    if (param instanceof Error) {\n        return formatErrorMessage(computeStackTrace(param));\n    }\n    return jsonStringify(param, undefined, 2);\n}\nvar traceKitReportHandler;\nexport function startRuntimeErrorTracking(errorObservable) {\n    traceKitReportHandler = function (stackTrace, _, errorObject) {\n        var _a = formatUnknownError(stackTrace, errorObject, 'Uncaught'), stack = _a.stack, message = _a.message, type = _a.type;\n        errorObservable.notify({\n            message: message,\n            stack: stack,\n            type: type,\n            source: ErrorSource.SOURCE,\n            startClocks: clocksNow(),\n            originalError: errorObject,\n            handling: ErrorHandling.UNHANDLED,\n        });\n    };\n    subscribe(traceKitReportHandler);\n}\nexport function stopRuntimeErrorTracking() {\n    unsubscribe(traceKitReportHandler);\n}\nexport function trackNetworkError(configuration, errorObservable) {\n    startXhrProxy().onRequestComplete(function (context) { return handleCompleteRequest(RequestType.XHR, context); });\n    startFetchProxy().onRequestComplete(function (context) { return handleCompleteRequest(RequestType.FETCH, context); });\n    function handleCompleteRequest(type, request) {\n        if (!configuration.isIntakeUrl(request.url) &&\n            (!configuration.isEnabled('remove-network-errors') || !request.isAborted) &&\n            (isRejected(request) || isServerError(request))) {\n            errorObservable.notify({\n                message: format(type) + \" error \" + request.method + \" \" + request.url,\n                resource: {\n                    method: request.method,\n                    statusCode: request.status,\n                    url: request.url,\n                },\n                source: ErrorSource.NETWORK,\n                stack: truncateResponseText(request.responseText, configuration) || 'Failed to load',\n                startClocks: request.startClocks,\n            });\n        }\n    }\n    return {\n        stop: function () {\n            resetXhrProxy();\n            resetFetchProxy();\n        },\n    };\n}\nfunction isRejected(request) {\n    return request.status === 0 && request.responseType !== 'opaque';\n}\nfunction isServerError(request) {\n    return request.status >= 500;\n}\nfunction truncateResponseText(responseText, configuration) {\n    if (responseText && responseText.length > configuration.requestErrorResponseLengthLimit) {\n        return responseText.substring(0, configuration.requestErrorResponseLengthLimit) + \"...\";\n    }\n    return responseText;\n}\nfunction format(type) {\n    if (RequestType.XHR === type) {\n        return 'XHR';\n    }\n    return 'Fetch';\n}\n//# sourceMappingURL=automaticErrorCollection.js.map","import { addEventListener } from '@datadog/browser-core';\nvar trackFirstHiddenSingleton;\nvar stopListeners;\nexport function trackFirstHidden(emitter) {\n    if (emitter === void 0) { emitter = window; }\n    if (!trackFirstHiddenSingleton) {\n        if (document.visibilityState === 'hidden') {\n            trackFirstHiddenSingleton = { timeStamp: 0 };\n        }\n        else {\n            trackFirstHiddenSingleton = {\n                timeStamp: Infinity,\n            };\n            (stopListeners = addEventListener(emitter, \"pagehide\" /* PAGE_HIDE */, function (_a) {\n                var timeStamp = _a.timeStamp;\n                trackFirstHiddenSingleton.timeStamp = timeStamp;\n            }, { capture: true, once: true }).stop);\n        }\n    }\n    return trackFirstHiddenSingleton;\n}\nexport function resetFirstHidden() {\n    if (stopListeners) {\n        stopListeners();\n    }\n    trackFirstHiddenSingleton = undefined;\n}\n//# sourceMappingURL=trackFirstHidden.js.map","import { performDraw, startSessionManagement } from '@datadog/browser-core';\nimport { LifeCycleEventType } from './lifeCycle';\nexport var RUM_SESSION_KEY = 'rum';\nexport var RumTrackingType;\n(function (RumTrackingType) {\n    RumTrackingType[\"NOT_TRACKED\"] = \"0\";\n    RumTrackingType[\"TRACKED_WITH_RESOURCES\"] = \"1\";\n    RumTrackingType[\"TRACKED_WITHOUT_RESOURCES\"] = \"2\";\n})(RumTrackingType || (RumTrackingType = {}));\nexport function startRumSession(configuration, lifeCycle) {\n    var session = startSessionManagement(configuration.cookieOptions, RUM_SESSION_KEY, function (rawTrackingType) {\n        return computeSessionState(configuration, rawTrackingType);\n    });\n    session.renewObservable.subscribe(function () {\n        lifeCycle.notify(LifeCycleEventType.SESSION_RENEWED);\n    });\n    return {\n        getId: session.getId,\n        isTracked: function () { return session.getId() !== undefined && isTracked(session.getTrackingType()); },\n        isTrackedWithResource: function () {\n            return session.getId() !== undefined && session.getTrackingType() === RumTrackingType.TRACKED_WITH_RESOURCES;\n        },\n    };\n}\nfunction computeSessionState(configuration, rawTrackingType) {\n    var trackingType;\n    if (hasValidRumSession(rawTrackingType)) {\n        trackingType = rawTrackingType;\n    }\n    else if (!performDraw(configuration.sampleRate)) {\n        trackingType = RumTrackingType.NOT_TRACKED;\n    }\n    else if (!performDraw(configuration.resourceSampleRate)) {\n        trackingType = RumTrackingType.TRACKED_WITHOUT_RESOURCES;\n    }\n    else {\n        trackingType = RumTrackingType.TRACKED_WITH_RESOURCES;\n    }\n    return {\n        trackingType: trackingType,\n        isTracked: isTracked(trackingType),\n    };\n}\nfunction hasValidRumSession(trackingType) {\n    return (trackingType === RumTrackingType.NOT_TRACKED ||\n        trackingType === RumTrackingType.TRACKED_WITH_RESOURCES ||\n        trackingType === RumTrackingType.TRACKED_WITHOUT_RESOURCES);\n}\nfunction isTracked(rumSessionType) {\n    return (rumSessionType === RumTrackingType.TRACKED_WITH_RESOURCES ||\n        rumSessionType === RumTrackingType.TRACKED_WITHOUT_RESOURCES);\n}\n//# sourceMappingURL=rumSession.js.map","import { __assign } from \"tslib\";\nimport { combine, toServerDuration, generateUUID } from '@datadog/browser-core';\nimport { ActionType, RumEventType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { trackActions } from './trackActions';\nexport function startActionCollection(lifeCycle, domMutationObservable, configuration, foregroundContexts) {\n    lifeCycle.subscribe(LifeCycleEventType.AUTO_ACTION_COMPLETED, function (action) {\n        return lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, processAction(action, foregroundContexts));\n    });\n    if (configuration.trackInteractions) {\n        trackActions(lifeCycle, domMutationObservable);\n    }\n    return {\n        addAction: function (action, savedCommonContext) {\n            lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, __assign({ savedCommonContext: savedCommonContext }, processAction(action, foregroundContexts)));\n        },\n    };\n}\nfunction processAction(action, foregroundContexts) {\n    var autoActionProperties = isAutoAction(action)\n        ? {\n            action: {\n                error: {\n                    count: action.counts.errorCount,\n                },\n                id: action.id,\n                loading_time: toServerDuration(action.duration),\n                long_task: {\n                    count: action.counts.longTaskCount,\n                },\n                resource: {\n                    count: action.counts.resourceCount,\n                },\n            },\n        }\n        : undefined;\n    var customerContext = !isAutoAction(action) ? action.context : undefined;\n    var actionEvent = combine({\n        action: {\n            id: generateUUID(),\n            target: {\n                name: action.name,\n            },\n            type: action.type,\n        },\n        date: action.startClocks.timeStamp,\n        type: RumEventType.ACTION,\n    }, autoActionProperties);\n    var inForeground = foregroundContexts.getInForeground(action.startClocks.relative);\n    if (inForeground !== undefined) {\n        actionEvent.view = { in_foreground: inForeground };\n    }\n    return {\n        customerContext: customerContext,\n        rawRumEvent: actionEvent,\n        startTime: action.startClocks.relative,\n        domainContext: isAutoAction(action) ? { event: action.event } : {},\n    };\n}\nfunction isAutoAction(action) {\n    return action.type !== ActionType.CUSTOM;\n}\n//# sourceMappingURL=actionCollection.js.map","import { toValidEntry } from './resourceUtils';\n/**\n * Look for corresponding timing in resource timing buffer\n *\n * Observations:\n * - Timing (start, end) are nested inside the request (start, end)\n * - Some timing can be not exactly nested, being off by < 1 ms\n * - Browsers generate a timing entry for OPTIONS request\n *\n * Strategy:\n * - from valid nested entries (with 1 ms error margin)\n * - if a single timing match, return the timing\n * - if two following timings match (OPTIONS request), return the timing for the actual request\n * - otherwise we can't decide, return undefined\n */\nexport function matchRequestTiming(request) {\n    if (!performance || !('getEntriesByName' in performance)) {\n        return;\n    }\n    var sameNameEntries = performance.getEntriesByName(request.url, 'resource');\n    if (!sameNameEntries.length || !('toJSON' in sameNameEntries[0])) {\n        return;\n    }\n    var candidates = sameNameEntries\n        .map(function (entry) { return entry.toJSON(); })\n        .filter(toValidEntry)\n        .filter(function (entry) {\n        return isBetween(entry, request.startClocks.relative, endTime({ startTime: request.startClocks.relative, duration: request.duration }));\n    });\n    if (candidates.length === 1) {\n        return candidates[0];\n    }\n    if (candidates.length === 2 && firstCanBeOptionRequest(candidates)) {\n        return candidates[1];\n    }\n    return;\n}\nfunction firstCanBeOptionRequest(correspondingEntries) {\n    return endTime(correspondingEntries[0]) <= correspondingEntries[1].startTime;\n}\nfunction endTime(timing) {\n    // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n    return (timing.startTime + timing.duration);\n}\nfunction isBetween(timing, start, end) {\n    var errorMargin = 1;\n    // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n    return timing.startTime >= start - errorMargin && endTime(timing) <= end + errorMargin;\n}\n//# sourceMappingURL=matchRequestTiming.js.map","import { __assign } from \"tslib\";\nimport { combine, generateUUID, RequestType, ResourceType, toServerDuration, relativeToClocks, } from '@datadog/browser-core';\nimport { supportPerformanceEntry, } from '../../../browser/performanceCollection';\nimport { RumEventType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { matchRequestTiming } from './matchRequestTiming';\nimport { computePerformanceResourceDetails, computePerformanceResourceDuration, computeResourceKind, computeSize, isRequestKind, } from './resourceUtils';\nexport function startResourceCollection(lifeCycle, session) {\n    lifeCycle.subscribe(LifeCycleEventType.REQUEST_COMPLETED, function (request) {\n        if (session.isTrackedWithResource()) {\n            lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, processRequest(request));\n        }\n    });\n    lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n        if (session.isTrackedWithResource() && entry.entryType === 'resource' && !isRequestKind(entry)) {\n            lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, processResourceEntry(entry));\n        }\n    });\n}\nfunction processRequest(request) {\n    var type = request.type === RequestType.XHR ? ResourceType.XHR : ResourceType.FETCH;\n    var matchingTiming = matchRequestTiming(request);\n    var startClocks = matchingTiming ? relativeToClocks(matchingTiming.startTime) : request.startClocks;\n    var correspondingTimingOverrides = matchingTiming ? computePerformanceEntryMetrics(matchingTiming) : undefined;\n    var tracingInfo = computeRequestTracingInfo(request);\n    var resourceEvent = combine({\n        date: startClocks.timeStamp,\n        resource: {\n            id: generateUUID(),\n            type: type,\n            duration: toServerDuration(request.duration),\n            method: request.method,\n            status_code: request.status,\n            url: request.url,\n        },\n        type: RumEventType.RESOURCE,\n    }, tracingInfo, correspondingTimingOverrides);\n    return {\n        startTime: startClocks.relative,\n        rawRumEvent: resourceEvent,\n        domainContext: {\n            performanceEntry: matchingTiming && toPerformanceEntryRepresentation(matchingTiming),\n            xhr: request.xhr,\n            response: request.response,\n            requestInput: request.input,\n            requestInit: request.init,\n            error: request.error,\n        },\n    };\n}\nfunction processResourceEntry(entry) {\n    var type = computeResourceKind(entry);\n    var entryMetrics = computePerformanceEntryMetrics(entry);\n    var tracingInfo = computeEntryTracingInfo(entry);\n    var startClocks = relativeToClocks(entry.startTime);\n    var resourceEvent = combine({\n        date: startClocks.timeStamp,\n        resource: {\n            id: generateUUID(),\n            type: type,\n            url: entry.name,\n        },\n        type: RumEventType.RESOURCE,\n    }, tracingInfo, entryMetrics);\n    return {\n        startTime: startClocks.relative,\n        rawRumEvent: resourceEvent,\n        domainContext: {\n            performanceEntry: toPerformanceEntryRepresentation(entry),\n        },\n    };\n}\nfunction computePerformanceEntryMetrics(timing) {\n    return {\n        resource: __assign({ duration: computePerformanceResourceDuration(timing), size: computeSize(timing) }, computePerformanceResourceDetails(timing)),\n    };\n}\nfunction computeRequestTracingInfo(request) {\n    var hasBeenTraced = request.traceId && request.spanId;\n    if (!hasBeenTraced) {\n        return undefined;\n    }\n    return {\n        _dd: {\n            span_id: request.spanId.toDecimalString(),\n            trace_id: request.traceId.toDecimalString(),\n        },\n    };\n}\nfunction computeEntryTracingInfo(entry) {\n    return entry.traceId ? { _dd: { trace_id: entry.traceId } } : undefined;\n}\nfunction toPerformanceEntryRepresentation(entry) {\n    if (supportPerformanceEntry() && entry instanceof PerformanceEntry) {\n        entry.toJSON();\n    }\n    return entry;\n}\n//# sourceMappingURL=resourceCollection.js.map","import { __assign } from \"tslib\";\nimport { addEventListeners, elapsed, ONE_DAY, addMonitoringMessage, relativeNow, timeStampNow, } from '@datadog/browser-core';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { trackFirstHidden } from './trackFirstHidden';\nexport function trackInitialViewTimings(lifeCycle, callback) {\n    var timings;\n    function setTimings(newTimings) {\n        timings = __assign(__assign({}, timings), newTimings);\n        callback(timings);\n    }\n    var stopNavigationTracking = trackNavigationTimings(lifeCycle, setTimings).stop;\n    var stopFCPTracking = trackFirstContentfulPaint(lifeCycle, function (firstContentfulPaint) {\n        return setTimings({ firstContentfulPaint: firstContentfulPaint });\n    }).stop;\n    var stopLCPTracking = trackLargestContentfulPaint(lifeCycle, window, function (largestContentfulPaint) {\n        setTimings({\n            largestContentfulPaint: largestContentfulPaint,\n        });\n    }).stop;\n    var stopFIDTracking = trackFirstInputTimings(lifeCycle, function (_a) {\n        var firstInputDelay = _a.firstInputDelay, firstInputTime = _a.firstInputTime;\n        setTimings({\n            firstInputDelay: firstInputDelay,\n            firstInputTime: firstInputTime,\n        });\n    }).stop;\n    return {\n        stop: function () {\n            stopNavigationTracking();\n            stopFCPTracking();\n            stopLCPTracking();\n            stopFIDTracking();\n        },\n    };\n}\nexport function trackNavigationTimings(lifeCycle, callback) {\n    var stop = lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n        if (entry.entryType === 'navigation') {\n            callback({\n                domComplete: entry.domComplete,\n                domContentLoaded: entry.domContentLoadedEventEnd,\n                domInteractive: entry.domInteractive,\n                loadEvent: entry.loadEventEnd,\n            });\n        }\n    }).unsubscribe;\n    return { stop: stop };\n}\nexport function trackFirstContentfulPaint(lifeCycle, callback) {\n    var firstHidden = trackFirstHidden();\n    var stop = lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n        if (entry.entryType === 'paint' &&\n            entry.name === 'first-contentful-paint' &&\n            entry.startTime < firstHidden.timeStamp) {\n            if (entry.startTime > ONE_DAY) {\n                addMonitoringMessage('FCP > 1 day', {\n                    debug: {\n                        fcp: Math.round(entry.startTime),\n                        relativeNow: Math.round(relativeNow()),\n                        timeStampNow: timeStampNow(),\n                    },\n                });\n            }\n            callback(entry.startTime);\n        }\n    }).unsubscribe;\n    return { stop: stop };\n}\n/**\n * Track the largest contentful paint (LCP) occurring during the initial View.  This can yield\n * multiple values, only the most recent one should be used.\n * Documentation: https://web.dev/lcp/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getLCP.ts\n */\nexport function trackLargestContentfulPaint(lifeCycle, emitter, callback) {\n    var firstHidden = trackFirstHidden();\n    // Ignore entries that come after the first user interaction.  According to the documentation, the\n    // browser should not send largest-contentful-paint entries after a user interact with the page,\n    // but the web-vitals reference implementation uses this as a safeguard.\n    var firstInteractionTimestamp = Infinity;\n    var stopEventListener = addEventListeners(emitter, [\"pointerdown\" /* POINTER_DOWN */, \"keydown\" /* KEY_DOWN */], function (event) {\n        firstInteractionTimestamp = event.timeStamp;\n    }, { capture: true, once: true }).stop;\n    var unsubscribeLifeCycle = lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n        if (entry.entryType === 'largest-contentful-paint' &&\n            entry.startTime < firstInteractionTimestamp &&\n            entry.startTime < firstHidden.timeStamp) {\n            if (entry.startTime > ONE_DAY) {\n                addMonitoringMessage('LCP > 1 day', {\n                    debug: {\n                        lcp: Math.round(entry.startTime),\n                        relativeNow: Math.round(relativeNow()),\n                        timeStampNow: timeStampNow(),\n                    },\n                });\n            }\n            callback(entry.startTime);\n        }\n    }).unsubscribe;\n    return {\n        stop: function () {\n            stopEventListener();\n            unsubscribeLifeCycle();\n        },\n    };\n}\n/**\n * Track the first input occurring during the initial View to return:\n * - First Input Delay\n * - First Input Time\n * Callback is called at most one time.\n * Documentation: https://web.dev/fid/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getFID.ts\n */\nexport function trackFirstInputTimings(lifeCycle, callback) {\n    var firstHidden = trackFirstHidden();\n    var stop = lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n        if (entry.entryType === 'first-input' && entry.startTime < firstHidden.timeStamp) {\n            var firstInputDelay = elapsed(entry.startTime, entry.processingStart);\n            callback({\n                // Ensure firstInputDelay to be positive, see\n                // https://bugs.chromium.org/p/chromium/issues/detail?id=1185815\n                firstInputDelay: firstInputDelay >= 0 ? firstInputDelay : 0,\n                firstInputTime: entry.startTime,\n            });\n        }\n    }).unsubscribe;\n    return {\n        stop: stop,\n    };\n}\n//# sourceMappingURL=trackInitialViewTimings.js.map","import { monitor, addEventListener } from '@datadog/browser-core';\nexport function trackLocationChanges(onLocationChange) {\n    var stopHistoryTracking = trackHistory(onLocationChange).stop;\n    var stopHashTracking = trackHash(onLocationChange).stop;\n    return {\n        stop: function () {\n            stopHistoryTracking();\n            stopHashTracking();\n        },\n    };\n}\nexport function areDifferentLocation(currentLocation, otherLocation) {\n    return (currentLocation.pathname !== otherLocation.pathname ||\n        (!isHashAnAnchor(otherLocation.hash) &&\n            getPathFromHash(otherLocation.hash) !== getPathFromHash(currentLocation.hash)));\n}\nfunction trackHistory(onHistoryChange) {\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    var originalPushState = history.pushState;\n    history.pushState = monitor(function () {\n        originalPushState.apply(this, arguments);\n        onHistoryChange();\n    });\n    // eslint-disable-next-line @typescript-eslint/unbound-method\n    var originalReplaceState = history.replaceState;\n    history.replaceState = monitor(function () {\n        originalReplaceState.apply(this, arguments);\n        onHistoryChange();\n    });\n    var removeListener = addEventListener(window, \"popstate\" /* POP_STATE */, onHistoryChange).stop;\n    var stop = function () {\n        removeListener();\n        history.pushState = originalPushState;\n        history.replaceState = originalReplaceState;\n    };\n    return { stop: stop };\n}\nfunction trackHash(onHashChange) {\n    return addEventListener(window, \"hashchange\" /* HASH_CHANGE */, onHashChange);\n}\nfunction isHashAnAnchor(hash) {\n    var correspondingId = hash.substr(1);\n    return !!document.getElementById(correspondingId);\n}\nfunction getPathFromHash(hash) {\n    var index = hash.indexOf('?');\n    return index < 0 ? hash : hash.slice(0, index);\n}\n//# sourceMappingURL=trackLocationChanges.js.map","import { noop, elapsed, round, timeStampNow } from '@datadog/browser-core';\nimport { supportPerformanceTimingEvent } from '../../../browser/performanceCollection';\nimport { ViewLoadingType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { trackEventCounts } from '../../trackEventCounts';\nimport { waitIdlePageActivity } from '../../trackPageActivities';\nexport function trackViewMetrics(lifeCycle, domMutationObservable, scheduleViewUpdate, loadingType) {\n    var viewMetrics = {\n        eventCounts: {\n            errorCount: 0,\n            longTaskCount: 0,\n            resourceCount: 0,\n            userActionCount: 0,\n        },\n    };\n    var stopEventCountsTracking = trackEventCounts(lifeCycle, function (newEventCounts) {\n        viewMetrics.eventCounts = newEventCounts;\n        scheduleViewUpdate();\n    }).stop;\n    var _a = trackLoadingTime(loadingType, function (newLoadingTime) {\n        viewMetrics.loadingTime = newLoadingTime;\n        scheduleViewUpdate();\n    }), setActivityLoadingTime = _a.setActivityLoadingTime, setLoadEvent = _a.setLoadEvent;\n    var stopActivityLoadingTimeTracking = trackActivityLoadingTime(lifeCycle, domMutationObservable, setActivityLoadingTime).stop;\n    var stopCLSTracking;\n    if (isLayoutShiftSupported()) {\n        viewMetrics.cumulativeLayoutShift = 0;\n        (stopCLSTracking = trackLayoutShift(lifeCycle, function (layoutShift) {\n            viewMetrics.cumulativeLayoutShift = round(viewMetrics.cumulativeLayoutShift + layoutShift, 4);\n            scheduleViewUpdate();\n        }).stop);\n    }\n    else {\n        stopCLSTracking = noop;\n    }\n    return {\n        stop: function () {\n            stopEventCountsTracking();\n            stopActivityLoadingTimeTracking();\n            stopCLSTracking();\n        },\n        setLoadEvent: setLoadEvent,\n        viewMetrics: viewMetrics,\n    };\n}\nfunction trackLoadingTime(loadType, callback) {\n    var isWaitingForLoadEvent = loadType === ViewLoadingType.INITIAL_LOAD;\n    var isWaitingForActivityLoadingTime = true;\n    var loadingTimeCandidates = [];\n    function invokeCallbackIfAllCandidatesAreReceived() {\n        if (!isWaitingForActivityLoadingTime && !isWaitingForLoadEvent && loadingTimeCandidates.length > 0) {\n            callback(Math.max.apply(Math, loadingTimeCandidates));\n        }\n    }\n    return {\n        setLoadEvent: function (loadEvent) {\n            if (isWaitingForLoadEvent) {\n                isWaitingForLoadEvent = false;\n                loadingTimeCandidates.push(loadEvent);\n                invokeCallbackIfAllCandidatesAreReceived();\n            }\n        },\n        setActivityLoadingTime: function (activityLoadingTime) {\n            if (isWaitingForActivityLoadingTime) {\n                isWaitingForActivityLoadingTime = false;\n                if (activityLoadingTime !== undefined) {\n                    loadingTimeCandidates.push(activityLoadingTime);\n                }\n                invokeCallbackIfAllCandidatesAreReceived();\n            }\n        },\n    };\n}\nfunction trackActivityLoadingTime(lifeCycle, domMutationObservable, callback) {\n    var startTime = timeStampNow();\n    var stopWaitIdlePageActivity = waitIdlePageActivity(lifeCycle, domMutationObservable, function (params) {\n        if (params.hadActivity) {\n            callback(elapsed(startTime, params.endTime));\n        }\n        else {\n            callback(undefined);\n        }\n    }).stop;\n    return { stop: stopWaitIdlePageActivity };\n}\n/**\n * Track layout shifts (LS) occurring during the Views.  This yields multiple values that can be\n * added up to compute the cumulated layout shift (CLS).\n *\n * See isLayoutShiftSupported to check for browser support.\n *\n * Documentation: https://web.dev/cls/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getCLS.ts\n */\nfunction trackLayoutShift(lifeCycle, callback) {\n    var stop = lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n        if (entry.entryType === 'layout-shift' && !entry.hadRecentInput) {\n            callback(entry.value);\n        }\n    }).unsubscribe;\n    return {\n        stop: stop,\n    };\n}\n/**\n * Check whether `layout-shift` is supported by the browser.\n */\nfunction isLayoutShiftSupported() {\n    return supportPerformanceTimingEvent('layout-shift');\n}\n//# sourceMappingURL=trackViewMetrics.js.map","import { __assign } from \"tslib\";\nimport { elapsed, generateUUID, monitor, ONE_MINUTE, throttle, clocksNow, clocksOrigin, timeStampNow, display, } from '@datadog/browser-core';\nimport { ViewLoadingType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { trackInitialViewTimings } from './trackInitialViewTimings';\nimport { trackLocationChanges, areDifferentLocation } from './trackLocationChanges';\nimport { trackViewMetrics } from './trackViewMetrics';\nexport var THROTTLE_VIEW_UPDATE_PERIOD = 3000;\nexport var SESSION_KEEP_ALIVE_INTERVAL = 5 * ONE_MINUTE;\nexport function trackViews(location, lifeCycle, domMutationObservable, areViewsTrackedAutomatically, initialViewName) {\n    var isRecording = false;\n    var _a = trackInitialView(initialViewName), stopInitialViewTracking = _a.stop, initialView = _a.initialView;\n    var currentView = initialView;\n    var stopViewLifeCycle = startViewLifeCycle().stop;\n    var stopViewCollectionMode = (areViewsTrackedAutomatically\n        ? startAutomaticViewCollection()\n        : startManualViewCollection()).stop;\n    function trackInitialView(name) {\n        var initialView = newView(lifeCycle, domMutationObservable, location, isRecording, ViewLoadingType.INITIAL_LOAD, document.referrer, clocksOrigin(), name);\n        var stop = trackInitialViewTimings(lifeCycle, function (timings) {\n            initialView.updateTimings(timings);\n            initialView.scheduleUpdate();\n        }).stop;\n        return { initialView: initialView, stop: stop };\n    }\n    function trackViewChange(startClocks, name) {\n        return newView(lifeCycle, domMutationObservable, location, isRecording, ViewLoadingType.ROUTE_CHANGE, currentView.url, startClocks, name);\n    }\n    function startViewLifeCycle() {\n        lifeCycle.subscribe(LifeCycleEventType.SESSION_RENEWED, function () {\n            // do not trigger view update to avoid wrong data\n            currentView.end();\n            // Renew view on session renewal\n            currentView = trackViewChange(undefined, currentView.name);\n        });\n        // End the current view on page unload\n        lifeCycle.subscribe(LifeCycleEventType.BEFORE_UNLOAD, function () {\n            currentView.end();\n            currentView.triggerUpdate();\n        });\n        lifeCycle.subscribe(LifeCycleEventType.RECORD_STARTED, function () {\n            isRecording = true;\n            currentView.updateHasReplay(true);\n        });\n        lifeCycle.subscribe(LifeCycleEventType.RECORD_STOPPED, function () {\n            isRecording = false;\n        });\n        // Session keep alive\n        var keepAliveInterval = window.setInterval(monitor(function () {\n            currentView.triggerUpdate();\n        }), SESSION_KEEP_ALIVE_INTERVAL);\n        return {\n            stop: function () {\n                clearInterval(keepAliveInterval);\n            },\n        };\n    }\n    function startAutomaticViewCollection() {\n        return trackLocationChanges(function () {\n            if (areDifferentLocation(currentView.getLocation(), location)) {\n                // Renew view on location changes\n                currentView.end();\n                currentView.triggerUpdate();\n                currentView = trackViewChange();\n                return;\n            }\n            currentView.updateLocation(location);\n            currentView.triggerUpdate();\n        });\n    }\n    function startManualViewCollection() {\n        return trackLocationChanges(function () {\n            currentView.updateLocation(location);\n            currentView.triggerUpdate();\n        });\n    }\n    return {\n        addTiming: function (name, time) {\n            if (time === void 0) { time = timeStampNow(); }\n            currentView.addTiming(name, time);\n            currentView.triggerUpdate();\n        },\n        startView: function (name, startClocks) {\n            currentView.end(startClocks);\n            currentView.triggerUpdate();\n            currentView = trackViewChange(startClocks, name);\n        },\n        stop: function () {\n            stopViewCollectionMode();\n            stopInitialViewTracking();\n            stopViewLifeCycle();\n            currentView.end();\n        },\n    };\n}\nfunction newView(lifeCycle, domMutationObservable, initialLocation, initialHasReplay, loadingType, referrer, startClocks, name) {\n    if (startClocks === void 0) { startClocks = clocksNow(); }\n    // Setup initial values\n    var id = generateUUID();\n    var timings = {};\n    var customTimings = {};\n    var documentVersion = 0;\n    var endClocks;\n    var location = __assign({}, initialLocation);\n    var hasReplay = initialHasReplay;\n    lifeCycle.notify(LifeCycleEventType.VIEW_CREATED, { id: id, name: name, startClocks: startClocks, location: location, referrer: referrer });\n    // Update the view every time the measures are changing\n    var _a = throttle(monitor(triggerViewUpdate), THROTTLE_VIEW_UPDATE_PERIOD, {\n        leading: false,\n    }), scheduleViewUpdate = _a.throttled, cancelScheduleViewUpdate = _a.cancel;\n    var _b = trackViewMetrics(lifeCycle, domMutationObservable, scheduleViewUpdate, loadingType), setLoadEvent = _b.setLoadEvent, stopViewMetricsTracking = _b.stop, viewMetrics = _b.viewMetrics;\n    // Initial view update\n    triggerViewUpdate();\n    function triggerViewUpdate() {\n        documentVersion += 1;\n        var currentEnd = endClocks === undefined ? timeStampNow() : endClocks.timeStamp;\n        lifeCycle.notify(LifeCycleEventType.VIEW_UPDATED, __assign(__assign({}, viewMetrics), { customTimings: customTimings,\n            documentVersion: documentVersion,\n            id: id,\n            name: name,\n            loadingType: loadingType,\n            location: location,\n            hasReplay: hasReplay,\n            referrer: referrer,\n            startClocks: startClocks,\n            timings: timings, duration: elapsed(startClocks.timeStamp, currentEnd), isActive: endClocks === undefined }));\n    }\n    return {\n        name: name,\n        scheduleUpdate: scheduleViewUpdate,\n        end: function (clocks) {\n            if (clocks === void 0) { clocks = clocksNow(); }\n            endClocks = clocks;\n            stopViewMetricsTracking();\n            lifeCycle.notify(LifeCycleEventType.VIEW_ENDED, { endClocks: endClocks });\n        },\n        getLocation: function () {\n            return location;\n        },\n        triggerUpdate: function () {\n            // cancel any pending view updates execution\n            cancelScheduleViewUpdate();\n            triggerViewUpdate();\n        },\n        updateTimings: function (newTimings) {\n            timings = newTimings;\n            if (newTimings.loadEvent !== undefined) {\n                setLoadEvent(newTimings.loadEvent);\n            }\n        },\n        addTiming: function (name, time) {\n            customTimings[sanitizeTiming(name)] = elapsed(startClocks.timeStamp, time);\n        },\n        updateLocation: function (newLocation) {\n            location = __assign({}, newLocation);\n        },\n        updateHasReplay: function (newHasReplay) {\n            hasReplay = newHasReplay;\n        },\n        get url() {\n            return location.href;\n        },\n    };\n}\n/**\n * Timing name is used as facet path that must contain only letters, digits, or the characters - _ . @ $\n */\nfunction sanitizeTiming(name) {\n    var sanitized = name.replace(/[^a-zA-Z0-9-_.@$]/g, '_');\n    if (sanitized !== name) {\n        display.warn(\"Invalid timing name: \" + name + \", sanitized to: \" + sanitized);\n    }\n    return sanitized;\n}\n//# sourceMappingURL=trackViews.js.map","import { defineGlobal, getGlobalObject } from '@datadog/browser-core';\nimport { makeRumPublicApi, startRum } from '@datadog/browser-rum-core';\nexport var datadogRum = makeRumPublicApi(startRum);\ndefineGlobal(getGlobalObject(), 'DD_RUM', datadogRum);\n//# sourceMappingURL=rum.entry.js.map","import { BoundedBuffer, buildCookieOptions, checkCookiesAuthorized, checkIsNotLocalFile, createContextManager, deepClone, ErrorSource, isPercentage, makePublicApi, monitor, clocksNow, timeStampNow, display, commonInit, callMonitored, createHandlingStack, } from '@datadog/browser-core';\nimport { ActionType } from '../rawRumEvent.types';\nimport { buildEnv } from './buildEnv';\nexport function makeRumPublicApi(startRumImpl) {\n    var isAlreadyInitialized = false;\n    var globalContextManager = createContextManager();\n    var user = {};\n    var getInternalContextStrategy = function () { return undefined; };\n    var bufferApiCalls = new BoundedBuffer();\n    var addTimingStrategy = function (name, time) {\n        if (time === void 0) { time = timeStampNow(); }\n        bufferApiCalls.add(function () { return addTimingStrategy(name, time); });\n    };\n    var startViewStrategy = function (name, startClocks) {\n        if (startClocks === void 0) { startClocks = clocksNow(); }\n        bufferApiCalls.add(function () { return startViewStrategy(name, startClocks); });\n    };\n    var addActionStrategy = function (action, commonContext) {\n        if (commonContext === void 0) { commonContext = clonedCommonContext(); }\n        bufferApiCalls.add(function () { return addActionStrategy(action, commonContext); });\n    };\n    var addErrorStrategy = function (providedError, commonContext) {\n        if (commonContext === void 0) { commonContext = clonedCommonContext(); }\n        bufferApiCalls.add(function () { return addErrorStrategy(providedError, commonContext); });\n    };\n    function clonedCommonContext() {\n        return deepClone({\n            context: globalContextManager.get(),\n            user: user,\n        });\n    }\n    function initRum(userConfiguration) {\n        if (!checkCookiesAuthorized(buildCookieOptions(userConfiguration)) ||\n            !checkIsNotLocalFile() ||\n            !canInitRum(userConfiguration)) {\n            return;\n        }\n        if (userConfiguration.publicApiKey) {\n            userConfiguration.clientToken = userConfiguration.publicApiKey;\n        }\n        var _a = commonInit(userConfiguration, buildEnv), configuration = _a.configuration, internalMonitoring = _a.internalMonitoring;\n        if (!configuration.isEnabled('view-renaming') || !configuration.trackViewsManually) {\n            doStartRum();\n        }\n        else {\n            // drain beforeInitCalls by buffering them until we start RUM\n            // if we get a startView, drain re-buffered calls before continuing to drain beforeInitCalls\n            // in order to ensure that calls are processed in order\n            var beforeInitCalls = bufferApiCalls;\n            bufferApiCalls = new BoundedBuffer();\n            startViewStrategy = function (name) {\n                doStartRum(name);\n            };\n            beforeInitCalls.drain();\n        }\n        isAlreadyInitialized = true;\n        function doStartRum(initialViewName) {\n            var _a;\n            var startView;\n            (_a = startRumImpl(userConfiguration, configuration, internalMonitoring, function () { return ({\n                user: user,\n                context: globalContextManager.get(),\n            }); }, initialViewName), startView = _a.startView, addActionStrategy = _a.addAction, addErrorStrategy = _a.addError, addTimingStrategy = _a.addTiming, getInternalContextStrategy = _a.getInternalContext);\n            if (configuration.isEnabled('view-renaming')) {\n                startViewStrategy = startView;\n            }\n            bufferApiCalls.drain();\n        }\n    }\n    var rumPublicApi = makePublicApi({\n        init: monitor(initRum),\n        addRumGlobalContext: monitor(globalContextManager.add),\n        removeRumGlobalContext: monitor(globalContextManager.remove),\n        getRumGlobalContext: monitor(globalContextManager.get),\n        setRumGlobalContext: monitor(globalContextManager.set),\n        getInternalContext: monitor(function (startTime) { return getInternalContextStrategy(startTime); }),\n        addAction: monitor(function (name, context) {\n            addActionStrategy({\n                name: name,\n                context: deepClone(context),\n                startClocks: clocksNow(),\n                type: ActionType.CUSTOM,\n            });\n        }),\n        /**\n         * @deprecated use addAction instead\n         */\n        addUserAction: function (name, context) {\n            rumPublicApi.addAction(name, context);\n        },\n        addError: function (error, context, source) {\n            if (source === void 0) { source = ErrorSource.CUSTOM; }\n            var handlingStack = createHandlingStack();\n            callMonitored(function () {\n                var checkedSource;\n                if (source === ErrorSource.CUSTOM || source === ErrorSource.NETWORK || source === ErrorSource.SOURCE) {\n                    checkedSource = source;\n                }\n                else {\n                    display.error(\"DD_RUM.addError: Invalid source '\" + source + \"'\");\n                    checkedSource = ErrorSource.CUSTOM;\n                }\n                addErrorStrategy({\n                    error: error,\n                    handlingStack: handlingStack,\n                    context: deepClone(context),\n                    source: checkedSource,\n                    startClocks: clocksNow(),\n                });\n            });\n        },\n        addTiming: monitor(function (name) {\n            addTimingStrategy(name);\n        }),\n        setUser: monitor(function (newUser) {\n            var sanitizedUser = sanitizeUser(newUser);\n            if (sanitizedUser) {\n                user = sanitizedUser;\n            }\n            else {\n                display.error('Unsupported user:', newUser);\n            }\n        }),\n        removeUser: monitor(function () {\n            user = {};\n        }),\n    });\n    rumPublicApi['startView'] = monitor(function (name) {\n        startViewStrategy(name);\n    });\n    return rumPublicApi;\n    function sanitizeUser(newUser) {\n        if (typeof newUser !== 'object' || !newUser) {\n            return;\n        }\n        var result = deepClone(newUser);\n        if ('id' in result) {\n            result.id = String(result.id);\n        }\n        if ('name' in result) {\n            result.name = String(result.name);\n        }\n        if ('email' in result) {\n            result.email = String(result.email);\n        }\n        return result;\n    }\n    function canInitRum(userConfiguration) {\n        if (isAlreadyInitialized) {\n            if (!userConfiguration.silentMultipleInit) {\n                display.error('DD_RUM is already initialized.');\n            }\n            return false;\n        }\n        if (!userConfiguration || (!userConfiguration.clientToken && !userConfiguration.publicApiKey)) {\n            display.error('Client Token is not configured, we will not send any data.');\n            return false;\n        }\n        if (!userConfiguration.applicationId) {\n            display.error('Application ID is not configured, no RUM data will be collected.');\n            return false;\n        }\n        if (userConfiguration.sampleRate !== undefined && !isPercentage(userConfiguration.sampleRate)) {\n            display.error('Sample Rate should be a number between 0 and 100');\n            return false;\n        }\n        if (userConfiguration.resourceSampleRate !== undefined && !isPercentage(userConfiguration.resourceSampleRate)) {\n            display.error('Resource Sample Rate should be a number between 0 and 100');\n            return false;\n        }\n        if (Array.isArray(userConfiguration.allowedTracingOrigins) &&\n            userConfiguration.allowedTracingOrigins.length !== 0 &&\n            userConfiguration.service === undefined) {\n            display.error('Service need to be configured when tracing is enabled');\n            return false;\n        }\n        return true;\n    }\n}\n//# sourceMappingURL=rumPublicApi.js.map","export function createContextManager() {\n    var context = {};\n    return {\n        get: function () { return context; },\n        add: function (key, value) {\n            context[key] = value;\n        },\n        remove: function (key) {\n            delete context[key];\n        },\n        set: function (newContext) {\n            context = newContext;\n        },\n    };\n}\n//# sourceMappingURL=contextManager.js.map","import { combine } from '@datadog/browser-core';\nimport { createDOMMutationObservable } from '../browser/domMutationObservable';\nimport { startPerformanceCollection } from '../browser/performanceCollection';\nimport { startRumAssembly } from '../domain/assembly';\nimport { startForegroundContexts } from '../domain/foregroundContexts';\nimport { startInternalContext } from '../domain/internalContext';\nimport { LifeCycle } from '../domain/lifeCycle';\nimport { startParentContexts } from '../domain/parentContexts';\nimport { startRequestCollection } from '../domain/requestCollection';\nimport { startActionCollection } from '../domain/rumEventsCollection/action/actionCollection';\nimport { startErrorCollection } from '../domain/rumEventsCollection/error/errorCollection';\nimport { startLongTaskCollection } from '../domain/rumEventsCollection/longTask/longTaskCollection';\nimport { startResourceCollection } from '../domain/rumEventsCollection/resource/resourceCollection';\nimport { startViewCollection } from '../domain/rumEventsCollection/view/viewCollection';\nimport { startRumSession } from '../domain/rumSession';\nimport { startRumBatch } from '../transport/batch';\nexport function startRum(userConfiguration, configuration, internalMonitoring, getCommonContext, initialViewName) {\n    var lifeCycle = new LifeCycle();\n    var session = startRumSession(configuration, lifeCycle);\n    var domMutationObservable = createDOMMutationObservable();\n    internalMonitoring.setExternalContextProvider(function () {\n        return combine({\n            application_id: userConfiguration.applicationId,\n        }, parentContexts.findView(), getCommonContext().context);\n    });\n    var _a = startRumEventCollection(userConfiguration.applicationId, lifeCycle, configuration, session, getCommonContext), parentContexts = _a.parentContexts, foregroundContexts = _a.foregroundContexts;\n    startLongTaskCollection(lifeCycle);\n    startResourceCollection(lifeCycle, session);\n    var _b = startViewCollection(lifeCycle, configuration, location, domMutationObservable, foregroundContexts, initialViewName), addTiming = _b.addTiming, startView = _b.startView;\n    var addError = startErrorCollection(lifeCycle, configuration, foregroundContexts).addError;\n    var addAction = startActionCollection(lifeCycle, domMutationObservable, configuration, foregroundContexts).addAction;\n    startRequestCollection(lifeCycle, configuration);\n    startPerformanceCollection(lifeCycle, configuration);\n    var internalContext = startInternalContext(userConfiguration.applicationId, session, parentContexts);\n    return {\n        addAction: addAction,\n        addError: addError,\n        addTiming: addTiming,\n        startView: startView,\n        lifeCycle: lifeCycle,\n        parentContexts: parentContexts,\n        session: session,\n        getInternalContext: internalContext.get,\n    };\n}\nexport function startRumEventCollection(applicationId, lifeCycle, configuration, session, getCommonContext) {\n    var parentContexts = startParentContexts(lifeCycle, session);\n    var foregroundContexts = startForegroundContexts(configuration);\n    var batch = startRumBatch(configuration, lifeCycle);\n    startRumAssembly(applicationId, configuration, lifeCycle, session, parentContexts, getCommonContext);\n    return {\n        parentContexts: parentContexts,\n        foregroundContexts: foregroundContexts,\n        stop: function () {\n            // prevent batch from previous tests to keep running and send unwanted requests\n            // could be replaced by stopping all the component when they will all have a stop method\n            batch.stop();\n            parentContexts.stop();\n            foregroundContexts.stop();\n        },\n    };\n}\n//# sourceMappingURL=startRum.js.map","import { monitor } from '@datadog/browser-core';\nexport function createDOMMutationObservable() {\n    var callbacks = [];\n    var MutationObserver = getMutationObserverConstructor();\n    var observer = MutationObserver ? new MutationObserver(monitor(notify)) : undefined;\n    function notify() {\n        callbacks.forEach(function (callback) { return callback(); });\n    }\n    function startDOMObservation() {\n        if (!observer) {\n            return;\n        }\n        observer.observe(document, {\n            attributes: true,\n            characterData: true,\n            childList: true,\n            subtree: true,\n        });\n    }\n    function stopDOMObservation() {\n        if (!observer) {\n            return;\n        }\n        observer.disconnect();\n    }\n    return {\n        subscribe: function (callback) {\n            if (!callbacks.length) {\n                startDOMObservation();\n            }\n            callbacks.push(callback);\n            return {\n                unsubscribe: function () {\n                    callbacks = callbacks.filter(function (other) { return callback !== other; });\n                    if (!callbacks.length) {\n                        stopDOMObservation();\n                    }\n                },\n            };\n        },\n    };\n}\nexport function getMutationObserverConstructor() {\n    var constructor;\n    var browserWindow = window;\n    // Angular uses Zone.js to provide a context persisting accross async tasks.  Zone.js replaces the\n    // global MutationObserver constructor with a patched version to support the context propagation.\n    // There is an ongoing issue[1][2] with this setup when using a MutationObserver within a Angular\n    // component: on some occasions, the callback is being called in an infinite loop, causing the\n    // page to freeze (even if the callback is completely empty).\n    //\n    // To work around this issue, we are using the Zone __symbol__ API to get the original, unpatched\n    // MutationObserver constructor.\n    //\n    // [1] https://github.com/angular/angular/issues/26948\n    // [2] https://github.com/angular/angular/issues/31712\n    if (browserWindow.Zone) {\n        var symbol = browserWindow.Zone.__symbol__('MutationObserver');\n        constructor = browserWindow[symbol];\n    }\n    if (!constructor) {\n        constructor = browserWindow.MutationObserver;\n    }\n    return constructor;\n}\n//# sourceMappingURL=domMutationObservable.js.map","import { monitor, ONE_MINUTE, SESSION_TIME_OUT_DELAY, relativeNow, } from '@datadog/browser-core';\nimport { LifeCycleEventType } from './lifeCycle';\nexport var VIEW_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY;\nexport var ACTION_CONTEXT_TIME_OUT_DELAY = 5 * ONE_MINUTE; // arbitrary\nexport var CLEAR_OLD_CONTEXTS_INTERVAL = ONE_MINUTE;\nexport function startParentContexts(lifeCycle, session) {\n    var currentView;\n    var currentAction;\n    var currentSessionId;\n    var previousViews = [];\n    var previousActions = [];\n    lifeCycle.subscribe(LifeCycleEventType.VIEW_CREATED, function (currentContext) {\n        currentView = currentContext;\n        currentSessionId = session.getId();\n    });\n    lifeCycle.subscribe(LifeCycleEventType.VIEW_UPDATED, function (currentContext) {\n        // A view can be updated after its end.  We have to ensure that the view being updated is the\n        // most recently created.\n        if (currentView && currentView.id === currentContext.id) {\n            currentView = currentContext;\n        }\n    });\n    lifeCycle.subscribe(LifeCycleEventType.VIEW_ENDED, function (_a) {\n        var endClocks = _a.endClocks;\n        if (currentView) {\n            previousViews.unshift({\n                endTime: endClocks.relative,\n                context: buildCurrentViewContext(),\n                startTime: currentView.startClocks.relative,\n            });\n            currentView = undefined;\n        }\n    });\n    lifeCycle.subscribe(LifeCycleEventType.AUTO_ACTION_CREATED, function (currentContext) {\n        currentAction = currentContext;\n    });\n    lifeCycle.subscribe(LifeCycleEventType.AUTO_ACTION_COMPLETED, function (action) {\n        if (currentAction) {\n            previousActions.unshift({\n                context: buildCurrentActionContext(),\n                // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n                endTime: (currentAction.startClocks.relative + action.duration),\n                startTime: currentAction.startClocks.relative,\n            });\n        }\n        currentAction = undefined;\n    });\n    lifeCycle.subscribe(LifeCycleEventType.AUTO_ACTION_DISCARDED, function () {\n        currentAction = undefined;\n    });\n    lifeCycle.subscribe(LifeCycleEventType.SESSION_RENEWED, function () {\n        previousViews = [];\n        previousActions = [];\n        currentView = undefined;\n        currentAction = undefined;\n    });\n    var clearOldContextsInterval = setInterval(monitor(function () {\n        clearOldContexts(previousViews, VIEW_CONTEXT_TIME_OUT_DELAY);\n        clearOldContexts(previousActions, ACTION_CONTEXT_TIME_OUT_DELAY);\n    }), CLEAR_OLD_CONTEXTS_INTERVAL);\n    function clearOldContexts(previousContexts, timeOutDelay) {\n        var oldTimeThreshold = relativeNow() - timeOutDelay;\n        while (previousContexts.length > 0 && previousContexts[previousContexts.length - 1].startTime < oldTimeThreshold) {\n            previousContexts.pop();\n        }\n    }\n    function buildCurrentViewContext() {\n        return {\n            session: {\n                id: currentSessionId,\n            },\n            view: {\n                id: currentView.id,\n                name: currentView.name,\n                referrer: currentView.referrer,\n                url: currentView.location.href,\n            },\n        };\n    }\n    function buildCurrentActionContext() {\n        return { action: { id: currentAction.id } };\n    }\n    function findContext(buildContext, previousContexts, currentContext, startTime) {\n        if (startTime === undefined) {\n            return currentContext ? buildContext() : undefined;\n        }\n        if (currentContext && startTime >= currentContext.startClocks.relative) {\n            return buildContext();\n        }\n        for (var _i = 0, previousContexts_1 = previousContexts; _i < previousContexts_1.length; _i++) {\n            var previousContext = previousContexts_1[_i];\n            if (startTime > previousContext.endTime) {\n                break;\n            }\n            if (startTime >= previousContext.startTime) {\n                return previousContext.context;\n            }\n        }\n        return undefined;\n    }\n    return {\n        findAction: function (startTime) { return findContext(buildCurrentActionContext, previousActions, currentAction, startTime); },\n        findView: function (startTime) { return findContext(buildCurrentViewContext, previousViews, currentView, startTime); },\n        stop: function () {\n            clearInterval(clearOldContextsInterval);\n        },\n    };\n}\n//# sourceMappingURL=parentContexts.js.map","import { Batch, combine, HttpRequest } from '@datadog/browser-core';\nimport { LifeCycleEventType } from '../domain/lifeCycle';\nimport { RumEventType } from '../rawRumEvent.types';\nexport function startRumBatch(configuration, lifeCycle) {\n    var batch = makeRumBatch(configuration, lifeCycle);\n    lifeCycle.subscribe(LifeCycleEventType.RUM_EVENT_COLLECTED, function (serverRumEvent) {\n        if (serverRumEvent.type === RumEventType.VIEW) {\n            batch.upsert(serverRumEvent, serverRumEvent.view.id);\n        }\n        else {\n            batch.add(serverRumEvent);\n        }\n    });\n    return {\n        stop: function () {\n            batch.stop();\n        },\n    };\n}\nfunction makeRumBatch(configuration, lifeCycle) {\n    var primaryBatch = createRumBatch(configuration.rumEndpoint, function () {\n        return lifeCycle.notify(LifeCycleEventType.BEFORE_UNLOAD);\n    });\n    var replicaBatch;\n    var replica = configuration.replica;\n    if (replica !== undefined) {\n        replicaBatch = createRumBatch(replica.rumEndpoint);\n    }\n    function createRumBatch(endpointUrl, unloadCallback) {\n        return new Batch(new HttpRequest(endpointUrl, configuration.batchBytesLimit, true), configuration.maxBatchSize, configuration.batchBytesLimit, configuration.maxMessageSize, configuration.flushTimeout, unloadCallback);\n    }\n    function withReplicaApplicationId(message) {\n        return combine(message, { application: { id: replica.applicationId } });\n    }\n    var stopped = false;\n    return {\n        add: function (message) {\n            if (stopped) {\n                return;\n            }\n            primaryBatch.add(message);\n            if (replicaBatch) {\n                replicaBatch.add(withReplicaApplicationId(message));\n            }\n        },\n        stop: function () {\n            stopped = true;\n        },\n        upsert: function (message, key) {\n            if (stopped) {\n                return;\n            }\n            primaryBatch.upsert(message, key);\n            if (replicaBatch) {\n                replicaBatch.upsert(withReplicaApplicationId(message), key);\n            }\n        },\n    };\n}\n//# sourceMappingURL=batch.js.map","import { toServerDuration, relativeToClocks, generateUUID } from '@datadog/browser-core';\nimport { RumEventType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nexport function startLongTaskCollection(lifeCycle) {\n    lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n        if (entry.entryType !== 'longtask') {\n            return;\n        }\n        var startClocks = relativeToClocks(entry.startTime);\n        var rawRumEvent = {\n            date: startClocks.timeStamp,\n            long_task: {\n                id: generateUUID(),\n                duration: toServerDuration(entry.duration),\n            },\n            type: RumEventType.LONG_TASK,\n        };\n        lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, {\n            rawRumEvent: rawRumEvent,\n            startTime: startClocks.relative,\n            domainContext: { performanceEntry: entry.toJSON() },\n        });\n    });\n}\n//# sourceMappingURL=longTaskCollection.js.map","import { isEmptyObject, mapValues, toServerDuration, } from '@datadog/browser-core';\nimport { RumEventType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { trackViews } from './trackViews';\nexport function startViewCollection(lifeCycle, configuration, location, domMutationObservable, foregroundContexts, initialViewName) {\n    lifeCycle.subscribe(LifeCycleEventType.VIEW_UPDATED, function (view) {\n        return lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, processViewUpdate(view, foregroundContexts));\n    });\n    var shouldTrackViewsAutomatically = !configuration.isEnabled('view-renaming') || !configuration.trackViewsManually;\n    return trackViews(location, lifeCycle, domMutationObservable, shouldTrackViewsAutomatically, initialViewName);\n}\nfunction processViewUpdate(view, foregroundContexts) {\n    var viewEvent = {\n        _dd: {\n            document_version: view.documentVersion,\n        },\n        date: view.startClocks.timeStamp,\n        type: RumEventType.VIEW,\n        view: {\n            action: {\n                count: view.eventCounts.userActionCount,\n            },\n            cumulative_layout_shift: view.cumulativeLayoutShift,\n            dom_complete: toServerDuration(view.timings.domComplete),\n            dom_content_loaded: toServerDuration(view.timings.domContentLoaded),\n            dom_interactive: toServerDuration(view.timings.domInteractive),\n            error: {\n                count: view.eventCounts.errorCount,\n            },\n            first_contentful_paint: toServerDuration(view.timings.firstContentfulPaint),\n            first_input_delay: toServerDuration(view.timings.firstInputDelay),\n            first_input_time: toServerDuration(view.timings.firstInputTime),\n            is_active: view.isActive,\n            name: view.name,\n            largest_contentful_paint: toServerDuration(view.timings.largestContentfulPaint),\n            load_event: toServerDuration(view.timings.loadEvent),\n            loading_time: toServerDuration(view.loadingTime),\n            loading_type: view.loadingType,\n            long_task: {\n                count: view.eventCounts.longTaskCount,\n            },\n            resource: {\n                count: view.eventCounts.resourceCount,\n            },\n            time_spent: toServerDuration(view.duration),\n            in_foreground_periods: foregroundContexts.getInForegroundPeriods(view.startClocks.relative, view.duration),\n        },\n        session: {\n            has_replay: view.hasReplay || undefined,\n        },\n    };\n    if (!isEmptyObject(view.customTimings)) {\n        viewEvent.view.custom_timings = mapValues(view.customTimings, toServerDuration);\n    }\n    return {\n        rawRumEvent: viewEvent,\n        startTime: view.startClocks.relative,\n        domainContext: {\n            location: view.location,\n        },\n    };\n}\n//# sourceMappingURL=viewCollection.js.map","import { __assign } from \"tslib\";\nimport { computeStackTrace, formatUnknownError, startAutomaticErrorCollection, generateUUID, ErrorHandling, } from '@datadog/browser-core';\nimport { RumEventType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nexport function startErrorCollection(lifeCycle, configuration, foregroundContexts) {\n    startAutomaticErrorCollection(configuration).subscribe(function (error) {\n        return lifeCycle.notify(LifeCycleEventType.RAW_ERROR_COLLECTED, { error: error });\n    });\n    return doStartErrorCollection(lifeCycle, foregroundContexts);\n}\nexport function doStartErrorCollection(lifeCycle, foregroundContexts) {\n    lifeCycle.subscribe(LifeCycleEventType.RAW_ERROR_COLLECTED, function (_a) {\n        var error = _a.error, customerContext = _a.customerContext, savedCommonContext = _a.savedCommonContext;\n        lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, __assign({ customerContext: customerContext,\n            savedCommonContext: savedCommonContext }, processError(error, foregroundContexts)));\n    });\n    return {\n        addError: function (_a, savedCommonContext) {\n            var error = _a.error, handlingStack = _a.handlingStack, startClocks = _a.startClocks, customerContext = _a.context, source = _a.source;\n            var rawError = computeRawError(error, handlingStack, startClocks, source);\n            lifeCycle.notify(LifeCycleEventType.RAW_ERROR_COLLECTED, {\n                customerContext: customerContext,\n                savedCommonContext: savedCommonContext,\n                error: rawError,\n            });\n        },\n    };\n}\nfunction computeRawError(error, handlingStack, startClocks, source) {\n    var stackTrace = error instanceof Error ? computeStackTrace(error) : undefined;\n    return __assign(__assign({ startClocks: startClocks,\n        source: source, originalError: error }, formatUnknownError(stackTrace, error, 'Provided', handlingStack)), { handling: ErrorHandling.HANDLED });\n}\nfunction processError(error, foregroundContexts) {\n    var rawRumEvent = {\n        date: error.startClocks.timeStamp,\n        error: {\n            id: generateUUID(),\n            message: error.message,\n            resource: error.resource\n                ? {\n                    method: error.resource.method,\n                    status_code: error.resource.statusCode,\n                    url: error.resource.url,\n                }\n                : undefined,\n            source: error.source,\n            stack: error.stack,\n            handling_stack: error.handlingStack,\n            type: error.type,\n            handling: error.handling,\n        },\n        type: RumEventType.ERROR,\n    };\n    var inForeground = foregroundContexts.getInForeground(error.startClocks.relative);\n    if (inForeground !== undefined) {\n        rawRumEvent.view = { in_foreground: inForeground };\n    }\n    return {\n        rawRumEvent: rawRumEvent,\n        startTime: error.startClocks.relative,\n        domainContext: {\n            error: error.originalError,\n        },\n    };\n}\n//# sourceMappingURL=errorCollection.js.map","/**\n * Internal context keep returning v1 format\n * to not break compatibility with logs data format\n */\nexport function startInternalContext(applicationId, session, parentContexts) {\n    return {\n        get: function (startTime) {\n            var viewContext = parentContexts.findView(startTime);\n            if (session.isTracked() && viewContext && viewContext.session.id) {\n                var actionContext = parentContexts.findAction(startTime);\n                return {\n                    application_id: applicationId,\n                    session_id: viewContext.session.id,\n                    user_action: actionContext\n                        ? {\n                            id: actionContext.action.id,\n                        }\n                        : undefined,\n                    view: viewContext.view,\n                };\n            }\n        },\n    };\n}\n//# sourceMappingURL=internalContext.js.map","\nimport { datadogRum } from '@datadog/browser-rum';\n\ndatadogRum.init({\n    applicationId: 'ffdc1bb8-de18-4a4c-bb63-c913aa8f0439',\n    clientToken: 'pub0b77543cbbc57fb420ab7819a36666b5',\n    site: 'datadoghq.com',\n    service: 'democenter',\n    // Specify a version number to identify the deployed version of your application in Datadog \n    // version: '1.0.0',\n    sampleRate: 100,\n    trackInteractions: true\n});\n"],"sourceRoot":""}